<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.2.0">
  <meta name="generator" content="Hugo 0.53" />
  <meta name="author" content="Dr. Dominic Royé">

  
  
  
  
    
  
  <meta name="description" content="When we try to estimate the correlation coefficient between multiple variables, the task is more complicated in order to obtain a simple and tidy result. A simple solution is to use the ``tidy()`` function from the *{broom}* package. As an example, in this post we are going to estimate the correlation coefficients between the annual precipitation of several Spanish cities and climate teleconnections indices.">

  
  <link rel="alternate" hreflang="en-us" href="https://dominicroye.github.io/en/2019/tidy-correlation-tests-in-r/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css" crossorigin="anonymous">
      
    

    

    

  

  
  

  <link rel="stylesheet" href="/en/styles.css">
  
  <link rel="stylesheet" href="/css/override.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-27463794-2', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="https://dominicroye.github.io/index.xml" type="application/rss+xml" title="Dominic Royé">
  <link rel="feed" href="https://dominicroye.github.io/index.xml" type="application/rss+xml" title="Dominic Royé">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://dominicroye.github.io/en/2019/tidy-correlation-tests-in-r/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Dominic Royé">
  <meta property="og:url" content="https://dominicroye.github.io/en/2019/tidy-correlation-tests-in-r/">
  <meta property="og:title" content="Tidy correlation tests in R | Dominic Royé">
  <meta property="og:description" content="When we try to estimate the correlation coefficient between multiple variables, the task is more complicated in order to obtain a simple and tidy result. A simple solution is to use the ``tidy()`` function from the *{broom}* package. As an example, in this post we are going to estimate the correlation coefficients between the annual precipitation of several Spanish cities and climate teleconnections indices."><meta property="og:image" content="https://dominicroye.github.io/en/2019/tidy-correlation-tests-in-r/featured.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-04-17T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2019-04-17T00:00:00&#43;00:00">
  

  

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#2962ff",
          "text": "#fff"
        },
        "button": {
          "background": "#fff",
          "text": "#2962ff"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://cookies.insites.com"
      }
    })});
</script>


  

  <title>Tidy correlation tests in R | Dominic Royé</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>

<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/en/"><div style="position:relative;float:left">Dominic Royé<img src="/img/portrait.jpg" alt="Dominic Royé" style="float: left;"></div></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#">
            
            <span>home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#posts">
            
            <span>blog</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#publications_selected">
            
            <span>publications</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#graphs">
            
            <span>graphs</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#teaching">
            
            <span>more</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#about">
            
            <span>me</span>
            
          </a>
        </li>

        
        

      

        

        

        

        

      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  













<div class="article-header d-xl-none">
  <div class="featured-image" style="background-image: url('/en/2019/tidy-correlation-tests-in-r/featured_hu65b67a549e7ff3d1ddeb954b24d54c17_105369_800x0_resize_box_2.png');"></div>
  
</div>


<div class="container-fluid split-header d-none d-xl-block">
  <div class="row">
    <div class="col-6">
      <div class="split-header-content">
        <h1 itemprop="name">Tidy correlation tests in R</h1>

        

        

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>
  

  <span class="article-date">
    
    <meta content="2019-04-17 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2019-04-17 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      2019-04-17
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>

  

  
  
  <span class="middot-divider"></span>
  <a href="/en/2019/tidy-correlation-tests-in-r/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/en/categories/statistics/">statistics</a>, 
    
    <a href="/en/categories/r/">R</a>, 
    
    <a href="/en/categories/radvanced/">R:advanced</a>
    
  </span>
  
  

  

</div>


        







  










        
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Tidy%20correlation%20tests%20in%20R&amp;url=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f&amp;title=Tidy%20correlation%20tests%20in%20R"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f&amp;title=Tidy%20correlation%20tests%20in%20R"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Tidy%20correlation%20tests%20in%20R&amp;body=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


      </div>
    </div>
    <div class="col-6">
      <div class="split-header-image">
        <img src="/en/2019/tidy-correlation-tests-in-r/featured_hu65b67a549e7ff3d1ddeb954b24d54c17_105369_680x500_fill_q90_box_smart1_2.png" itemprop="image" alt="">
        
      </div>
    </div>
  </div>
</div>

<div class="article-container d-xl-none">
  <h1 itemprop="name">Tidy correlation tests in R</h1>

  

  

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>
  

  <span class="article-date">
    
    <meta content="2019-04-17 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2019-04-17 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      2019-04-17
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>

  

  
  
  <span class="middot-divider"></span>
  <a href="/en/2019/tidy-correlation-tests-in-r/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/en/categories/statistics/">statistics</a>, 
    
    <a href="/en/categories/r/">R</a>, 
    
    <a href="/en/categories/radvanced/">R:advanced</a>
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Tidy%20correlation%20tests%20in%20R&amp;url=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f&amp;title=Tidy%20correlation%20tests%20in%20R"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f&amp;title=Tidy%20correlation%20tests%20in%20R"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Tidy%20correlation%20tests%20in%20R&amp;body=https%3a%2f%2fdominicroye.github.io%2fen%2f2019%2ftidy-correlation-tests-in-r%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


  







  









</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<p>When we try to estimate the correlation coefficient between multiple variables, the task is more complicated in order to obtain a simple and tidy result. A simple solution is to use the <code>tidy()</code> function from the <em>{broom}</em> package. In this post we are going to estimate the correlation coefficients between the annual precipitation of several Spanish cities and climate teleconnections indices: <a href="/files/teleconnections_indices.zip">download</a>. The data of the teleconnections are preprocessed, but can be downloaded directly from <a href="https://crudata.uea.ac.uk/cru/data/pci.htm">crudata.uea.ac.uk</a>. The daily precipitation data comes from <a href="https://www.ecad.eu//dailydata/index.php">ECA&amp;D</a>.</p>
<div id="packages" class="section level2">
<h2>Packages</h2>
<p>In this post we will use the following packages:</p>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tidyverse</td>
<td align="left">Collection of packages (visualization, manipulation): ggplot2, dplyr, purrr, etc.</td>
</tr>
<tr class="even">
<td align="left">broom</td>
<td align="left">Convert results of statistical functions (lm, t.test, cor.test, etc.) into tidy tables</td>
</tr>
<tr class="odd">
<td align="left">fs</td>
<td align="left">Provides a cross-platform, uniform interface to file system operations</td>
</tr>
<tr class="even">
<td align="left">lubridate</td>
<td align="left">Easy manipulation of dates and times</td>
</tr>
</tbody>
</table>
<pre class="r"><code>#install the packages if necessary
if(!require(&quot;tidyverse&quot;)) install.packages(&quot;tidyverse&quot;)
if(!require(&quot;broom&quot;)) install.packages(&quot;broom&quot;)
if(!require(&quot;fs&quot;)) install.packages(&quot;fs&quot;)
if(!require(&quot;lubridate&quot;)) install.packages(&quot;lubridate&quot;)

#load packages
library(tidyverse)
library(broom)
library(fs)
library(lubridate)</code></pre>
</div>
<div id="import-data" class="section level2">
<h2>Import data</h2>
<p>First we have to import the daily precipitation of the selected weather stations.</p>
<ol style="list-style-type: decimal">
<li>Create a vector with all precipitation files using the function <code>dir_ls()</code> of the <em>{fs}</em> package.</li>
<li>Import the data using the <code>map_df()</code> function of the <em>{purrr}</em> package that applies another function to a vector or list, and joins them together in a single <em>data.frame</em>.</li>
<li><ol style="list-style-type: lower-alpha">
<li>Select the columns that interest us, b) Convert the date string into a date object using the <code>ymd()</code> function of the <em>{lubridate}</em> package, c) Create a new column <em>yr</em> with the years, d) Divide the precipitation values by 10 and reclassify absent values -9999 by NA, e) Finally, reclassify the ID of each weather station creating a factor with new labels.</li>
</ol></li>
</ol>
<p>More details about the use of the <code>dir_ls()</code> and <code>map_df()</code> functions can be found in this previous <a href="https://dominicroye.github.io/en/2019/import-excel-sheets-%20with-r%20/">post</a>.</p>
<pre class="r"><code>#precipitation files
files &lt;- dir_ls(regexp = &quot;txt&quot;)
files</code></pre>
<pre><code>## RR_STAID001393.txt RR_STAID001394.txt RR_STAID002969.txt 
## RR_STAID003946.txt RR_STAID003969.txt</code></pre>
<pre class="r"><code>#import all files and join them together
pr &lt;- files %&gt;% map_df(read_csv, skip = 20)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   STAID = col_double(),
##   SOUID = col_double(),
##   DATE = col_double(),
##   RR = col_double(),
##   Q_RR = col_double()
## )
## Parsed with column specification:
## cols(
##   STAID = col_double(),
##   SOUID = col_double(),
##   DATE = col_double(),
##   RR = col_double(),
##   Q_RR = col_double()
## )
## Parsed with column specification:
## cols(
##   STAID = col_double(),
##   SOUID = col_double(),
##   DATE = col_double(),
##   RR = col_double(),
##   Q_RR = col_double()
## )
## Parsed with column specification:
## cols(
##   STAID = col_double(),
##   SOUID = col_double(),
##   DATE = col_double(),
##   RR = col_double(),
##   Q_RR = col_double()
## )
## Parsed with column specification:
## cols(
##   STAID = col_double(),
##   SOUID = col_double(),
##   DATE = col_double(),
##   RR = col_double(),
##   Q_RR = col_double()
## )</code></pre>
<pre class="r"><code>pr</code></pre>
<pre><code>## # A tibble: 133,343 x 5
##    STAID SOUID     DATE    RR  Q_RR
##    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1393 20611 19470301     0     0
##  2  1393 20611 19470302     5     0
##  3  1393 20611 19470303     0     0
##  4  1393 20611 19470304    33     0
##  5  1393 20611 19470305    15     0
##  6  1393 20611 19470306     0     0
##  7  1393 20611 19470307    85     0
##  8  1393 20611 19470308     3     0
##  9  1393 20611 19470309     0     0
## 10  1393 20611 19470310     0     0
## # ... with 133,333 more rows</code></pre>
<pre class="r"><code>#create levels for the factor 
id &lt;- unique(pr$STAID)

#the corresponding labels
lab &lt;- c(&quot;Bilbao&quot;, &quot;Santiago&quot;, &quot;Barcelona&quot;, &quot;Madrid&quot;, &quot;Valencia&quot;)

#first changes
pr &lt;- select(pr, STAID, DATE, RR) %&gt;% 
        mutate(DATE = ymd(DATE), 
               RR = ifelse(RR == -9999, NA, RR/10), 
               STAID = factor(STAID, id, lab), 
               yr = year(DATE)) 
pr</code></pre>
<pre><code>## # A tibble: 133,343 x 4
##    STAID  DATE          RR    yr
##    &lt;fct&gt;  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 Bilbao 1947-03-01   0    1947
##  2 Bilbao 1947-03-02   0.5  1947
##  3 Bilbao 1947-03-03   0    1947
##  4 Bilbao 1947-03-04   3.3  1947
##  5 Bilbao 1947-03-05   1.5  1947
##  6 Bilbao 1947-03-06   0    1947
##  7 Bilbao 1947-03-07   8.5  1947
##  8 Bilbao 1947-03-08   0.3  1947
##  9 Bilbao 1947-03-09   0    1947
## 10 Bilbao 1947-03-10   0    1947
## # ... with 133,333 more rows</code></pre>
<p>We still need to filter and calculate the annual amount of precipitation. Actually, it is not correct to sum up precipitation without taking into account that there are missing values, but it should be enough for this practice. Then, we change the table format with the <code>spread()</code> function, passing from a long to a wide table, that is, we want to obtain one column per weather station.</p>
<pre class="r"><code>pr_yr &lt;- filter(pr, DATE &gt;= &quot;1950-01-01&quot;, DATE &lt; &quot;2018-01-01&quot;) %&gt;%
           group_by(STAID, yr)%&gt;%
             summarise(pr = sum(RR, na.rm = TRUE))
pr_yr</code></pre>
<pre><code>## # A tibble: 324 x 3
## # Groups:   STAID [5]
##    STAID     yr    pr
##    &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 Bilbao  1950 1342 
##  2 Bilbao  1951 1306.
##  3 Bilbao  1952 1355.
##  4 Bilbao  1953 1372.
##  5 Bilbao  1954 1428.
##  6 Bilbao  1955 1062.
##  7 Bilbao  1956 1254.
##  8 Bilbao  1957  968.
##  9 Bilbao  1958 1272.
## 10 Bilbao  1959 1450.
## # ... with 314 more rows</code></pre>
<pre class="r"><code>pr_yr &lt;- spread(pr_yr, STAID, pr)
pr_yr</code></pre>
<pre><code>## # A tibble: 68 x 6
##       yr Bilbao Santiago Barcelona Madrid Valencia
##    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
##  1  1950  1342     1800.      345     NA        NA
##  2  1951  1306.    2344.     1072.   798.       NA
##  3  1952  1355.    1973.      415.   524.       NA
##  4  1953  1372.     973.      683.   365.       NA
##  5  1954  1428.    1348.      581.   246.       NA
##  6  1955  1062.    1769.      530.   473.       NA
##  7  1956  1254.    1533.      695.   480.       NA
##  8  1957   968.    1599.      635.   424.       NA
##  9  1958  1272.    2658.      479.   482.       NA
## 10  1959  1450.    2847.     1006    665.       NA
## # ... with 58 more rows</code></pre>
<p>The next step is to import the climate teleconnection indices.</p>
<pre class="r"><code>#teleconnections
telecon &lt;- read_csv(&quot;teleconnections_indices.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   yr = col_double(),
##   NAO = col_double(),
##   WeMO = col_double(),
##   EA = col_double(),
##   `POL-EUAS` = col_double(),
##   `EATL/WRUS` = col_double(),
##   MO = col_double(),
##   SCAND = col_double(),
##   AO = col_double()
## )</code></pre>
<pre class="r"><code>telecon</code></pre>
<pre><code>## # A tibble: 68 x 9
##       yr   NAO   WeMO     EA `POL-EUAS` `EATL/WRUS`    MO    SCAND       AO
##    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1  1950  0.49  0.555 -0.332     0.0217     -0.0567 0.335  0.301   -1.99e-1
##  2  1951 -0.07  0.379 -0.372     0.402      -0.419  0.149 -0.00667 -3.65e-1
##  3  1952 -0.37  0.693 -0.688    -0.0117     -0.711  0.282  0.0642  -6.75e-1
##  4  1953  0.4  -0.213 -0.727    -0.0567     -0.0508 0.216  0.0233  -1.64e-2
##  5  1954  0.51  1.20  -0.912     0.142      -0.318  0.386  0.458   -5.83e-4
##  6  1955 -0.64  0.138 -0.824    -0.0267      0.154  0.134  0.0392  -3.62e-1
##  7  1956  0.17  0.617 -1.29     -0.197       0.0617 0.256  0.302   -1.63e-1
##  8  1957 -0.02  0.321 -0.952    -0.638      -0.167  0.322 -0.134   -3.42e-1
##  9  1958  0.12  0.941 -0.243     0.138       0.661  0.296  0.279   -8.68e-1
## 10  1959  0.49 -0.055 -0.23     -0.0142      0.631  0.316  0.725   -7.62e-2
## # ... with 58 more rows</code></pre>
<p>Finally we need to join both tables by year.</p>
<pre class="r"><code>data_all &lt;- left_join(pr_yr, telecon, by = &quot;yr&quot;)
data_all</code></pre>
<pre><code>## # A tibble: 68 x 14
##       yr Bilbao Santiago Barcelona Madrid Valencia   NAO   WeMO     EA
##    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1  1950  1342     1800.      345     NA        NA  0.49  0.555 -0.332
##  2  1951  1306.    2344.     1072.   798.       NA -0.07  0.379 -0.372
##  3  1952  1355.    1973.      415.   524.       NA -0.37  0.693 -0.688
##  4  1953  1372.     973.      683.   365.       NA  0.4  -0.213 -0.727
##  5  1954  1428.    1348.      581.   246.       NA  0.51  1.20  -0.912
##  6  1955  1062.    1769.      530.   473.       NA -0.64  0.138 -0.824
##  7  1956  1254.    1533.      695.   480.       NA  0.17  0.617 -1.29 
##  8  1957   968.    1599.      635.   424.       NA -0.02  0.321 -0.952
##  9  1958  1272.    2658.      479.   482.       NA  0.12  0.941 -0.243
## 10  1959  1450.    2847.     1006    665.       NA  0.49 -0.055 -0.23 
## # ... with 58 more rows, and 5 more variables: `POL-EUAS` &lt;dbl&gt;,
## #   `EATL/WRUS` &lt;dbl&gt;, MO &lt;dbl&gt;, SCAND &lt;dbl&gt;, AO &lt;dbl&gt;</code></pre>
</div>
<div id="correlation-test" class="section level2">
<h2>Correlation test</h2>
<p>A correlation test between paired samples can be done with the <code>cor.test()</code> function of R Base. In this case between the annual precipitation of Bilbao and the NAO index.</p>
<pre class="r"><code>cor_nao_bil &lt;- cor.test(data_all$Bilbao, data_all$NAO,
                        method = &quot;spearman&quot;)</code></pre>
<pre><code>## Warning in cor.test.default(data_all$Bilbao, data_all$NAO, method =
## &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<pre class="r"><code>cor_nao_bil</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  data_all$Bilbao and data_all$NAO
## S = 44372, p-value = 0.2126
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.1531149</code></pre>
<pre class="r"><code>str(cor_nao_bil)</code></pre>
<pre><code>## List of 8
##  $ statistic  : Named num 44372
##   ..- attr(*, &quot;names&quot;)= chr &quot;S&quot;
##  $ parameter  : NULL
##  $ p.value    : num 0.213
##  $ estimate   : Named num 0.153
##   ..- attr(*, &quot;names&quot;)= chr &quot;rho&quot;
##  $ null.value : Named num 0
##   ..- attr(*, &quot;names&quot;)= chr &quot;rho&quot;
##  $ alternative: chr &quot;two.sided&quot;
##  $ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##  $ data.name  : chr &quot;data_all$Bilbao and data_all$NAO&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</code></pre>
<p>We see that the result is in an unmanageable and untidy format. It is a console summary of the correlation with all the statistical parameters necessary to get a conclusion about the relationship. The orginal structure is a list of vectors. However, the <code>tidy()</code> function of the <em>{broom}</em> package allows us to convert the result into a table format.</p>
<pre class="r"><code>tidy(cor_nao_bil)</code></pre>
<pre><code>## # A tibble: 1 x 5
##   estimate statistic p.value method                          alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                           &lt;chr&gt;      
## 1    0.153    44372.   0.213 Spearman&#39;s rank correlation rho two.sided</code></pre>
</div>
<div id="apply-the-correlation-test-to-multiple-variables" class="section level2">
<h2>Apply the correlation test to multiple variables</h2>
<p>The objective is to apply the correlation test to all weather stations and climate teleconnection indices.</p>
<p>First, we must pass the table to the long format, that is, create a column/variable for the city and for the value of the corresponding precipitation. Then we repeat the same for the teleconnections indices.</p>
<pre class="r"><code>data &lt;- gather(data_all, city, pr, Bilbao:Valencia)%&gt;%
                     gather(telecon, index, NAO:AO)
data</code></pre>
<pre><code>## # A tibble: 2,720 x 5
##       yr city      pr telecon index
##    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1  1950 Bilbao 1342  NAO      0.49
##  2  1951 Bilbao 1306. NAO     -0.07
##  3  1952 Bilbao 1355. NAO     -0.37
##  4  1953 Bilbao 1372. NAO      0.4 
##  5  1954 Bilbao 1428. NAO      0.51
##  6  1955 Bilbao 1062. NAO     -0.64
##  7  1956 Bilbao 1254. NAO      0.17
##  8  1957 Bilbao  968. NAO     -0.02
##  9  1958 Bilbao 1272. NAO      0.12
## 10  1959 Bilbao 1450. NAO      0.49
## # ... with 2,710 more rows</code></pre>
<p>To apply the test to all cities, we need the corresponding groupings. Therefore, we use the <code>group_by()</code> function for indicating the two groups: <em>city</em> and <em>telecon</em>. In addition, we apply the <code>nest()</code> function of the <em>{tidyr}</em> package (<em>{tidyverse}</em> collection) with the aim of creating lists of tables nested per row. In other words, in each row of each city and teleconnection index we will have a new table that contains the year, the precipitation value and the value of each teleconection, correspondingly.</p>
<pre class="r"><code>data_nest &lt;- group_by(data, city, telecon) %&gt;% nest()
data_nest</code></pre>
<pre><code>## # A tibble: 40 x 3
## # Groups:   city, telecon [40]
##    city      telecon           data
##    &lt;chr&gt;     &lt;chr&gt;   &lt;list&lt;df[,3]&gt;&gt;
##  1 Bilbao    NAO           [68 x 3]
##  2 Santiago  NAO           [68 x 3]
##  3 Barcelona NAO           [68 x 3]
##  4 Madrid    NAO           [68 x 3]
##  5 Valencia  NAO           [68 x 3]
##  6 Bilbao    WeMO          [68 x 3]
##  7 Santiago  WeMO          [68 x 3]
##  8 Barcelona WeMO          [68 x 3]
##  9 Madrid    WeMO          [68 x 3]
## 10 Valencia  WeMO          [68 x 3]
## # ... with 30 more rows</code></pre>
<pre class="r"><code>str(slice(data_nest, 1))</code></pre>
<pre><code>## Classes &#39;grouped_df&#39;, &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:  40 obs. of  3 variables:
##  $ city   : chr  &quot;Barcelona&quot; &quot;Barcelona&quot; &quot;Barcelona&quot; &quot;Barcelona&quot; ...
##  $ telecon: chr  &quot;AO&quot; &quot;EA&quot; &quot;EATL/WRUS&quot; &quot;MO&quot; ...
##  $ data   : list&lt;df[,3]&gt; [1:40] 
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..@ ptype:Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    0 obs. of  3 variables:
##   .. ..$ yr   : num 
##   .. ..$ pr   : num 
##   .. ..$ index: num 
##  - attr(*, &quot;groups&quot;)=Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   40 obs. of  3 variables:
##   ..$ city   : chr  &quot;Barcelona&quot; &quot;Barcelona&quot; &quot;Barcelona&quot; &quot;Barcelona&quot; ...
##   ..$ telecon: chr  &quot;AO&quot; &quot;EA&quot; &quot;EATL/WRUS&quot; &quot;MO&quot; ...
##   ..$ .rows  :List of 40
##   .. ..$ : int 1
##   .. ..$ : int 2
##   .. ..$ : int 3
##   .. ..$ : int 4
##   .. ..$ : int 5
##   .. ..$ : int 6
##   .. ..$ : int 7
##   .. ..$ : int 8
##   .. ..$ : int 9
##   .. ..$ : int 10
##   .. ..$ : int 11
##   .. ..$ : int 12
##   .. ..$ : int 13
##   .. ..$ : int 14
##   .. ..$ : int 15
##   .. ..$ : int 16
##   .. ..$ : int 17
##   .. ..$ : int 18
##   .. ..$ : int 19
##   .. ..$ : int 20
##   .. ..$ : int 21
##   .. ..$ : int 22
##   .. ..$ : int 23
##   .. ..$ : int 24
##   .. ..$ : int 25
##   .. ..$ : int 26
##   .. ..$ : int 27
##   .. ..$ : int 28
##   .. ..$ : int 29
##   .. ..$ : int 30
##   .. ..$ : int 31
##   .. ..$ : int 32
##   .. ..$ : int 33
##   .. ..$ : int 34
##   .. ..$ : int 35
##   .. ..$ : int 36
##   .. ..$ : int 37
##   .. ..$ : int 38
##   .. ..$ : int 39
##   .. ..$ : int 40
##   ..- attr(*, &quot;.drop&quot;)= logi FALSE</code></pre>
<p>The next step is to create a function, in which we define the correlation test and pass it to the clean format using the <code>tidy()</code> function, which we apply to each groupings.</p>
<pre class="r"><code>cor_fun &lt;- function(df) cor.test(df$pr, df$index, method = &quot;spearman&quot;) %&gt;% tidy()</code></pre>
<p>Now we only have to apply our function to the column that contains the tables for each combination between city and teleconnection. To do this, we use the <code>map()</code> function that applies another function to a vector or list. What we do is create a new column that contains the result, a statistical summary table, for each combination.</p>
<pre class="r"><code>data_nest &lt;- mutate(data_nest, model = map(data, cor_fun))
data_nest</code></pre>
<pre><code>## # A tibble: 40 x 4
## # Groups:   city, telecon [40]
##    city      telecon           data model           
##    &lt;chr&gt;     &lt;chr&gt;   &lt;list&lt;df[,3]&gt;&gt; &lt;list&gt;          
##  1 Bilbao    NAO           [68 x 3] &lt;tibble [1 x 5]&gt;
##  2 Santiago  NAO           [68 x 3] &lt;tibble [1 x 5]&gt;
##  3 Barcelona NAO           [68 x 3] &lt;tibble [1 x 5]&gt;
##  4 Madrid    NAO           [68 x 3] &lt;tibble [1 x 5]&gt;
##  5 Valencia  NAO           [68 x 3] &lt;tibble [1 x 5]&gt;
##  6 Bilbao    WeMO          [68 x 3] &lt;tibble [1 x 5]&gt;
##  7 Santiago  WeMO          [68 x 3] &lt;tibble [1 x 5]&gt;
##  8 Barcelona WeMO          [68 x 3] &lt;tibble [1 x 5]&gt;
##  9 Madrid    WeMO          [68 x 3] &lt;tibble [1 x 5]&gt;
## 10 Valencia  WeMO          [68 x 3] &lt;tibble [1 x 5]&gt;
## # ... with 30 more rows</code></pre>
<pre class="r"><code>str(slice(data_nest, 1))</code></pre>
<pre><code>## Classes &#39;grouped_df&#39;, &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:  40 obs. of  4 variables:
##  $ city   : chr  &quot;Barcelona&quot; &quot;Barcelona&quot; &quot;Barcelona&quot; &quot;Barcelona&quot; ...
##  $ telecon: chr  &quot;AO&quot; &quot;EA&quot; &quot;EATL/WRUS&quot; &quot;MO&quot; ...
##  $ data   : list&lt;df[,3]&gt; [1:40] 
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  345 1072 415 683 581 ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1342 1306 1355 1372 1428 ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA 798 524 365 246 ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  1800 2344 1973 973 1348 ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  -0.199333 -0.364667 -0.674917 -0.016417 -0.000583 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  -0.333 -0.372 -0.688 -0.727 -0.912 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  -0.0567 -0.4192 -0.7108 -0.0508 -0.3175 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.335 0.149 0.282 0.216 0.386 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.49 -0.07 -0.37 0.4 0.51 -0.64 0.17 -0.02 0.12 0.49 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.0217 0.4025 -0.0117 -0.0567 0.1425 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.30083 -0.00667 0.06417 0.02333 0.4575 ...
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 68 obs. of  3 variables:
##   .. ..$ yr   : num  1950 1951 1952 1953 1954 ...
##   .. ..$ pr   : num  NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ index: num  0.555 0.379 0.693 -0.213 1.196 ...
##   ..@ ptype:Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    0 obs. of  3 variables:
##   .. ..$ yr   : num 
##   .. ..$ pr   : num 
##   .. ..$ index: num 
##  $ model  :List of 40
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.00989
##   .. ..$ statistic  : num 52912
##   .. ..$ p.value    : num 0.936
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.295
##   .. ..$ statistic  : num 67832
##   .. ..$ p.value    : num 0.0147
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.161
##   .. ..$ statistic  : num 43966
##   .. ..$ p.value    : num 0.19
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.255
##   .. ..$ statistic  : num 65754
##   .. ..$ p.value    : num 0.0361
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.0203
##   .. ..$ statistic  : num 53460
##   .. ..$ p.value    : num 0.869
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.178
##   .. ..$ statistic  : num 43082
##   .. ..$ p.value    : num 0.147
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.161
##   .. ..$ statistic  : num 43970
##   .. ..$ p.value    : num 0.19
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.0292
##   .. ..$ statistic  : num 50862
##   .. ..$ p.value    : num 0.813
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.185
##   .. ..$ statistic  : num 62070
##   .. ..$ p.value    : num 0.131
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.256
##   .. ..$ statistic  : num 65825
##   .. ..$ p.value    : num 0.0348
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.0155
##   .. ..$ statistic  : num 51584
##   .. ..$ p.value    : num 0.9
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.0457
##   .. ..$ statistic  : num 54788
##   .. ..$ p.value    : num 0.711
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.153
##   .. ..$ statistic  : num 44372
##   .. ..$ p.value    : num 0.213
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.147
##   .. ..$ statistic  : num 44670
##   .. ..$ p.value    : num 0.23
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.357
##   .. ..$ statistic  : num 33688
##   .. ..$ p.value    : num 0.00296
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.404
##   .. ..$ statistic  : num 31242
##   .. ..$ p.value    : num 0.000706
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.313
##   .. ..$ statistic  : num 65806
##   .. ..$ p.value    : num 0.0102
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.304
##   .. ..$ statistic  : num 65369
##   .. ..$ p.value    : num 0.0123
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.0643
##   .. ..$ statistic  : num 46893
##   .. ..$ p.value    : num 0.605
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.497
##   .. ..$ statistic  : num 75028
##   .. ..$ p.value    : num 2.42e-05
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.291
##   .. ..$ statistic  : num 64692
##   .. ..$ p.value    : num 0.0169
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.0835
##   .. ..$ statistic  : num 45930
##   .. ..$ p.value    : num 0.501
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.306
##   .. ..$ statistic  : num 34766
##   .. ..$ p.value    : num 0.012
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.109
##   .. ..$ statistic  : num 44660
##   .. ..$ p.value    : num 0.38
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.443
##   .. ..$ statistic  : num 75608
##   .. ..$ p.value    : num 0.00018
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.01
##   .. ..$ statistic  : num 52919
##   .. ..$ p.value    : num 0.935
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.176
##   .. ..$ statistic  : num 43170
##   .. ..$ p.value    : num 0.151
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.19
##   .. ..$ statistic  : num 62364
##   .. ..$ p.value    : num 0.12
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.181
##   .. ..$ statistic  : num 61902
##   .. ..$ p.value    : num 0.139
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.0504
##   .. ..$ statistic  : num 49752
##   .. ..$ p.value    : num 0.682
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.44
##   .. ..$ statistic  : num 29356
##   .. ..$ p.value    : num 0.000203
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.332
##   .. ..$ statistic  : num 35014
##   .. ..$ p.value    : num 0.00594
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.211
##   .. ..$ statistic  : num 19574
##   .. ..$ p.value    : num 0.129
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.0672
##   .. ..$ statistic  : num 26472
##   .. ..$ p.value    : num 0.632
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.0542
##   .. ..$ statistic  : num 23460
##   .. ..$ p.value    : num 0.7
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.0478
##   .. ..$ statistic  : num 25990
##   .. ..$ p.value    : num 0.733
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.113
##   .. ..$ statistic  : num 27600
##   .. ..$ p.value    : num 0.422
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num 0.0971
##   .. ..$ statistic  : num 22396
##   .. ..$ p.value    : num 0.488
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.0795
##   .. ..$ statistic  : num 26776
##   .. ..$ p.value    : num 0.57
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##   ..$ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 1 obs. of  5 variables:
##   .. ..$ estimate   : num -0.252
##   .. ..$ statistic  : num 31056
##   .. ..$ p.value    : num 0.0688
##   .. ..$ method     : chr &quot;Spearman&#39;s rank correlation rho&quot;
##   .. ..$ alternative: chr &quot;two.sided&quot;
##  - attr(*, &quot;groups&quot;)=Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   40 obs. of  3 variables:
##   ..$ city   : chr  &quot;Barcelona&quot; &quot;Barcelona&quot; &quot;Barcelona&quot; &quot;Barcelona&quot; ...
##   ..$ telecon: chr  &quot;AO&quot; &quot;EA&quot; &quot;EATL/WRUS&quot; &quot;MO&quot; ...
##   ..$ .rows  :List of 40
##   .. ..$ : int 1
##   .. ..$ : int 2
##   .. ..$ : int 3
##   .. ..$ : int 4
##   .. ..$ : int 5
##   .. ..$ : int 6
##   .. ..$ : int 7
##   .. ..$ : int 8
##   .. ..$ : int 9
##   .. ..$ : int 10
##   .. ..$ : int 11
##   .. ..$ : int 12
##   .. ..$ : int 13
##   .. ..$ : int 14
##   .. ..$ : int 15
##   .. ..$ : int 16
##   .. ..$ : int 17
##   .. ..$ : int 18
##   .. ..$ : int 19
##   .. ..$ : int 20
##   .. ..$ : int 21
##   .. ..$ : int 22
##   .. ..$ : int 23
##   .. ..$ : int 24
##   .. ..$ : int 25
##   .. ..$ : int 26
##   .. ..$ : int 27
##   .. ..$ : int 28
##   .. ..$ : int 29
##   .. ..$ : int 30
##   .. ..$ : int 31
##   .. ..$ : int 32
##   .. ..$ : int 33
##   .. ..$ : int 34
##   .. ..$ : int 35
##   .. ..$ : int 36
##   .. ..$ : int 37
##   .. ..$ : int 38
##   .. ..$ : int 39
##   .. ..$ : int 40
##   ..- attr(*, &quot;.drop&quot;)= logi FALSE</code></pre>
<p>How can we undo the list of tables in each row of our table?</p>
<p>First we eliminate the column with the data and then simply we can apply the <code>unnest()</code> function.</p>
<pre class="r"><code>corr_pr &lt;- select(data_nest, -data) %&gt;% unnest()</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(model)`</code></pre>
<pre class="r"><code>corr_pr</code></pre>
<pre><code>## # A tibble: 40 x 7
## # Groups:   city, telecon [40]
##    city    telecon estimate statistic  p.value method           alternative
##    &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;      
##  1 Bilbao  NAO       0.153     44372. 0.213    Spearman&#39;s rank~ two.sided  
##  2 Santia~ NAO      -0.181     61902. 0.139    Spearman&#39;s rank~ two.sided  
##  3 Barcel~ NAO      -0.0203    53460. 0.869    Spearman&#39;s rank~ two.sided  
##  4 Madrid  NAO      -0.291     64692. 0.0169   Spearman&#39;s rank~ two.sided  
##  5 Valenc~ NAO      -0.113     27600. 0.422    Spearman&#39;s rank~ two.sided  
##  6 Bilbao  WeMO      0.404     31242. 0.000706 Spearman&#39;s rank~ two.sided  
##  7 Santia~ WeMO      0.332     35014. 0.00594  Spearman&#39;s rank~ two.sided  
##  8 Barcel~ WeMO      0.0292    50862  0.813    Spearman&#39;s rank~ two.sided  
##  9 Madrid  WeMO      0.109     44660  0.380    Spearman&#39;s rank~ two.sided  
## 10 Valenc~ WeMO     -0.252     31056. 0.0688   Spearman&#39;s rank~ two.sided  
## # ... with 30 more rows</code></pre>
<p>The result is a table in which we can see the correlations and their statistical significance for each city and teleconnection index.</p>
</div>
<div id="heatmap-of-the-results" class="section level2">
<h2>Heatmap of the results</h2>
<p>Finally, we make a heatmap of the obtained result. But, previously we create a column that indicates whether the correlation is significant with p-value less than 0.05.</p>
<pre class="r"><code>corr_pr &lt;- mutate(corr_pr, sig = ifelse(p.value &lt;0.05, &quot;Sig.&quot;, &quot;Non Sig.&quot;))</code></pre>
<pre class="r"><code>ggplot()+
  geom_tile(data = corr_pr,
            aes(city, telecon, fill = estimate),
            size = 1,
            colour = &quot;white&quot;)+
  geom_tile(data = filter(corr_pr, sig == &quot;Sig.&quot;),
            aes(city, telecon),
            size = 1,
            colour = &quot;black&quot;,
            fill = &quot;transparent&quot;)+
  geom_text(data = corr_pr,
            aes(city, telecon, label = round(estimate, 2),
            fontface = ifelse(sig == &quot;Sig.&quot;, &quot;bold&quot;, &quot;plain&quot;)))+
  scale_fill_gradient2(breaks = seq(-1, 1, 0.2))+
  labs(x = &quot;&quot;, y = &quot;&quot;, fill = &quot;&quot;, p.value = &quot;&quot;)+
  theme_minimal()+
  theme(panel.grid.major = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank())</code></pre>
<p><img src="/post/en/2019-04-17-tidy-correlation-tests-in-r/index.en_files/figure-html/unnamed-chunk-15-1.png" width="2100" /></p>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/en/tags/correlation/">correlation</a>
  
  <a class="badge badge-light" href="/en/tags/variables/">variables</a>
  
  <a class="badge badge-light" href="/en/tags/tidy/">tidy</a>
  
  <a class="badge badge-light" href="/en/tags/tests/">tests</a>
  
</div>



    






<div class="media author-card" itemscope itemtype="http://schema.org/Person">
  
  <img class="portrait mr-3" src="/img/potrai_domi.jpg" itemprop="image" alt="Avatar">
  
  <div class="media-body">
    <h5 class="card-title" itemprop="name"><a href="/en/">Dr. Dominic Royé</a></h5>
    
    
    <ul class="network-icon" aria-hidden="true">
      
      
      
      
      
      
      
      
      <li>
        <a itemprop="sameAs" href="mailto:dominic.roye@usc.es" >
          <i class="fa fa-envelope"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="//twitter.com/dr_xeo" >
          <i class="fab fa-twitter"></i>
        </a>
      </li>
      
      
      
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://www.researchgate.net/profile/Dominic_Roye" target="_blank" rel="noopener">
          <i class="ai ai-researchgate"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="//github.com/dominicroye" >
          <i class="fab fa-github"></i>
        </a>
      </li>
      
    </ul>
  </div>
</div>




    
    

    
    <div class="article-widget">
      <div class="post-nav">
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="https://dominicroye.github.io/en/2019/visualize-monthly-precipitation-anomalies/" rel="next">Visualize monthly precipitation anomalies</a>
  </div>
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="https://dominicroye.github.io/en/2019/import-excel-sheets-with-r/" rel="prev">Import Excel sheets with R</a>
  </div>
  
</div>

    </div>
    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-dominicroye-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<div class="container">
  <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2018-2020 Dominic Royé. All rights reserved. &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    
    <script id="dsq-count-scr" src="//https-dominicroye-github-io.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    <script src="/js/academic.min.d037ee5294b166a79dec317c58aea9cc.js"></script>

    

  </body>
</html>

