<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.2.0">
  <meta name="generator" content="Hugo 0.55.4" />
  <meta name="author" content="Dr. Dominic Royé">

  
  
  
  
    
  
  <meta name="description" content="The climate of a place is usually presented through climographs that combine monthly precipitation and temperature in a single chart. However, it is also interesting to visualize the climate on a daily scale showing the thermal amplitude and the daily average temperature. To do this, the averages for each day of the year of the daily minimums, maximums and averages are calculated. The annual climate cycle presents a good opportunity to use a radial or polar which allows us to clearly visualize seasonal patterns.">

  
  <link rel="alternate" hreflang="en-us" href="https://dominicroye.github.io/en/2021/climate-circles/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css" crossorigin="anonymous">
      
    

    

    

  

  
  

  <link rel="stylesheet" href="/en/styles.css">
  
  <link rel="stylesheet" href="/css/override.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-27463794-2', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="https://dominicroye.github.io/index.xml" type="application/rss+xml" title="Dominic Royé">
  <link rel="feed" href="https://dominicroye.github.io/index.xml" type="application/rss+xml" title="Dominic Royé">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://dominicroye.github.io/en/2021/climate-circles/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Dominic Royé">
  <meta property="og:url" content="https://dominicroye.github.io/en/2021/climate-circles/">
  <meta property="og:title" content="Climate circles | Dominic Royé">
  <meta property="og:description" content="The climate of a place is usually presented through climographs that combine monthly precipitation and temperature in a single chart. However, it is also interesting to visualize the climate on a daily scale showing the thermal amplitude and the daily average temperature. To do this, the averages for each day of the year of the daily minimums, maximums and averages are calculated. The annual climate cycle presents a good opportunity to use a radial or polar which allows us to clearly visualize seasonal patterns."><meta property="og:image" content="https://dominicroye.github.io/en/2021/climate-circles/featured.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2021-09-04T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2021-09-04T00:00:00&#43;00:00">
  

  

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#2962ff",
          "text": "#fff"
        },
        "button": {
          "background": "#fff",
          "text": "#2962ff"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://cookies.insites.com"
      }
    })});
</script>


  

  <title>Climate circles | Dominic Royé</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>

<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/en/"><div style="position:relative;float:left">Dominic Royé<img src="/img/portrait.jpg" alt="Dominic Royé" style="float: left;"></div></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#">
            
            <span>home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#posts">
            
            <span>blog</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#publications_selected">
            
            <span>publications</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#graphs">
            
            <span>graphs</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#teaching">
            
            <span>more</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/en/#about">
            
            <span>me</span>
            
          </a>
        </li>

        
        

      

        

        

        

        

      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  













<div class="article-header d-xl-none">
  <div class="featured-image" style="background-image: url('/en/2021/climate-circles/featured_hucf545943ee9a8776ede44ba4616bdedb_3024821_800x0_resize_box_2.png');"></div>
  
</div>


<div class="container-fluid split-header d-none d-xl-block">
  <div class="row">
    <div class="col-6">
      <div class="split-header-content">
        <h1 itemprop="name">Climate circles</h1>

        

        

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>
  

  <span class="article-date">
    
    <meta content="2021-09-04 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2021-09-04 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      2021-09-04
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>

  

  
  
  <span class="middot-divider"></span>
  <a href="/en/2021/climate-circles/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/en/categories/r/">R</a>, 
    
    <a href="">R:elementary</a>, 
    
    <a href="/en/categories/visualization/">visualization</a>
    
  </span>
  
  

  

</div>


        







  










        
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Climate%20circles&amp;url=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f&amp;title=Climate%20circles"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f&amp;title=Climate%20circles"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Climate%20circles&amp;body=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


      </div>
    </div>
    <div class="col-6">
      <div class="split-header-image">
        <img src="/en/2021/climate-circles/featured_hucf545943ee9a8776ede44ba4616bdedb_3024821_680x500_fill_q90_box_smart1_2.png" itemprop="image" alt="">
        
      </div>
    </div>
  </div>
</div>

<div class="article-container d-xl-none">
  <h1 itemprop="name">Climate circles</h1>

  

  

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>
  

  <span class="article-date">
    
    <meta content="2021-09-04 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2021-09-04 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      2021-09-04
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>

  

  
  
  <span class="middot-divider"></span>
  <a href="/en/2021/climate-circles/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/en/categories/r/">R</a>, 
    
    <a href="">R:elementary</a>, 
    
    <a href="/en/categories/visualization/">visualization</a>
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Climate%20circles&amp;url=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f&amp;title=Climate%20circles"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f&amp;title=Climate%20circles"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Climate%20circles&amp;body=https%3a%2f%2fdominicroye.github.io%2fen%2f2021%2fclimate-circles%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


  







  









</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      
<script src="https://dominicroye.github.io/en/2021/climate-circles/index.en_files/header-attrs/header-attrs.js"></script>


<p>The climate of a place is usually presented through climographs that combine monthly precipitation and temperature in a single chart. However, it is also interesting to visualize the climate on a daily scale showing the thermal amplitude and the daily average temperature. To do this, the averages for each day of the year of the daily minimums, maximums and averages are calculated.</p>
<p>The annual climate cycle presents a good opportunity to use a radial or polar which allows us to clearly visualize seasonal patterns.</p>
<div id="packages" class="section level1">
<h1>Packages</h1>
<p>We will use the following packages:</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tidyverse</td>
<td align="left">Collection of packages (visualization, manipulation): ggplot2, dplyr, purrr, etc.</td>
</tr>
<tr class="even">
<td align="left">fs</td>
<td align="left">Provides a cross-platform, uniform interface to file system operations</td>
</tr>
<tr class="odd">
<td align="left">lubridate</td>
<td align="left">Easy manipulation of dates and times</td>
</tr>
<tr class="even">
<td align="left">janitor</td>
<td align="left">Simple functions to examine and clean data</td>
</tr>
</tbody>
</table>
<pre class="r"><code># install the packages if necessary

if(!require(&quot;tidyverse&quot;)) install.packages(&quot;tidyverse&quot;)
if(!require(&quot;fs&quot;)) install.packages(&quot;fs&quot;)
if(!require(&quot;lubridate&quot;)) install.packages(&quot;lubridate&quot;)

# packages

library(tidyverse)
library(lubridate)
library(fs)
library(janitor)</code></pre>
</div>
<div id="preparation" class="section level1">
<h1>Preparation</h1>
<div id="data" class="section level2">
<h2>Data</h2>
<p>We downloaded the temperature data for a selection of US cities <a href="/files/weather_stats_usa.zip">download</a>. You can download other cities of the entire world through the WMO or GHCN datasets at <a href="https://gis.ncdc.noaa.gov/maps/ncei/cdo/daily">NCDC/NOAA</a>.</p>
</div>
<div id="import" class="section level2">
<h2>Import</h2>
<p>To import the temperature time series of each city, which we find in several files, we apply the <code>read_csv()</code> function using <code>map_df()</code>. The <code>dir_ls()</code> function of the <code>fs</code> package returns the list of files with <em>csv</em> extension. The suffix of <code>map()</code> indicates that we want to join all the imported tables into a single one. For those with less experience with <code>tidyverse</code>, I recommend a short introduction on this blog <a href="https://dominicroye.github.io/en/2020/a-very-short-introduction-to-tidyverse/">post</a>.</p>
<p>Then we obtain the names of the weather stations and define a new vector with the new city names.</p>
<pre class="r"><code># import data
meteo &lt;- dir_ls(regexp = &quot;.csv$&quot;) %&gt;% 
          map_df(read_csv)
meteo</code></pre>
<pre><code>## # A tibble: 211,825 x 12
##    STATION     NAME    LATITUDE LONGITUDE ELEVATION DATE        TAVG  TMAX  TMIN
##    &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-01   6.8    NA    NA
##  2 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-02   8.4    NA    NA
##  3 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-03  11      NA    NA
##  4 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-04  -7.2    NA    NA
##  5 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-05 -10.2    NA    NA
##  6 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-06  -4.6    NA    NA
##  7 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-07  -7.1    NA    NA
##  8 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-08  -5.8    NA    NA
##  9 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-09   2.9    NA    NA
## 10 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-10   3.9    NA    NA
## # ... with 211,815 more rows, and 3 more variables: TAVG_ATTRIBUTES &lt;chr&gt;,
## #   TMAX_ATTRIBUTES &lt;chr&gt;, TMIN_ATTRIBUTES &lt;chr&gt;</code></pre>
<pre class="r"><code># station names
stats_names &lt;- unique(meteo$NAME)
stats_names</code></pre>
<pre><code>## [1] &quot;CHICAGO OHARE INTERNATIONAL AIRPORT, IL US&quot;             
## [2] &quot;LAGUARDIA AIRPORT, NY US&quot;                               
## [3] &quot;MIAMI INTERNATIONAL AIRPORT, FL US&quot;                     
## [4] &quot;HOUSTON INTERCONTINENTAL AIRPORT, TX US&quot;                
## [5] &quot;ATLANTA HARTSFIELD JACKSON INTERNATIONAL AIRPORT, GA US&quot;
## [6] &quot;SAN FRANCISCO INTERNATIONAL AIRPORT, CA US&quot;             
## [7] &quot;SEATTLE TACOMA AIRPORT, WA US&quot;                          
## [8] &quot;DENVER INTERNATIONAL AIRPORT, CO US&quot;                    
## [9] &quot;MCCARRAN INTERNATIONAL AIRPORT, NV US&quot;</code></pre>
<pre class="r"><code># new city names
cities &lt;- c(&quot;CHICAGO&quot;, &quot;NEW YORK&quot;, &quot;MIAMI&quot;, 
            &quot;HOUSTON&quot;, &quot;ATLANTA&quot;, &quot;SAN FRANCISCO&quot;, 
            &quot;SEATTLE&quot;, &quot;DENVER&quot;, &quot;LAS VEGAS&quot;)</code></pre>
</div>
<div id="modify" class="section level2">
<h2>Modify</h2>
<p>In the first step we will modify the original data, 1) selecting only the columns of interest, 2) filtering the period 1991-2020, 3) defining the new city names, 4) calculating the average temperature where it is absent, 5) cleaning the column names, and 6) creating a new variable with the days of the year. The <code>clean_names()</code> function of the <code>janitor</code> package is very useful for getting clean column names.</p>
<pre class="r"><code>meteo &lt;- select(meteo, NAME, DATE, TAVG:TMIN) %&gt;%  
           filter(DATE &gt;= &quot;1991-01-01&quot;, DATE &lt;= &quot;2020-12-31&quot;) %&gt;% 
            mutate(NAME = factor(NAME, stats_names, cities),
                   TAVG = ifelse(is.na(TAVG), (TMAX+TMIN)/2, TAVG),
                   yd = yday(DATE)) %&gt;% 
            clean_names()</code></pre>
<p>In the next step we calculate the average of the daily maximum, minimum and mean temperature for each day of the year. It now only remains to convert the days of the year into a dummy date. Here we use the year 2000 since it is a leap year and we have a total of 366 days.</p>
<pre class="r"><code># estimate the daily averages
meteo_yday &lt;- group_by(meteo, name, yd) %&gt;% 
                  summarise(ta = mean(tavg, na.rm = TRUE),
                            tmx = mean(tmax, na.rm = TRUE),
                            tmin = mean(tmin, na.rm = TRUE))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;name&#39;. You can override using the `.groups` argument.</code></pre>
<pre class="r"><code>meteo_yday</code></pre>
<pre><code>## # A tibble: 3,294 x 5
## # Groups:   name [9]
##    name       yd    ta    tmx  tmin
##    &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 CHICAGO     1 -3.77  0.537 -7.86
##  2 CHICAGO     2 -2.64  1.03  -6.68
##  3 CHICAGO     3 -2.88  0.78  -6.93
##  4 CHICAGO     4 -2.86  0.753 -7.10
##  5 CHICAGO     5 -4.13 -0.137 -8.33
##  6 CHICAGO     6 -4.50 -1.15  -8.05
##  7 CHICAGO     7 -4.70 -0.493 -8.57
##  8 CHICAGO     8 -3.97  0.147 -8.02
##  9 CHICAGO     9 -3.47  0.547 -7.49
## 10 CHICAGO    10 -3.41  1.09  -7.64
## # ... with 3,284 more rows</code></pre>
<pre class="r"><code># convert the days of the year into a dummy date
meteo_yday &lt;- mutate(meteo_yday, yd = as_date(yd, origin = &quot;1999-12-31&quot;))</code></pre>
</div>
</div>
<div id="creating-the-climate-circles" class="section level1">
<h1>Creating the climate circles</h1>
<div id="predefinitions" class="section level2">
<h2>Predefinitions</h2>
<p>We define a divergent vector of various hues.</p>
<pre class="r"><code>col_temp &lt;- c(&quot;#cbebf6&quot;,&quot;#a7bfd9&quot;,&quot;#8c99bc&quot;,&quot;#974ea8&quot;,&quot;#830f74&quot;,
              &quot;#0b144f&quot;,&quot;#0e2680&quot;,&quot;#223b97&quot;,&quot;#1c499a&quot;,&quot;#2859a5&quot;,
              &quot;#1b6aa3&quot;,&quot;#1d9bc4&quot;,&quot;#1ca4bc&quot;,&quot;#64c6c7&quot;,&quot;#86cabb&quot;,
              &quot;#91e0a7&quot;,&quot;#c7eebf&quot;,&quot;#ebf8da&quot;,&quot;#f6fdd1&quot;,&quot;#fdeca7&quot;,
              &quot;#f8da77&quot;,&quot;#fcb34d&quot;,&quot;#fc8c44&quot;,&quot;#f85127&quot;,&quot;#f52f26&quot;,
              &quot;#d10b26&quot;,&quot;#9c042a&quot;,&quot;#760324&quot;,&quot;#18000c&quot;)</code></pre>
<p>We create a table with the x-axis grid lines.</p>
<pre class="r"><code>grid_x &lt;- tibble(x = seq(ymd(&quot;2000-01-01&quot;), ymd(&quot;2000-12-31&quot;), &quot;month&quot;), 
                 y = rep(-10, 12), 
                 xend = seq(ymd(&quot;2000-01-01&quot;), ymd(&quot;2000-12-31&quot;), &quot;month&quot;), 
                 yend = rep(41, 12))</code></pre>
<p>We define all the style elements of the graph in our own theme <code>theme_cc()</code>.</p>
<pre class="r"><code>theme_cc &lt;- function(){ 
  
 theme_minimal(base_family = &quot;Montserrat&quot;) %+replace%
  theme(plot.title = element_text(hjust = 0.5, colour = &quot;white&quot;, size = 30, margin = margin(b = 20)),
        plot.caption = element_text(colour = &quot;white&quot;, size = 9, hjust = .5, vjust = -30),
        plot.background = element_rect(fill = &quot;black&quot;),
        plot.margin = margin(1, 1, 2, 1, unit = &quot;cm&quot;),
  
        axis.text.x = element_text(face = &quot;italic&quot;, colour = &quot;white&quot;),
        axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        
        legend.title = element_text(colour = &quot;white&quot;),
        legend.position = &quot;bottom&quot;,
        legend.justification = 0.5,
        legend.text = element_text(colour = &quot;white&quot;),
       
        
        strip.text = element_text(colour = &quot;white&quot;, face = &quot;bold&quot;, size = 14),
        
        panel.spacing.y = unit(1, &quot;lines&quot;),
        panel.background = element_rect(fill = &quot;black&quot;),
        panel.grid = element_blank()
      ) 
}</code></pre>
</div>
<div id="graph" class="section level2">
<h2>Graph</h2>
<p>We start by building a chart for New York City only. We will use <code>geom_linerange()</code> defining the range with the daily maximum and minimum temperature. Also, we will draw the range line color based on the mean temperature. We can adjust <em>alpha</em> and <em>size</em> to get a nicer look.</p>
<pre class="r"><code># filter New York
ny_city &lt;- filter(meteo_yday, name == &quot;NEW YORK&quot;) 

# graph
ggplot(ny_city) + 
  geom_linerange(aes(yd, 
                     ymax = tmx, 
                     ymin = tmin, 
                     colour = ta),
                 size=0.5, 
                 alpha = .7) + 
  scale_y_continuous(breaks = seq(-30, 50, 10), 
                     limits = c(-11, 42), 
                     expand = expansion()) +
  scale_colour_gradientn(colours = col_temp, 
                         limits = c(-12, 35), 
                         breaks = seq(-12, 34, 5)) + 
  scale_x_date(date_breaks = &quot;month&quot;,
               date_labels = &quot;%b&quot;) +
  labs(title = &quot;CLIMATE CIRCLES&quot;, 
       colour = &quot;Daily average temperature&quot;) </code></pre>
<p><img src="https://dominicroye.github.io/en/2021/climate-circles/index.en_files/figure-html/unnamed-chunk-10-1.png" width="2100" /></p>
<p>To get the polar graph it would only be necessary to add the function <code>coord_polar()</code>.</p>
<pre class="r"><code># polar chart
ggplot(ny_city) + 
  geom_linerange(aes(yd, 
                     ymax = tmx, 
                     ymin = tmin, 
                     colour = ta),
                 size=0.5, 
                 alpha = .7) + 
  scale_y_continuous(breaks = seq(-30, 50, 10), 
                     limits = c(-11, 42), 
                     expand = expansion()) +
  scale_colour_gradientn(colours = col_temp, 
                         limits = c(-12, 35), 
                         breaks = seq(-12, 34, 5)) + 
  scale_x_date(date_breaks = &quot;month&quot;,
               date_labels = &quot;%b&quot;) +
  coord_polar() +
  labs(title = &quot;CLIMATE CIRCLES&quot;, 
       colour = &quot;Daily average temperature&quot;) </code></pre>
<p><img src="https://dominicroye.github.io/en/2021/climate-circles/index.en_files/figure-html/unnamed-chunk-11-1.png" width="2100" /></p>
<p>In the final graph we add the grid defining the lines on the y-axis with <code>geom_hline()</code>, and those on the x-axis with <code>geom_segement()</code>. The most important thing here is the <code>facet_wrap()</code> function, which allows the creation of multiple facets of charts. The formula format is used to specify how the facets are created: <code>row ~ column</code>. In case we do not have a second variable, a point <code>.</code> is indicated in the formula. In addition, we make changes to the appearance of the color bar with <code>guides()</code> and <code>guide_colourbar()</code>, and we include the <code>theme_cc()</code> style.</p>
<pre class="r"><code>ggplot(meteo_yday) + 
  geom_hline(yintercept = c(-10, 0, 10, 20, 30, 40), 
             colour = &quot;white&quot;, 
             size = .4) +
  geom_segment(data = grid_x , 
               aes(x = x, 
                   y = y, 
                   xend = xend, 
                   yend = yend), 
               linetype = &quot;dashed&quot;, 
               colour = &quot;white&quot;, 
               size = .2) +
  geom_linerange(aes(yd, 
                     ymax = tmx, 
                     ymin = tmin, 
                     colour = ta),
                 size=0.5, 
                 alpha = .7) + 
  scale_y_continuous(breaks = seq(-30, 50, 10), 
                     limits = c(-11, 42), 
                     expand = expansion())+
  scale_colour_gradientn(colours = col_temp, 
                         limits = c(-12, 35), 
                         breaks = seq(-12, 34, 5)) + 
  scale_x_date(date_breaks = &quot;month&quot;, 
               date_labels = &quot;%b&quot;) +
  guides(colour = guide_colourbar(barwidth = 15,
                                  barheight = 0.5, 
                                  title.position = &quot;top&quot;)
         ) +
  facet_wrap(~name, nrow = 3) +
  coord_polar() + 
  labs(title = &quot;CLIMATE CIRCLES&quot;, 
       colour = &quot;Daily average temperature&quot;) +
  theme_cc()</code></pre>
<p><img src="https://dominicroye.github.io/en/2021/climate-circles/index.en_files/figure-html/unnamed-chunk-13-1.png" width="3540" /></p>
</div>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/en/tags/climate/">climate</a>
  
  <a class="badge badge-light" href="/en/tags/polar/">polar</a>
  
  <a class="badge badge-light" href="/en/tags/temperatures/">temperatures</a>
  
</div>



    






<div class="media author-card" itemscope itemtype="http://schema.org/Person">
  
  <img class="portrait mr-3" src="/img/potrai_domi.jpg" itemprop="image" alt="Avatar">
  
  <div class="media-body">
    <h5 class="card-title" itemprop="name"><a href="/en/">Dr. Dominic Royé</a></h5>
    
    
    <ul class="network-icon" aria-hidden="true">
      
      
      
      
      
      
      
      
      <li>
        <a itemprop="sameAs" href="mailto:dominic.roye@usc.es" >
          <i class="fa fa-envelope"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="//twitter.com/dr_xeo" >
          <i class="fab fa-twitter"></i>
        </a>
      </li>
      
      
      
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://www.researchgate.net/profile/Dominic_Roye" target="_blank" rel="noopener">
          <i class="ai ai-researchgate"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="//github.com/dominicroye" >
          <i class="fab fa-github"></i>
        </a>
      </li>
      
    </ul>
  </div>
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="/en/graphs/climate/">Climate and Weather</a></li>
        
        <li><a href="/en/2020/a-heatmap-as-calendar/">A heatmap as calendar</a></li>
        
        <li><a href="/en/2020/visualize-climate-anomalies/">Visualize climate anomalies</a></li>
        
        <li><a href="/en/2019/visualize-monthly-precipitation-anomalies/">Visualize monthly precipitation anomalies</a></li>
        
      </ul>
    </div>
    

    
    <div class="article-widget">
      <div class="post-nav">
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="https://dominicroye.github.io/en/2021/firefly-cartography/" rel="prev">Firefly cartography</a>
  </div>
  
</div>

    </div>
    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-dominicroye-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<div class="container">
  <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2018-2021 Dominic Royé. All rights reserved. &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    
    <script id="dsq-count-scr" src="//https-dominicroye-github-io.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    <script src="/js/academic.min.d037ee5294b166a79dec317c58aea9cc.js"></script>

    

  </body>
</html>

