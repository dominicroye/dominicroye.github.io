<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  
  









  




  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Dr. Dominic Royé" />

  
  
  
    
  
  <meta name="description" content="The climate of a place is usually presented through climographs that combine monthly precipitation and temperature in a single chart. However, it is also interesting to visualize the climate on a daily scale showing the thermal amplitude and the daily average temperature. To do this, the averages for each day of the year of the daily minimums, maximums and averages are calculated. The annual climate cycle presents a good opportunity to use a radial or polar which allows us to clearly visualize seasonal patterns." />

  
  <link rel="alternate" hreflang="en-us" href="https://dominicroye.github.io/en/2021/climate-circles/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.b48d89910a3f8560bb2d78fedea8d682.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-27463794-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-27463794-2', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/en/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu27cb63416a395b8c8d0d7112b85e26a9_17299_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu27cb63416a395b8c8d0d7112b85e26a9_17299_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://dominicroye.github.io/en/2021/climate-circles/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@@dr_xeo" />
    <meta property="twitter:creator" content="@@dr_xeo" />
  
  <meta property="og:site_name" content="Dr. Dominic Royé" />
  <meta property="og:url" content="https://dominicroye.github.io/en/2021/climate-circles/" />
  <meta property="og:title" content="Climate circles | Dr. Dominic Royé" />
  <meta property="og:description" content="The climate of a place is usually presented through climographs that combine monthly precipitation and temperature in a single chart. However, it is also interesting to visualize the climate on a daily scale showing the thermal amplitude and the daily average temperature. To do this, the averages for each day of the year of the daily minimums, maximums and averages are calculated. The annual climate cycle presents a good opportunity to use a radial or polar which allows us to clearly visualize seasonal patterns." /><meta property="og:image" content="https://dominicroye.github.io/en/2021/climate-circles/featured.png" />
    <meta property="twitter:image" content="https://dominicroye.github.io/en/2021/climate-circles/featured.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-09-04T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-09-04T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://dominicroye.github.io/en/2021/climate-circles/"
  },
  "headline": "Climate circles",
  
  "image": [
    "https://dominicroye.github.io/en/2021/climate-circles/featured.png"
  ],
  
  "datePublished": "2021-09-04T00:00:00Z",
  "dateModified": "2021-09-04T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Dr. Dominic Royé"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "University of Santiago de Compostela",
    "logo": {
      "@type": "ImageObject",
      "url": "https://dominicroye.github.io/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_192x192_fit_lanczos_3.png"
    }
  },
  "description": "The climate of a place is usually presented through climographs that combine monthly precipitation and temperature in a single chart. However, it is also interesting to visualize the climate on a daily scale showing the thermal amplitude and the daily average temperature. To do this, the averages for each day of the year of the daily minimums, maximums and averages are calculated. The annual climate cycle presents a good opportunity to use a radial or polar which allows us to clearly visualize seasonal patterns."
}
</script>

  

  

  

  





  <title>Climate circles | Dr. Dominic Royé</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="cd985bb602720b738965f25d570bacb9" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.2da3b1fa37e894630bf6de39b1b694b3.js"></script>

  




  <div class="page-header">
    







 



  


<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/en/"><img src="/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_0x70_resize_lanczos_3.png" alt="Dr. Dominic Royé"
            
            >
             <div style = "padding-top:0.5em;">Dr. Dominic Royé</div></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/en/"><img src="/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_0x70_resize_lanczos_3.png" alt="Dr. Dominic Royé"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          

          

          
          
          
          

          
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/en/#"><span>home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/en/#posts"><span>blog</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/en/#featured"><span>publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/en/#projects"><span>graphs</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/en/#about"><span>me</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/dr_xeo" data-toggle="tooltip" data-placement="bottom" title="Follow me on Twitter" target="_blank" rel="noopener" aria-label="Follow me on Twitter">
                <i class="fab fa-twitter" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        

        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Climate circles</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    2021-09-04
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min read
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/en/category/r/">R</a>, <a href="/en/category/relementary/">R:elementary</a>, <a href="/en/category/visualization/">visualization</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 915px;">
  <div style="position: relative">
    <img src="/en/2021/climate-circles/featured_hucf545943ee9a8776ede44ba4616bdedb_3024821_720x0_resize_lanczos_3.png" width="720" height="915" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="https://dominicroye.github.io/en/2021/climate-circles/index.en_files/header-attrs/header-attrs.js"></script>


<p>The climate of a place is usually presented through climographs that combine monthly precipitation and temperature in a single chart. However, it is also interesting to visualize the climate on a daily scale showing the thermal amplitude and the daily average temperature. To do this, the averages for each day of the year of daily minimums, maximums and means are calculated.</p>
<p>The annual climate cycle presents a good opportunity to use a radial or polar chart which allows us to clearly visualize seasonal patterns.</p>
<div id="packages" class="section level1">
<h1>Packages</h1>
<p>We will use the following packages:</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tidyverse</td>
<td align="left">Collection of packages (visualization, manipulation): ggplot2, dplyr, purrr, etc.</td>
</tr>
<tr class="even">
<td align="left">fs</td>
<td align="left">Provides a cross-platform, uniform interface to file system operations</td>
</tr>
<tr class="odd">
<td align="left">lubridate</td>
<td align="left">Easy manipulation of dates and times</td>
</tr>
<tr class="even">
<td align="left">janitor</td>
<td align="left">Simple functions to examine and clean data</td>
</tr>
</tbody>
</table>
<pre class="r"><code># install the packages if necessary

if(!require(&quot;tidyverse&quot;)) install.packages(&quot;tidyverse&quot;)
if(!require(&quot;fs&quot;)) install.packages(&quot;fs&quot;)
if(!require(&quot;lubridate&quot;)) install.packages(&quot;lubridate&quot;)

# packages

library(tidyverse)
library(lubridate)
library(fs)
library(janitor)</code></pre>
</div>
<div id="preparation" class="section level1">
<h1>Preparation</h1>
<div id="data" class="section level2">
<h2>Data</h2>
<p>We download the temperature data for a selection of US cities <a href="/files/weather_stats_usa.zip">here</a>. You can access other cities of the entire world through the WMO or GHCN datasets at <a href="https://gis.ncdc.noaa.gov/maps/ncei/cdo/daily">NCDC/NOAA</a>.</p>
</div>
<div id="import" class="section level2">
<h2>Import</h2>
<p>To import the temperature time series of each city, which we find in several files, we apply the <code>read_csv()</code> function using <code>map_df()</code>. The <code>dir_ls()</code> function of the <code>fs</code> package returns the list of files with <em>csv</em> extension. The suffix <em>df</em> of <code>map()</code> indicates that we want to join all imported tables into a single one. For those with less experience with <code>tidyverse</code>, I recommend a short introduction on this blog <a href="https://dominicroye.github.io/en/2020/a-very-short-introduction-to-tidyverse/">post</a>.</p>
<p>Then we obtain the names of the weather stations and define a new vector with the new city names.</p>
<pre class="r"><code># import data
meteo &lt;- dir_ls(regexp = &quot;.csv$&quot;) %&gt;% 
          map_df(read_csv)
meteo</code></pre>
<pre><code>## # A tibble: 211,825 x 12
##    STATION     NAME    LATITUDE LONGITUDE ELEVATION DATE        TAVG  TMAX  TMIN
##    &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-01   6.8    NA    NA
##  2 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-02   8.4    NA    NA
##  3 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-03  11      NA    NA
##  4 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-04  -7.2    NA    NA
##  5 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-05 -10.2    NA    NA
##  6 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-06  -4.6    NA    NA
##  7 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-07  -7.1    NA    NA
##  8 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-08  -5.8    NA    NA
##  9 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-09   2.9    NA    NA
## 10 USW00094846 CHICAG~     42.0     -87.9      202. 1950-01-10   3.9    NA    NA
## # ... with 211,815 more rows, and 3 more variables: TAVG_ATTRIBUTES &lt;chr&gt;,
## #   TMAX_ATTRIBUTES &lt;chr&gt;, TMIN_ATTRIBUTES &lt;chr&gt;</code></pre>
<pre class="r"><code># station names
stats_names &lt;- unique(meteo$NAME)
stats_names</code></pre>
<pre><code>## [1] &quot;CHICAGO OHARE INTERNATIONAL AIRPORT, IL US&quot;             
## [2] &quot;LAGUARDIA AIRPORT, NY US&quot;                               
## [3] &quot;MIAMI INTERNATIONAL AIRPORT, FL US&quot;                     
## [4] &quot;HOUSTON INTERCONTINENTAL AIRPORT, TX US&quot;                
## [5] &quot;ATLANTA HARTSFIELD JACKSON INTERNATIONAL AIRPORT, GA US&quot;
## [6] &quot;SAN FRANCISCO INTERNATIONAL AIRPORT, CA US&quot;             
## [7] &quot;SEATTLE TACOMA AIRPORT, WA US&quot;                          
## [8] &quot;DENVER INTERNATIONAL AIRPORT, CO US&quot;                    
## [9] &quot;MCCARRAN INTERNATIONAL AIRPORT, NV US&quot;</code></pre>
<pre class="r"><code># new city names
cities &lt;- c(&quot;CHICAGO&quot;, &quot;NEW YORK&quot;, &quot;MIAMI&quot;, 
            &quot;HOUSTON&quot;, &quot;ATLANTA&quot;, &quot;SAN FRANCISCO&quot;, 
            &quot;SEATTLE&quot;, &quot;DENVER&quot;, &quot;LAS VEGAS&quot;)</code></pre>
</div>
<div id="modify" class="section level2">
<h2>Modify</h2>
<p>In the first step, we will modify the original data, 1) selecting only the columns of interest, 2) filtering the period 1991-2020, 3) defining the new city names, 4) calculating the average temperature where it is absent, 5) cleaning the column names, and 6) creating a new variable with the days of the year. The <code>clean_names()</code> function of the <code>janitor</code> package is very useful for getting clean column names.</p>
<pre class="r"><code>meteo &lt;- select(meteo, NAME, DATE, TAVG:TMIN) %&gt;%  
           filter(DATE &gt;= &quot;1991-01-01&quot;, DATE &lt;= &quot;2020-12-31&quot;) %&gt;% 
            mutate(NAME = factor(NAME, stats_names, cities),
                   TAVG = ifelse(is.na(TAVG), (TMAX+TMIN)/2, TAVG),
                   yd = yday(DATE)) %&gt;% 
            clean_names()</code></pre>
<p>In the next step, we calculate the daily maximum, minimum and mean temperature for each day of the year. It now only remains to convert the days of the year into a dummy date. Here we use the year 2000 since it is a leap year, and we have a total of 366 days.</p>
<pre class="r"><code># estimate the daily averages
meteo_yday &lt;- group_by(meteo, name, yd) %&gt;% 
                  summarise(ta = mean(tavg, na.rm = TRUE),
                            tmx = mean(tmax, na.rm = TRUE),
                            tmin = mean(tmin, na.rm = TRUE))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;name&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>meteo_yday</code></pre>
<pre><code>## # A tibble: 3,294 x 5
## # Groups:   name [9]
##    name       yd    ta    tmx  tmin
##    &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 CHICAGO     1 -3.77  0.537 -7.86
##  2 CHICAGO     2 -2.64  1.03  -6.68
##  3 CHICAGO     3 -2.88  0.78  -6.93
##  4 CHICAGO     4 -2.86  0.753 -7.10
##  5 CHICAGO     5 -4.13 -0.137 -8.33
##  6 CHICAGO     6 -4.50 -1.15  -8.05
##  7 CHICAGO     7 -4.70 -0.493 -8.57
##  8 CHICAGO     8 -3.97  0.147 -8.02
##  9 CHICAGO     9 -3.47  0.547 -7.49
## 10 CHICAGO    10 -3.41  1.09  -7.64
## # ... with 3,284 more rows</code></pre>
<pre class="r"><code># convert the days of the year into a dummy date
meteo_yday &lt;- mutate(meteo_yday, yd = as_date(yd, origin = &quot;1999-12-31&quot;))</code></pre>
</div>
</div>
<div id="creating-the-climate-circles" class="section level1">
<h1>Creating the climate circles</h1>
<div id="predefinitions" class="section level2">
<h2>Predefinitions</h2>
<p>We define a divergent vector of various hues.</p>
<pre class="r"><code>col_temp &lt;- c(&quot;#cbebf6&quot;,&quot;#a7bfd9&quot;,&quot;#8c99bc&quot;,&quot;#974ea8&quot;,&quot;#830f74&quot;,
              &quot;#0b144f&quot;,&quot;#0e2680&quot;,&quot;#223b97&quot;,&quot;#1c499a&quot;,&quot;#2859a5&quot;,
              &quot;#1b6aa3&quot;,&quot;#1d9bc4&quot;,&quot;#1ca4bc&quot;,&quot;#64c6c7&quot;,&quot;#86cabb&quot;,
              &quot;#91e0a7&quot;,&quot;#c7eebf&quot;,&quot;#ebf8da&quot;,&quot;#f6fdd1&quot;,&quot;#fdeca7&quot;,
              &quot;#f8da77&quot;,&quot;#fcb34d&quot;,&quot;#fc8c44&quot;,&quot;#f85127&quot;,&quot;#f52f26&quot;,
              &quot;#d10b26&quot;,&quot;#9c042a&quot;,&quot;#760324&quot;,&quot;#18000c&quot;)</code></pre>
<p>We create a table with the x-axis grid lines.</p>
<pre class="r"><code>grid_x &lt;- tibble(x = seq(ymd(&quot;2000-01-01&quot;), ymd(&quot;2000-12-31&quot;), &quot;month&quot;), 
                 y = rep(-10, 12), 
                 xend = seq(ymd(&quot;2000-01-01&quot;), ymd(&quot;2000-12-31&quot;), &quot;month&quot;), 
                 yend = rep(41, 12))</code></pre>
<p>We define all the style elements of the graph in our own theme <code>theme_cc()</code>.</p>
<pre class="r"><code>theme_cc &lt;- function(){ 
  
 theme_minimal(base_family = &quot;Montserrat&quot;) %+replace%
  theme(plot.title = element_text(hjust = 0.5, colour = &quot;white&quot;, size = 30, margin = margin(b = 20)),
        plot.caption = element_text(colour = &quot;white&quot;, size = 9, hjust = .5, vjust = -30),
        plot.background = element_rect(fill = &quot;black&quot;),
        plot.margin = margin(1, 1, 2, 1, unit = &quot;cm&quot;),
  
        axis.text.x = element_text(face = &quot;italic&quot;, colour = &quot;white&quot;),
        axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        
        legend.title = element_text(colour = &quot;white&quot;),
        legend.position = &quot;bottom&quot;,
        legend.justification = 0.5,
        legend.text = element_text(colour = &quot;white&quot;),
       
        
        strip.text = element_text(colour = &quot;white&quot;, face = &quot;bold&quot;, size = 14),
        
        panel.spacing.y = unit(1, &quot;lines&quot;),
        panel.background = element_rect(fill = &quot;black&quot;),
        panel.grid = element_blank()
      ) 
}</code></pre>
</div>
<div id="graph" class="section level2">
<h2>Graph</h2>
<p>We start by building a chart for New York City only. We will use <code>geom_linerange()</code> to define line range with the daily maximum and minimum temperature. Also, we will draw the range line colour based on the mean temperature. Finally, we can adjust <em>alpha</em> and <em>size</em> to get a nicer look.</p>
<pre class="r"><code># filter New York
ny_city &lt;- filter(meteo_yday, name == &quot;NEW YORK&quot;) 

# graph
ggplot(ny_city) + 
  geom_linerange(aes(yd, 
                     ymax = tmx, 
                     ymin = tmin, 
                     colour = ta),
                 size=0.5, 
                 alpha = .7) + 
  scale_y_continuous(breaks = seq(-30, 50, 10), 
                     limits = c(-11, 42), 
                     expand = expansion()) +
  scale_colour_gradientn(colours = col_temp, 
                         limits = c(-12, 35), 
                         breaks = seq(-12, 34, 5)) + 
  scale_x_date(date_breaks = &quot;month&quot;,
               date_labels = &quot;%b&quot;) +
  labs(title = &quot;CLIMATE CIRCLES&quot;, 
       colour = &quot;Daily average temperature&quot;) </code></pre>
<p><img src="https://dominicroye.github.io/en/2021/climate-circles/index.en_files/figure-html/unnamed-chunk-10-1.png" width="2100" /></p>
<p>To get the polar graph it would only be necessary to add the <code>coord_polar()</code> function.</p>
<pre class="r"><code># polar chart
ggplot(ny_city) + 
  geom_linerange(aes(yd, 
                     ymax = tmx, 
                     ymin = tmin, 
                     colour = ta),
                 size=0.5, 
                 alpha = .7) + 
  scale_y_continuous(breaks = seq(-30, 50, 10), 
                     limits = c(-11, 42), 
                     expand = expansion()) +
  scale_colour_gradientn(colours = col_temp, 
                         limits = c(-12, 35), 
                         breaks = seq(-12, 34, 5)) + 
  scale_x_date(date_breaks = &quot;month&quot;,
               date_labels = &quot;%b&quot;) +
  coord_polar() +
  labs(title = &quot;CLIMATE CIRCLES&quot;, 
       colour = &quot;Daily average temperature&quot;) </code></pre>
<p><img src="https://dominicroye.github.io/en/2021/climate-circles/index.en_files/figure-html/unnamed-chunk-11-1.png" width="2100" /></p>
<p>In the final graph, we add the grid defining the lines on the y-axis with <code>geom_hline()</code> and those on the x-axis with <code>geom_segement()</code>. The most important thing here is the <code>facet_wrap()</code> function, which allows multiple facets of charts. The formula format is used to specify how the facets are created: <code>row ~ column</code>. If we do not have a second variable, a point <code>.</code> is indicated in the formula. In addition, we make changes to the appearance of the colour bar with <code>guides()</code> and <code>guide_colourbar()</code>, and we include the <code>theme_cc()</code> style.</p>
<pre class="r"><code>ggplot(meteo_yday) + 
  geom_hline(yintercept = c(-10, 0, 10, 20, 30, 40), 
             colour = &quot;white&quot;, 
             size = .4) +
  geom_segment(data = grid_x , 
               aes(x = x, 
                   y = y, 
                   xend = xend, 
                   yend = yend), 
               linetype = &quot;dashed&quot;, 
               colour = &quot;white&quot;, 
               size = .2) +
  geom_linerange(aes(yd, 
                     ymax = tmx, 
                     ymin = tmin, 
                     colour = ta),
                 size=0.5, 
                 alpha = .7) + 
  scale_y_continuous(breaks = seq(-30, 50, 10), 
                     limits = c(-11, 42), 
                     expand = expansion())+
  scale_colour_gradientn(colours = col_temp, 
                         limits = c(-12, 35), 
                         breaks = seq(-12, 34, 5)) + 
  scale_x_date(date_breaks = &quot;month&quot;, 
               date_labels = &quot;%b&quot;) +
  guides(colour = guide_colourbar(barwidth = 15,
                                  barheight = 0.5, 
                                  title.position = &quot;top&quot;)
         ) +
  facet_wrap(~name, nrow = 3) +
  coord_polar() + 
  labs(title = &quot;CLIMATE CIRCLES&quot;, 
       colour = &quot;Daily average temperature&quot;) +
  theme_cc()</code></pre>
<p><img src="https://dominicroye.github.io/en/2021/climate-circles/index.en_files/figure-html/unnamed-chunk-13-1.png" width="3540" /></p>
<p><a href="https://www.buymeacoffee.com/drxeo" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/default-orange.png" alt="Buy Me A Coffee" height="41" width="174"></a></p>
</div>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/en/tag/climate/">climate</a>
  
  <a class="badge badge-light" href="/en/tag/polar/">polar</a>
  
  <a class="badge badge-light" href="/en/tag/temperatures/">temperatures</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://dominicroye.github.io/en/2021/climate-circles/&amp;text=Climate%20circles" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://dominicroye.github.io/en/2021/climate-circles/&amp;t=Climate%20circles" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Climate%20circles&amp;body=https://dominicroye.github.io/en/2021/climate-circles/" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://dominicroye.github.io/en/2021/climate-circles/&amp;title=Climate%20circles" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Climate%20circles%20https://dominicroye.github.io/en/2021/climate-circles/" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://dominicroye.github.io/en/2021/climate-circles/&amp;title=Climate%20circles" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://dominicroye.github.io/"><img class="avatar mr-3 avatar-circle" src="/en/author/dr.-dominic-roye/avatar_hu930bec32484cd86675af8880de95caa2_508993_270x270_fill_q75_lanczos_center.jpg" alt="Dr. Dominic Royé"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://dominicroye.github.io/">Dr. Dominic Royé</a></h5>
      <h6 class="card-subtitle">Senior postdoctoral researcher</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/dr_xeo" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/en/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.es/citations?user=EoYa8jUAAAAJ&amp;hl=es" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/dominicroye" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/dominicroye/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Dominic_Roye" target="_blank" rel="noopener">
        <i class="ai ai-researchgate"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/en/2020/a-heatmap-as-calendar/">A heatmap as calendar</a></li>
      
      <li><a href="/en/2020/visualize-climate-anomalies/">Visualize climate anomalies</a></li>
      
      <li><a href="/en/2019/visualize-monthly-precipitation-anomalies/">Visualize monthly precipitation anomalies</a></li>
      
      <li><a href="/en/2019/visualize-urban-growth/">Visualize urban growth</a></li>
      
      <li><a href="/en/2018/accessing-openstreetmap-data-with-r/">Accessing OpenStreetMap data with R</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  
  <p class="powered-by">
    © 2018-2023 Dominic Royé. All rights reserved
  </p>
  

  
  






  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    <script src="/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js"></script>

    
    
    
      
      
        <script src="https://cdn.jsdelivr.net/gh/desandro/imagesloaded@v4.1.4/imagesloaded.pkgd.min.js" integrity="sha512-S5PZ9GxJZO16tT9r3WJp/Safn31eu8uWrzglMahDT4dsmgqWonRY9grk3j+3tfuPr9WJNsfooOR7Gi7HL5W2jw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/metafizzy/isotope@v3.0.6/dist/isotope.pkgd.min.js" integrity="sha512-Zq2BOxyhvnRFXu0+WE6ojpZLOU2jdnqbrM1hmVdGzyeCa1DgM3X5Q4A/Is9xA1IkbUeDd7755dNNI/PzSf2Pew==" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    <script src="/en/js/wowchemy.min.50d3bf3df0c53b31631bb48a62b35f92.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
