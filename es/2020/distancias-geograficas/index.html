<!DOCTYPE html><html lang="es-ES" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  
  









  




  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Dr. Dominic Royé" />

  
  
  
    
  
  <meta name="description" content="El primer post del año 2020, lo dedicaré a una consulta que me hicieron recientemente. Me plantearon la pregunta de cómo se podría calcular la distancia más corta entre diferentes puntos y cómo saber cúal es el punto más próximo a uno dado. Cuando trabajamos con datos espaciales en R, en la actualidad lo más fácil es usar el paquete ``sf`` en combinación con la colección de paquetes ``tidyverse``. Además usamos el paquete ``units`` que es muy útil para trabajar con unidades de medida." />

  
  <link rel="alternate" hreflang="es-ES" href="https://dominicroye.github.io/es/2020/distancias-geograficas/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.b48d89910a3f8560bb2d78fedea8d682.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-27463794-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-27463794-2', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/es/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu27cb63416a395b8c8d0d7112b85e26a9_17299_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu27cb63416a395b8c8d0d7112b85e26a9_17299_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://dominicroye.github.io/es/2020/distancias-geograficas/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@@dr_xeo" />
    <meta property="twitter:creator" content="@@dr_xeo" />
  
  <meta property="og:site_name" content="Dr. Dominic Royé" />
  <meta property="og:url" content="https://dominicroye.github.io/es/2020/distancias-geograficas/" />
  <meta property="og:title" content="Distancias geográficas | Dr. Dominic Royé" />
  <meta property="og:description" content="El primer post del año 2020, lo dedicaré a una consulta que me hicieron recientemente. Me plantearon la pregunta de cómo se podría calcular la distancia más corta entre diferentes puntos y cómo saber cúal es el punto más próximo a uno dado. Cuando trabajamos con datos espaciales en R, en la actualidad lo más fácil es usar el paquete ``sf`` en combinación con la colección de paquetes ``tidyverse``. Además usamos el paquete ``units`` que es muy útil para trabajar con unidades de medida." /><meta property="og:image" content="https://dominicroye.github.io/es/2020/distancias-geograficas/featured.png" />
    <meta property="twitter:image" content="https://dominicroye.github.io/es/2020/distancias-geograficas/featured.png" /><meta property="og:locale" content="es-ES" />
  
    
      <meta
        property="article:published_time"
        content="2020-01-19T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2020-01-19T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://dominicroye.github.io/es/2020/distancias-geograficas/"
  },
  "headline": "Distancias geográficas",
  
  "image": [
    "https://dominicroye.github.io/es/2020/distancias-geograficas/featured.png"
  ],
  
  "datePublished": "2020-01-19T00:00:00Z",
  "dateModified": "2020-01-19T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Dr. Dominic Royé"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "University of Santiago de Compostela",
    "logo": {
      "@type": "ImageObject",
      "url": "https://dominicroye.github.io/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_192x192_fit_lanczos_3.png"
    }
  },
  "description": "El primer post del año 2020, lo dedicaré a una consulta que me hicieron recientemente. Me plantearon la pregunta de cómo se podría calcular la distancia más corta entre diferentes puntos y cómo saber cúal es el punto más próximo a uno dado. Cuando trabajamos con datos espaciales en R, en la actualidad lo más fácil es usar el paquete ``sf`` en combinación con la colección de paquetes ``tidyverse``. Además usamos el paquete ``units`` que es muy útil para trabajar con unidades de medida."
}
</script>

  

  

  

  





  <title>Distancias geográficas | Dr. Dominic Royé</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="a44ced12e2fc0e7bb986f86b611ad4bb" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.2da3b1fa37e894630bf6de39b1b694b3.js"></script>

  




  <div class="page-header">
    







 



  


<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/es/"><img src="/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_0x70_resize_lanczos_3.png" alt="Dr. Dominic Royé"
            
            >
             <div style = "padding-top:0.5em;">Dr. Dominic Royé</div></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Barra de navegación">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/es/"><img src="/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_0x70_resize_lanczos_3.png" alt="Dr. Dominic Royé"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          

          

          
          
          
          

          
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#"><span>inicio</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#posts"><span>blog</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#featured"><span>publicaciones</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#projects"><span>gráficos</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#about"><span>mí</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/dr_xeo" data-toggle="tooltip" data-placement="bottom" title="Sígueme en Twitter" target="_blank" rel="noopener" aria-label="Sígueme en Twitter">
                <i class="fab fa-twitter" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        

        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Distancias geográficas</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    2020-01-19
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min de lectura
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/es/category/analisis-espacial/">análisis espacial</a>, <a href="/es/category/r/">R</a>, <a href="/es/category/rprincipante/">R:principante</a>, <a href="/es/category/gis/">gis</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 331px;">
  <div style="position: relative">
    <img src="/es/2020/distancias-geograficas/featured_hud1995487cc7dc66e7087a613d2328724_77006_720x0_resize_lanczos_3.png" width="720" height="331" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="https://dominicroye.github.io/es/2020/distancias-geograficas/index.es_files/header-attrs/header-attrs.js"></script>


<p>El primer post del año 2020, lo dedicaré a una consulta que me hicieron recientemente. Me plantearon la pregunta de cómo se podría calcular la distancia más corta entre diferentes puntos y cómo saber cúal es el punto más próximo a uno dado. Cuando trabajamos con datos espaciales en R, en la actualidad lo más fácil es usar el paquete <code>sf</code> en combinación con la colección de paquetes <code>tidyverse</code>. Además usamos el paquete <code>units</code> que es muy útil para trabajar con unidades de medida.</p>
<div id="paquetes" class="section level2">
<h2>Paquetes</h2>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Paquete</th>
<th align="left">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tidyverse</td>
<td align="left">Conjunto de paquetes (visualización y manipulación de datos): ggplot2, dplyr, purrr,etc.</td>
</tr>
<tr class="even">
<td align="left">sf</td>
<td align="left">Simple Feature: importar, exportar y manipular datos vectoriales</td>
</tr>
<tr class="odd">
<td align="left">units</td>
<td align="left">Proporciona unidades de medida para vectores R: conversión, derivación, simplificación</td>
</tr>
<tr class="even">
<td align="left">maps</td>
<td align="left">Mapas geográficos y conjuntos de datos</td>
</tr>
<tr class="odd">
<td align="left">rnaturalearth</td>
<td align="left">Mapas vectoriales del mundo ‘Natural Earth’</td>
</tr>
</tbody>
</table>
<pre class="r"><code># instalamos los paquetes necesarios
if(!require(&quot;tidyverse&quot;)) install.packages(&quot;tidyverse&quot;)
if(!require(&quot;units&quot;)) install.packages(&quot;units&quot;)
if(!require(&quot;sf&quot;)) install.packages(&quot;sf&quot;)
if(!require(&quot;maps&quot;)) install.packages(&quot;maps&quot;)
if(!require(&quot;rnaturalearth&quot;)) install.packages(&quot;rnaturalearth&quot;)

# cargamos los paquetes
library(maps)
library(sf) 
library(tidyverse)
library(units)
library(rnaturalearth)</code></pre>
</div>
<div id="unidades-de-medida" class="section level2">
<h2>Unidades de medida</h2>
<p>El uso de vectores y matrices de clase <code>units</code> nos permite calcular y transformar unidades de medida.</p>
<pre class="r"><code># longitud
l &lt;- set_units(1:10, m)
l</code></pre>
<pre><code>## Units: [m]
##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<pre class="r"><code># convertir a otras unidades
set_units(l, cm)</code></pre>
<pre><code>## Units: [cm]
##  [1]  100  200  300  400  500  600  700  800  900 1000</code></pre>
<pre class="r"><code># sumar diferentes unidades
set_units(l, cm) + l</code></pre>
<pre><code>## Units: [cm]
##  [1]  200  400  600  800 1000 1200 1400 1600 1800 2000</code></pre>
<pre class="r"><code># area
a &lt;- set_units(355, ha)
set_units(a, km2)</code></pre>
<pre><code>## 3.55 [km2]</code></pre>
<pre class="r"><code># velocidad
vel &lt;- set_units(seq(20, 50, 10), km/h)
set_units(vel, m/s)</code></pre>
<pre><code>## Units: [m/s]
## [1]  5.555556  8.333333 11.111111 13.888889</code></pre>
</div>
<div id="capitales-del-mundo" class="section level2">
<h2>Capitales del mundo</h2>
<p>Vamos a usar las capitales de todo el mundo con el objetivo de calcular la distancia a la capital más próxima y indicar el nombre de la ciudad.</p>
<pre class="r"><code># conjunto de ciudades del mundo con coordenadas
head(world.cities) # proviene del paquete maps</code></pre>
<pre><code>##                 name country.etc   pop   lat  long capital
## 1 &#39;Abasan al-Jadidah   Palestine  5629 31.31 34.34       0
## 2 &#39;Abasan al-Kabirah   Palestine 18999 31.32 34.35       0
## 3       &#39;Abdul Hakim    Pakistan 47788 30.55 72.11       0
## 4 &#39;Abdullah-as-Salam      Kuwait 21817 29.36 47.98       0
## 5              &#39;Abud   Palestine  2456 32.03 35.07       0
## 6            &#39;Abwein   Palestine  3434 32.03 35.20       0</code></pre>
<p>Para convertir puntos con longitud y latitud en un objeto espacial de clase <code>sf</code>, empleamos la función <code>st_as_sf()</code>, indicando las columnas de las coordenadas y el sistema de referencia de coordenadas (WSG84, epsg:4326).</p>
<pre class="r"><code># convertimos los puntos en un objeto sf con CRS WSG84
cities &lt;- st_as_sf(world.cities, coords = c(&quot;long&quot;, &quot;lat&quot;), crs = 4326)
cities</code></pre>
<pre><code>## Simple feature collection with 43645 features and 4 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -178.8 ymin: -54.79 xmax: 179.81 ymax: 78.93
## Geodetic CRS:  WGS 84
## First 10 features:
##                  name  country.etc   pop capital            geometry
## 1  &#39;Abasan al-Jadidah    Palestine  5629       0 POINT (34.34 31.31)
## 2  &#39;Abasan al-Kabirah    Palestine 18999       0 POINT (34.35 31.32)
## 3        &#39;Abdul Hakim     Pakistan 47788       0 POINT (72.11 30.55)
## 4  &#39;Abdullah-as-Salam       Kuwait 21817       0 POINT (47.98 29.36)
## 5               &#39;Abud    Palestine  2456       0 POINT (35.07 32.03)
## 6             &#39;Abwein    Palestine  3434       0  POINT (35.2 32.03)
## 7            &#39;Adadlay      Somalia  9198       0  POINT (44.65 9.77)
## 8              &#39;Adale      Somalia  5492       0   POINT (46.3 2.75)
## 9               &#39;Afak         Iraq 22706       0 POINT (45.26 32.07)
## 10              &#39;Afif Saudi Arabia 41731       0 POINT (42.93 23.92)</code></pre>
<p>En el próximo paso, simplemente filtramos por las capitales codificadas en la columna <code>capital</code> con 1. La ventaja del paquete <code>sf</code> es la posibilidad de aplicar funciones de la colección <code>tidyverse</code> para manipular los atributos. Además, añadimos una columna con nuevas etiquetas usando la función <code>str_c()</code> del paquete <code>stringr</code>, la cúal es similar a la de <em>R Base</em> <code>paste()</code>.</p>
<pre class="r"><code># filtramos por las capitales
capitals &lt;- filter(cities, capital == 1)

# creamos una nueva etiqueta combinando nombre y país
capitals &lt;- mutate(capitals, city_country = str_c(name, &quot; (&quot;, country.etc, &quot;)&quot;))

capitals </code></pre>
<pre><code>## Simple feature collection with 230 features and 5 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -176.13 ymin: -51.7 xmax: 179.2 ymax: 78.21
## Geodetic CRS:  WGS 84
## First 10 features:
##           name          country.etc     pop capital               geometry
## 1       &#39;Amman               Jordan 1303197       1    POINT (35.93 31.95)
## 2    Abu Dhabi United Arab Emirates  619316       1    POINT (54.37 24.48)
## 3        Abuja              Nigeria  178462       1      POINT (7.17 9.18)
## 4        Accra                Ghana 2029143       1      POINT (-0.2 5.56)
## 5    Adamstown             Pitcairn      51       1  POINT (-130.1 -25.05)
## 6  Addis Abeba             Ethiopia 2823167       1     POINT (38.74 9.03)
## 7        Agana                 Guam    1041       1   POINT (144.75 13.47)
## 8      Algiers              Algeria 2029936       1     POINT (3.04 36.77)
## 9        Alofi                 Niue     627       1 POINT (-169.92 -19.05)
## 10   Amsterdam          Netherlands  744159       1     POINT (4.89 52.37)
##                        city_country
## 1                   &#39;Amman (Jordan)
## 2  Abu Dhabi (United Arab Emirates)
## 3                   Abuja (Nigeria)
## 4                     Accra (Ghana)
## 5              Adamstown (Pitcairn)
## 6            Addis Abeba (Ethiopia)
## 7                      Agana (Guam)
## 8                 Algiers (Algeria)
## 9                      Alofi (Niue)
## 10          Amsterdam (Netherlands)</code></pre>
</div>
<div id="calcular-distancias" class="section level2">
<h2>Calcular distancias</h2>
<p>La distancia geográfica (euclidiana o de gran círculo) se calcula con la función <code>st_distance()</code>, o bien entre dos puntos, entre un punto y otros múltiples o entre todos. En el último caso obtenemos una matriz simétrica de distancias (NxN), tomados por pares de un conjunto. En la diagonal encontramos las combinaciones entre los mismos puntos dando todas nulas.</p>
<table>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">A</td>
<td align="left">B</td>
<td align="left">C</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">0</td>
<td align="left">310</td>
<td align="left">323</td>
</tr>
<tr class="odd">
<td align="left">B</td>
<td align="left">310</td>
<td align="left">0</td>
<td align="left">133</td>
</tr>
<tr class="even">
<td align="left">C</td>
<td align="left">323</td>
<td align="left">133</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>Cuando queremos saber, por ejemplo, la distancia de Amsterdam a Abu Dhabi, Washington y Tokyo pasamos dos objetos espaciales.</p>
<pre class="r"><code># calcular la distancia
dist_amsterdam &lt;- st_distance(slice(capitals, 10), 
                              slice(capitals, c(2, 220, 205)))

dist_amsterdam # distancia en metros</code></pre>
<pre><code>## Units: [m]
##         [,1]    [,2]    [,3]
## [1,] 5163124 6187634 9293710</code></pre>
<p>El resultado es una matriz de una fila o de una columna (en función del orden de los objetos) con clase de <code>units</code>. Así es posible cambiar fácilmente a otra unidad de medida. Si queremos obtener un vector sin clase <code>units</code>, únicamente aplicamos la función <code>as.vector()</code>.</p>
<pre class="r"><code># cambiamos de m a km
set_units(dist_amsterdam, &quot;km&quot;)</code></pre>
<pre><code>## Units: [km]
##          [,1]     [,2]    [,3]
## [1,] 5163.124 6187.634 9293.71</code></pre>
<pre class="r"><code># units class a vector
as.vector(dist_amsterdam)</code></pre>
<pre><code>## [1] 5163124 6187634 9293710</code></pre>
<p>A continuación estimamos la matriz de distancia entre todas las capitales. Es importante convertir los valores nulos a <code>NA</code> para obtener posteriormente el índice correcto de la matriz.</p>
<pre class="r"><code># calcular la distancia
m_distance &lt;- st_distance(capitals)

# matriz
dim(m_distance)</code></pre>
<pre><code>## [1] 230 230</code></pre>
<pre class="r"><code># cambiamos de m a km
m_distance_km &lt;- set_units(m_distance, km)

# reemplazamos la distance de 0 con NA
m_distance_km[m_distance_km == set_units(0, km)] &lt;- NA</code></pre>
<p><div class="alert alert-note">
  <div>
    Cuando el resultado es de clase <code>units</code> es necesario usar la misma clase para poder hacer consultas logicas. Por ejemplo, <code>set_units(1, m) == set_units(1, m)</code> vs. <code>set_units(1, m) == 1</code>.
  </div>
</div>
</p>
<p>Con el objetivo de obtener la distancia más corta, además de la posición de la misma, usamos la función <code>apply()</code> que a su vez nos permite aplicar la función <code>which.min()</code> y <code>min()</code> sobre cada fila. También sería posible emplear la función sobre columnas que daría el mismo resulado. Para finalizar, añadimos los resultados como nuevas columnas con la función <code>mutate()</code>. Las posiciones en <em>pos</em> nos permiten obtener los nombres de las ciudades más próximas.</p>
<pre class="r"><code># obtenemos la posición de la ciudad y la distancia
pos &lt;- apply(m_distance_km, 1, which.min)
dist &lt;- apply(m_distance_km, 1, min, na.rm = TRUE)

# añadimos la distancia y obtenemos el nombre de la ciudad
capitals &lt;- mutate(capitals, nearest_city =  city_country[pos], 
                             geometry_nearest = geometry[pos],
                             distance_city = dist)</code></pre>
</div>
<div id="mapa-de-distancias-a-la-próxima-capital" class="section level2">
<h2>Mapa de distancias a la próxima capital</h2>
<p>Por último, construimos un mapa representando la distancia en circulos proporcionales. Para ello, usamos la gramática habitual de <code>ggplot()</code> añadiendo la geometría <code>geom_sf()</code>, primero para el mapamundi de fondo y después para los circulos de las ciudades. En <code>aes()</code> indicamos con el argumento <code>size = distance_city</code> la variable que debe ser mapeado proporcionalmente. La función <code>theme_void()</code> elimina todos los elementos de estilo. Además, definimos con la función <code>coord_sf()</code> una nueva proyección indicando el formato <em>proj4</em>.</p>
<pre class="r"><code># mapamundi
world &lt;- ne_countries(scale = 10, returnclass = &quot;sf&quot;)

# mapa 
ggplot(world) +
   geom_sf(fill = &quot;black&quot;, colour = &quot;white&quot;) +
   geom_sf(data = capitals, 
           aes(size = distance_city),
           alpha = 0.7,
           fill = &quot;#bd0026&quot;,
           shape = 21,
           show.legend = &#39;point&#39;) +
   coord_sf(crs = &quot;+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;) +
  labs(size = &quot;Distance (km)&quot;, title = &quot;Distance to the next capital&quot;) +
  theme_void()</code></pre>
<p><img src="https://dominicroye.github.io/es/2020/distancias-geograficas/index.es_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><a href="https://www.buymeacoffee.com/drxeo" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/default-orange.png" alt="Buy Me A Coffee" height="41" width="174"></a></p>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/es/tag/distancia/">distancia</a>
  
  <a class="badge badge-light" href="/es/tag/puntos/">puntos</a>
  
  <a class="badge badge-light" href="/es/tag/ciudades/">ciudades</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://dominicroye.github.io/es/2020/distancias-geograficas/&amp;text=Distancias%20geogr%c3%a1ficas" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://dominicroye.github.io/es/2020/distancias-geograficas/&amp;t=Distancias%20geogr%c3%a1ficas" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Distancias%20geogr%c3%a1ficas&amp;body=https://dominicroye.github.io/es/2020/distancias-geograficas/" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://dominicroye.github.io/es/2020/distancias-geograficas/&amp;title=Distancias%20geogr%c3%a1ficas" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Distancias%20geogr%c3%a1ficas%20https://dominicroye.github.io/es/2020/distancias-geograficas/" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://dominicroye.github.io/es/2020/distancias-geograficas/&amp;title=Distancias%20geogr%c3%a1ficas" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://dominicroye.github.io/"><img class="avatar mr-3 avatar-circle" src="/es/author/dr.-dominic-roye/avatar_hu930bec32484cd86675af8880de95caa2_508993_270x270_fill_q75_lanczos_center.jpg" alt="Dr. Dominic Royé"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://dominicroye.github.io/">Dr. Dominic Royé</a></h5>
      <h6 class="card-subtitle">Investigador postdoctoral senior</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/dr_xeo" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/es/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.es/citations?user=EoYa8jUAAAAJ&amp;hl=es" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/dominicroye" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/dominicroye/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Dominic_Roye" target="_blank" rel="noopener">
        <i class="ai ai-researchgate"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Relacionado</h3>
    <ul>
      
      <li><a href="/es/2019/visualizar-el-crecimiento-urbano/">Visualizar el crecimiento urbano</a></li>
      
      <li><a href="/es/2020/visualizar-anomalias-climaticas/">Visualizar anomalías climáticas</a></li>
      
      <li><a href="/es/2019/calcular-la-distancia-al-mar-en-r/">Calcular la distancia al mar en R</a></li>
      
      <li><a href="/es/2021/circulos-climaticos/">Círculos climáticos</a></li>
      
      <li><a href="/es/2020/una-muy-breve-introduccion-a-tidyverse/">Una muy breve introducción a Tidyverse</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  
  <p class="powered-by">
    © 2018-2023 Dominic Royé. All rights reserved
  </p>
  

  
  






  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Citar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copiar
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Descargar
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    <script src="/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js"></script>

    
    
    
      
      
        <script src="https://cdn.jsdelivr.net/gh/desandro/imagesloaded@v4.1.4/imagesloaded.pkgd.min.js" integrity="sha512-S5PZ9GxJZO16tT9r3WJp/Safn31eu8uWrzglMahDT4dsmgqWonRY9grk3j+3tfuPr9WJNsfooOR7Gi7HL5W2jw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/metafizzy/isotope@v3.0.6/dist/isotope.pkgd.min.js" integrity="sha512-Zq2BOxyhvnRFXu0+WE6ojpZLOU2jdnqbrM1hmVdGzyeCa1DgM3X5Q4A/Is9xA1IkbUeDd7755dNNI/PzSf2Pew==" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    <script src="/es/js/wowchemy.min.50d3bf3df0c53b31631bb48a62b35f92.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
