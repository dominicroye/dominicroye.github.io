<!DOCTYPE html><html lang="es-ES" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  
  









  




  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Dr. Dominic Royé" />

  
  
  
    
  
  <meta name="description" content="Cuando visualizamos anomalías de precipitación y temperatura, simplemente usamos series temporales en un gráfico de barras indicando con color rojo y azul valores negativos y positivos. No obstante, para tener una imagen global necesitamos ambas anomalías en un único gráfico. Así podríamos responder directamente a la pregunta de si una estación del año o un mes en concreto fue seco-cálido o húmedo-frío, e incluso comparar estas anomalías en el contexto de años anteriores." />

  
  <link rel="alternate" hreflang="es-ES" href="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.b48d89910a3f8560bb2d78fedea8d682.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-27463794-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-27463794-2', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/es/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu27cb63416a395b8c8d0d7112b85e26a9_17299_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu27cb63416a395b8c8d0d7112b85e26a9_17299_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@@dr_xeo" />
    <meta property="twitter:creator" content="@@dr_xeo" />
  
  <meta property="og:site_name" content="Dr. Dominic Royé" />
  <meta property="og:url" content="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/" />
  <meta property="og:title" content="Visualizar anomalías climáticas | Dr. Dominic Royé" />
  <meta property="og:description" content="Cuando visualizamos anomalías de precipitación y temperatura, simplemente usamos series temporales en un gráfico de barras indicando con color rojo y azul valores negativos y positivos. No obstante, para tener una imagen global necesitamos ambas anomalías en un único gráfico. Así podríamos responder directamente a la pregunta de si una estación del año o un mes en concreto fue seco-cálido o húmedo-frío, e incluso comparar estas anomalías en el contexto de años anteriores." /><meta property="og:image" content="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/featured.png" />
    <meta property="twitter:image" content="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/featured.png" /><meta property="og:locale" content="es-ES" />
  
    
      <meta
        property="article:published_time"
        content="2020-03-29T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2020-03-29T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/"
  },
  "headline": "Visualizar anomalías climáticas",
  
  "image": [
    "https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/featured.png"
  ],
  
  "datePublished": "2020-03-29T00:00:00Z",
  "dateModified": "2020-03-29T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Dr. Dominic Royé"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "University of Santiago de Compostela",
    "logo": {
      "@type": "ImageObject",
      "url": "https://dominicroye.github.io/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_192x192_fit_lanczos_3.png"
    }
  },
  "description": "Cuando visualizamos anomalías de precipitación y temperatura, simplemente usamos series temporales en un gráfico de barras indicando con color rojo y azul valores negativos y positivos. No obstante, para tener una imagen global necesitamos ambas anomalías en un único gráfico. Así podríamos responder directamente a la pregunta de si una estación del año o un mes en concreto fue seco-cálido o húmedo-frío, e incluso comparar estas anomalías en el contexto de años anteriores."
}
</script>

  

  

  

  





  <title>Visualizar anomalías climáticas | Dr. Dominic Royé</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="d06c7cd6ab9f372fccae68c86f97adcc" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.2da3b1fa37e894630bf6de39b1b694b3.js"></script>

  




  <div class="page-header">
    







 



  


<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/es/"><img src="/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_0x70_resize_lanczos_3.png" alt="Dr. Dominic Royé"
            
            >
             <div style = "padding-top:0.5em;">Dr. Dominic Royé</div></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Barra de navegación">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/es/"><img src="/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_0x70_resize_lanczos_3.png" alt="Dr. Dominic Royé"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          

          

          
          
          
          

          
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#"><span>inicio</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#posts"><span>blog</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#featured"><span>publicaciones</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#projects"><span>gráficos</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#about"><span>mí</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/dr_xeo" data-toggle="tooltip" data-placement="bottom" title="Sígueme en Twitter" target="_blank" rel="noopener" aria-label="Sígueme en Twitter">
                <i class="fab fa-twitter" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        

        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Visualizar anomalías climáticas</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    2020-03-29
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min de lectura
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/es/category/visualizacion/">visualización</a>, <a href="/es/category/r/">R</a>, <a href="/es/category/rintermedio/">R:intermedio</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 449px;">
  <div style="position: relative">
    <img src="/es/2020/visualizar-anomalias-climaticas/featured_huf7b21bd40a1e3664179a4f6e2f7f8106_137900_720x0_resize_lanczos_3.png" width="720" height="449" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/index.es_files/header-attrs/header-attrs.js"></script>


<p>Cuando visualizamos anomalías de precipitación y temperatura, simplemente usamos series temporales en un gráfico de barras indicando con color rojo y azul valores negativos y positivos. No obstante, para tener una imagen global necesitamos ambas anomalías en un único gráfico. Así podríamos responder directamente a la pregunta de si una estación del año o un mes en concreto fue seco-cálido o húmedo-frío, e incluso comparar estas anomalías en el contexto de años anteriores.</p>
<div id="paquetes" class="section level2">
<h2>Paquetes</h2>
<p>En este post usaremos los siguientes paquetes:</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Paquete</th>
<th align="left">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tidyverse</td>
<td align="left">Conjunto de paquetes (visualización y manipulación de datos): ggplot2, dplyr, purrr,etc.</td>
</tr>
<tr class="even">
<td align="left">lubridate</td>
<td align="left">Fácil manipulación de fechas y tiempos</td>
</tr>
<tr class="odd">
<td align="left">ggrepel</td>
<td align="left">Etiquetas sin superposición con ggplot2</td>
</tr>
</tbody>
</table>
<pre class="r"><code>#instalamos los paquetes si hace falta
if(!require(&quot;tidyverse&quot;)) install.packages(&quot;tidyverse&quot;)
if(!require(&quot;ggrepel&quot;)) install.packages(&quot;ggrepel&quot;)
if(!require(&quot;lubridate&quot;)) install.packages(&quot;lubridate&quot;)

#paquetes
library(tidyverse)
library(lubridate)
library(ggrepel)</code></pre>
</div>
<div id="preparar-los-datos" class="section level2">
<h2>Preparar los datos</h2>
<p>Primero importamos la precipitación y temperatura diaria de la estación meteorológica seleccionada (<a href="/files/meteo_tenerife.csv">descarga</a>). Usaremos los datos de Tenerife Sur (España) [1981-2020] accesible a través de <a href="https://opendata.aemet.es/">Open Data AEMET</a>. En R existe un paquete <a href="https://vegmod.ctfc.cat/software/meteoland/"><code>meteoland</code></a> que facilita la descarga con funciones específicas para acceder a los datos de AEMET, Meteogalicia y Meteocat.</p>
<div id="paso-1-importar-los-datos" class="section level3">
<h3>Paso 1: importar los datos</h3>
<p>Importamos los datos en formato <em>csv</em>, siendo la primera columna la fecha, la segunda la precipitación (pr) y la última la temperatura media diaria (ta).</p>
<pre class="r"><code>data &lt;- read_csv(&quot;meteo_tenerife.csv&quot;) </code></pre>
<pre><code>## Rows: 14303 Columns: 3
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl  (2): pr, ta
## date (1): date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>data</code></pre>
<pre><code>## # A tibble: 14,303 x 3
##    date          pr    ta
##    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 1981-01-02   0    17.6
##  2 1981-01-03   0    16.8
##  3 1981-01-04   0    17.4
##  4 1981-01-05   0    17.6
##  5 1981-01-06   0    17  
##  6 1981-01-07   0    17.6
##  7 1981-01-08   0    18.6
##  8 1981-01-09   0    19.8
##  9 1981-01-10   0    21.5
## 10 1981-01-11   3.8  17.6
## # ... with 14,293 more rows</code></pre>
</div>
<div id="paso-2-preparar-los-datos" class="section level3">
<h3>Paso 2: preparar los datos</h3>
<p>En el segundo paso preparamos los datos para calcular las anomalías. Para ello, creamos tres nuevas columnas: el mes, el año y la estación del año. Como nuestro objetivo son las anomalías invernales no podemos usar el año natural, ya que el invierno comprende el mes de diciembre de un año y los meses de enero y febrero del siguiente. La función personalizada <code>meteo_yr()</code> extrae el año de una fecha indicando el mes inicial. El concepto es similar al año hidrológico en el que se empieza en octubre.</p>
<pre class="r"><code>meteo_yr &lt;- function(dates, start_month = NULL) {
  # convertir a POSIXlt
  dates.posix &lt;- as.POSIXlt(dates)
  # la compensación
  offset &lt;- ifelse(dates.posix$mon &gt;= start_month - 1, 1, 0)
  # nuevo año
  adj.year = dates.posix$year + 1900 + offset
  return(adj.year)
}</code></pre>
<p>Usaremos las funciones de la colección de paquetes <code>tidyverse</code> (<a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>). La función <code>mutate()</code> ayuda a añadir nuevas columnas o a cambiar otras existentes. Para definir las estaciones del año, empleamos la función <code>case_when()</code> del paquete <code>dplyr</code> lo que tiene muchas ventajas en comparación con una cadena de <code>ifelse()</code>. En la función <code>case_when()</code> usamos fórmulas en dos tiempos, por un lado la condición y por otro la acción cuando se cumpla esa condición. En R una fórmula de dos tiempos o dos lados se consistuye con el operador <code>~</code>. El operador binario <code>%in%</code> nos permite filtrar varios valores en un conjunto.</p>
<pre class="r"><code>data &lt;- mutate(data, 
               winter_yr = meteo_yr(date, 12),
               month = month(date), 
               season = case_when(month %in% c(12,1:2) ~ &quot;Winter&quot;,
                                  month %in% 3:5 ~ &quot;Spring&quot;,
                                  month %in% 6:8 ~ &quot;Summer&quot;,
                                  month %in% 9:11 ~ &quot;Autum&quot;))

data</code></pre>
<pre><code>## # A tibble: 14,303 x 6
##    date          pr    ta winter_yr month season
##    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; 
##  1 1981-01-02   0    17.6      1981     1 Winter
##  2 1981-01-03   0    16.8      1981     1 Winter
##  3 1981-01-04   0    17.4      1981     1 Winter
##  4 1981-01-05   0    17.6      1981     1 Winter
##  5 1981-01-06   0    17        1981     1 Winter
##  6 1981-01-07   0    17.6      1981     1 Winter
##  7 1981-01-08   0    18.6      1981     1 Winter
##  8 1981-01-09   0    19.8      1981     1 Winter
##  9 1981-01-10   0    21.5      1981     1 Winter
## 10 1981-01-11   3.8  17.6      1981     1 Winter
## # ... with 14,293 more rows</code></pre>
</div>
<div id="paso-3-estimar-las-anomalías-invernales" class="section level3">
<h3>Paso 3: estimar las anomalías invernales</h3>
<p>En el siguiente paso creamos un subset del invierno. Después agrupamos por el año meteorológico y calculamos la suma y el promedio para la precipitación y la temperatura, respectivamente. Para facilitar el trabajo el paquete <code>magrittr</code> introduce el operador llamado <em>pipe</em> en la forma <code>%&gt;%</code> con el objetivo de combinar varias funciones sin la necesidad de asignar el resultado a un nuevo objeto. El operador <em>pipe</em> pasa la salida de una función aplicada al primer argumento de la siguiente función. Esta forma de combinar funciones permite encadenar varios pasos de forma simultánea. Se debe entender y pronunciar el <code>%&gt;%</code> como <em>“luego”</em> (<em>then</em>).</p>
<pre class="r"><code>data_inv &lt;- filter(data, 
                   season == &quot;Winter&quot;) %&gt;% 
              group_by(winter_yr) %&gt;%
                  summarise(pr = sum(pr, na.rm = TRUE),
                            ta = mean(ta, na.rm = TRUE))</code></pre>
<p>Sólo nos quedan por calcular las anomalías de precipitación y temperatura. Las columnas <code>pr_mean</code> y <code>ta_mean</code> contendrán el promedio climatico, la referencia de las anomalías respecto al periodo normal 1981-2010. Por eso debemos filtrar los valores al periodo antes de 2010, lo que haremos de la forma habitual de filtrado de vectores en R. Una vez que tenemos las referencias estimamos las anomalías <code>pr_anom</code> y <code>ta_anom</code>. Para facilitar la interpretación, en el caso de la precipitación lo expresamos en porcentaje, pero poniendo el promedio en 0% en lugar del 100%.</p>
<p>Además, añadimmos tres columnas con información necesaria en la creación del gráfico. 1) <code>labyr</code> contiene el año de cada anomalía siempre y cuando haya sido mayor/menor del -+10% o -+0,5ºC, respectivamente (lo hago para que no haya demasiadas etiquetas), 2) <code>symb_point</code> una variable dummy para poder crear un simbolo diferencial entre los casos de (1), y 3) <code>lab_font</code> destacaremos en negrita el año 2020.</p>
<pre class="r"><code>data_inv &lt;-  mutate(data_inv, pr_mean = mean(pr[winter_yr &lt;= 2010]), 
                              ta_mean = mean(ta[winter_yr &lt;= 2010]),
                              pr_anom = (pr*100/pr_mean)-100, 
                              ta_anom = ta-ta_mean,
                              
                              labyr = case_when(pr_anom &lt; -10 &amp; ta_anom &lt; -.5 ~ winter_yr,
                                                pr_anom &lt; -10 &amp; ta_anom &gt; .5 ~ winter_yr,
                                                pr_anom &gt; 10 &amp; ta_anom &lt; -.5 ~ winter_yr,
                                                pr_anom &gt; 10 &amp; ta_anom &gt; .5 ~ winter_yr),
                              symb_point = ifelse(!is.na(labyr), &quot;yes&quot;, &quot;no&quot;),
                              lab_font = ifelse(labyr == 2020, &quot;bold&quot;, &quot;plain&quot;)
                    )</code></pre>
</div>
</div>
<div id="crear-el-gráfico" class="section level2">
<h2>Crear el gráfico</h2>
<p>El gráfico lo construiremos añadiendo capa por capa los diferentes elementos: 1) el fondo con las diferentes cuadrículas (Seco-Cálido, Seco-Frío, etc.) 2) los puntos y etiquetas, y 3) los últimos ajustes de estilo.</p>
<div id="parte-1" class="section level3">
<h3>Parte 1</h3>
<p>La idea es que tengamos los puntos con anomalías seco-cálido en el cuadrante I (arriba-derecha) y los de húmedo-frío en el cuadrante III (abajo-izquierda). Por eso, debemos invertir el signo en las anomalías de precipitación. Después creamos un <code>data.frame</code> con las posiciones de las etiquetas de los cuatro cuadrantes. Para las posiciones en <em>x</em> y <em>y</em> se usan <code>Inf</code> y <code>-Inf</code> lo que equivale al punto máximo dentro del <em>panel</em>. No obstante, es necesario ajustar la posición hacia los puntos extremos dentro del marco gráfico con los argumentos conocidos de <code>ggplot2</code>: <em>hjust</em> y <em>vjust</em>.</p>
<pre class="r"><code>data_inv_p &lt;- mutate(data_inv, pr_anom = pr_anom * -1)

bglab &lt;- data.frame(x = c(-Inf, Inf, -Inf, Inf), 
                    y = c(Inf, Inf, -Inf, -Inf),
                    hjust = c(1, 1, 0, 0), 
                    vjust = c(1, 0, 1, 0),
                    lab = c(&quot;Húmedo-Cálido&quot;, &quot;Seco-Cálido&quot;,
                              &quot;Húmedo-Frío&quot;, &quot;Seco-Frío&quot;))

  
bglab</code></pre>
<pre><code>##      x    y hjust vjust           lab
## 1 -Inf  Inf     1     1 Húmedo-Cálido
## 2  Inf  Inf     1     0   Seco-Cálido
## 3 -Inf -Inf     0     1   Húmedo-Frío
## 4  Inf -Inf     0     0     Seco-Frío</code></pre>
</div>
<div id="parte-2" class="section level3">
<h3>Parte 2</h3>
<p>En la segunda podemos empezar a construir el gráfico añadiendo todos los elementos gráficos. En esta parte creamos el fondo con los diferentes colores de cada cuadrante. La función <code>annotate()</code> permite añadir capas de geometría sin el uso de variables dentro de un <code>data.frame</code>. Con la función <code>geom_hline()</code> y <code>geom_vline()</code> marcamos los cuadrantes en horizontal y vertical usando una linea discontinua. Por último, dibujamos las etiquetas de cada cuadrante, empleando la función <code>geom_text()</code>. Cuando usamos diferentes fuentes de <code>data.frames</code>, uno diferente al principal usado en <code>ggplot()</code>, debemos indicarlo con el argumento <code>data</code> en la función de geomtría correspondiente.</p>
<pre class="r"><code>g1 &lt;- ggplot(data_inv_p, 
             aes(pr_anom, ta_anom)) +
         annotate(&quot;rect&quot;, xmin = -Inf, xmax = 0, ymin = 0, ymax = Inf, fill = &quot;#fc9272&quot;, alpha = .6) + #humedo-calido
         annotate(&quot;rect&quot;, xmin = 0, xmax = Inf, ymin = 0, ymax = Inf, fill = &quot;#cb181d&quot;, alpha = .6) + #seco-calido
         annotate(&quot;rect&quot;, xmin = -Inf, xmax = 0, ymin = -Inf, ymax = 0, fill = &quot;#2171b5&quot;, alpha = .6) + #humedo-frio
         annotate(&quot;rect&quot;, xmin = 0, xmax = Inf, ymin = -Inf, ymax = 0, fill = &quot;#c6dbef&quot;, alpha = .6) + #seco-frio
       geom_hline(yintercept = 0,
                  linetype = &quot;dashed&quot;) +
       geom_vline(xintercept = 0,
                  linetype = &quot;dashed&quot;) +
       geom_text(data = bglab, 
                     aes(x, y, label = lab, hjust = hjust, vjust = vjust),
                     fontface = &quot;italic&quot;, size = 5, 
                     angle = 90, colour = &quot;white&quot;)

g1</code></pre>
<p><img src="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/index.es_files/figure-html/unnamed-chunk-9-1.png" width="3507" /></p>
</div>
<div id="parte-3" class="section level3">
<h3>Parte 3</h3>
<p>En la tercera parte simplemente añadimos los puntos de las anomalías y las etiquetas de los años. La función <code>geom_text_repel()</code> es similar a la que conocemos por defecto en <code>ggplot2</code>, <code>geom_text()</code>, pero evita el sobrlapso entre sí.</p>
<pre class="r"><code>g2 &lt;- g1 + geom_point(aes(fill = symb_point, colour = symb_point),
                      size = 2.8, shape = 21, show.legend = FALSE) +
           geom_text_repel(aes(label = labyr, fontface = lab_font),
                           max.iter = 5000, 
                           size = 3.5) 
g2</code></pre>
<pre><code>## Warning: Removed 25 rows containing missing values (geom_text_repel).</code></pre>
<p><img src="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/index.es_files/figure-html/unnamed-chunk-10-1.png" width="3507" /></p>
</div>
<div id="parte-4" class="section level3">
<h3>Parte 4</h3>
<p>En la última parte ajustamos, además del estilo general, los ejes, el tipo de color y el (sub)título. Recuerda que cambiamos el signo en las anomalías de precipitación. Por eso, debemos usar los argumentos <code>breaks</code> y <code>labels</code> en la función <code>scale_x_continouous()</code> para revertir el signo en las etiquetas correspondientes a los cortes.</p>
<pre class="r"><code>g3 &lt;- g2 + scale_x_continuous(&quot;Anomalía de precipitación en %&quot;,
                              breaks = seq(-100, 250, 10) * -1,
                              labels = seq(-100, 250, 10),
                              limits = c(min(data_inv_p$pr_anom), 100)) +
           scale_y_continuous(&quot;Anomalía de temperatura media en ºC&quot;,
                              breaks = seq(-2, 2, 0.5)) +
           scale_fill_manual(values = c(&quot;black&quot;, &quot;white&quot;)) +
           scale_colour_manual(values = rev(c(&quot;black&quot;, &quot;white&quot;))) +
           labs(title = &quot;Anomalías invernales en Tenerife Sur&quot;, 
                caption = &quot;Datos: AEMET\nPeriodo normal 1981-2010&quot;) +
           theme_bw()

g3</code></pre>
<pre><code>## Warning: Removed 25 rows containing missing values (geom_text_repel).</code></pre>
<p><img src="https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/index.es_files/figure-html/unnamed-chunk-11-1.png" width="3507" /></p>
<p><a href="https://www.buymeacoffee.com/drxeo" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/default-orange.png" alt="Buy Me A Coffee" height="41" width="174"></a></p>
</div>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/es/tag/anomalia/">anomalía</a>
  
  <a class="badge badge-light" href="/es/tag/precipitacion/">precipitación</a>
  
  <a class="badge badge-light" href="/es/tag/temperatura/">temperatura</a>
  
  <a class="badge badge-light" href="/es/tag/clima/">clima</a>
  
  <a class="badge badge-light" href="/es/tag/puntos/">puntos</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/&amp;text=Visualizar%20anomal%c3%adas%20clim%c3%a1ticas" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/&amp;t=Visualizar%20anomal%c3%adas%20clim%c3%a1ticas" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Visualizar%20anomal%c3%adas%20clim%c3%a1ticas&amp;body=https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/&amp;title=Visualizar%20anomal%c3%adas%20clim%c3%a1ticas" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Visualizar%20anomal%c3%adas%20clim%c3%a1ticas%20https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://dominicroye.github.io/es/2020/visualizar-anomalias-climaticas/&amp;title=Visualizar%20anomal%c3%adas%20clim%c3%a1ticas" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://dominicroye.github.io/"><img class="avatar mr-3 avatar-circle" src="/es/author/dr.-dominic-roye/avatar_hu930bec32484cd86675af8880de95caa2_508993_270x270_fill_q75_lanczos_center.jpg" alt="Dr. Dominic Royé"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://dominicroye.github.io/">Dr. Dominic Royé</a></h5>
      <h6 class="card-subtitle">Investigador y responsable de ciencia de datos</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/dr_xeo" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:dominic.roye@ficlima.org" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.es/citations?user=EoYa8jUAAAAJ&amp;hl=es" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/dominicroye" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/dominicroye/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Dominic_Roye" target="_blank" rel="noopener">
        <i class="ai ai-researchgate"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Relacionado</h3>
    <ul>
      
      <li><a href="/es/2019/visualizar-anomalias-de-precipitacion-mensual/">Visualizar anomalías de precipitación mensual</a></li>
      
      <li><a href="/es/2020/un-heatmap-como-calendario/">Un heatmap como calendario</a></li>
      
      <li><a href="/es/2020/animacion-climatica-de-la-temperatura-maxima/">Animación climática de la temperatura máxima</a></li>
      
      <li><a href="/es/project/climate/">Clima y tiempo</a></li>
      
      <li><a href="/es/project/animations/">Animaciones</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  
  <p class="powered-by">
    © 2018-2023 Dominic Royé. All rights reserved
  </p>
  

  
  






  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Citar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copiar
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Descargar
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    <script src="/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js"></script>

    
    
    
      
      
        <script src="https://cdn.jsdelivr.net/gh/desandro/imagesloaded@v4.1.4/imagesloaded.pkgd.min.js" integrity="sha512-S5PZ9GxJZO16tT9r3WJp/Safn31eu8uWrzglMahDT4dsmgqWonRY9grk3j+3tfuPr9WJNsfooOR7Gi7HL5W2jw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/metafizzy/isotope@v3.0.6/dist/isotope.pkgd.min.js" integrity="sha512-Zq2BOxyhvnRFXu0+WE6ojpZLOU2jdnqbrM1hmVdGzyeCa1DgM3X5Q4A/Is9xA1IkbUeDd7755dNNI/PzSf2Pew==" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    <script src="/es/js/wowchemy.min.50d3bf3df0c53b31631bb48a62b35f92.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
