<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.2.0">
  <meta name="generator" content="Hugo 0.53" />
  <meta name="author" content="Dr. Dominic Royé">

  
  
  
  
    
  
  <meta name="description" content="El universo de los paquetes de tidyverse, una colección de paquetes de funciones para un uso especialmente enfocado en la ciencia de datos, abrió un antes y después en la programación de R. En este post voy a resumir muy brevemente lo más esencial para inicarse en este mundo. La gramática sigue en todas las funciones una estructura común. Lo más esencial es que el primer argumento es el objeto y a continuación viene el resto de argumentos. Además, se proporciona un conjunto de verbos que facilitan el uso de las funciones. En la actualidad, la filosofía de las funciones también se refleja en otros paquetes que hacen compatible su uso con la colección de tidyverse.">

  
  <link rel="alternate" hreflang="en-us" href="/es/2020/una-muy-breve-introducci%C3%B3n-a-tidyverse/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css" crossorigin="anonymous">
      
    

    

    

  

  
  

  <link rel="stylesheet" href="/es/styles.css">
  
  <link rel="stylesheet" href="/css/override.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-27463794-2', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Dominic Royé">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Dominic Royé">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/es/2020/una-muy-breve-introducci%C3%B3n-a-tidyverse/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Dominic Royé">
  <meta property="og:url" content="/es/2020/una-muy-breve-introducci%C3%B3n-a-tidyverse/">
  <meta property="og:title" content="Una muy breve introducción a Tidyverse | Dominic Royé">
  <meta property="og:description" content="El universo de los paquetes de tidyverse, una colección de paquetes de funciones para un uso especialmente enfocado en la ciencia de datos, abrió un antes y después en la programación de R. En este post voy a resumir muy brevemente lo más esencial para inicarse en este mundo. La gramática sigue en todas las funciones una estructura común. Lo más esencial es que el primer argumento es el objeto y a continuación viene el resto de argumentos. Además, se proporciona un conjunto de verbos que facilitan el uso de las funciones. En la actualidad, la filosofía de las funciones también se refleja en otros paquetes que hacen compatible su uso con la colección de tidyverse."><meta property="og:image" content="/es/2020/una-muy-breve-introducci%C3%B3n-a-tidyverse/featured.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2020-06-06T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2020-06-06T00:00:00&#43;00:00">
  

  

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#2962ff",
          "text": "#fff"
        },
        "button": {
          "background": "#fff",
          "text": "#2962ff"
        }
      },
      "theme": "classic",
      "content": {
        "message": "Este sitio web utiliza cookies para garantizarle una mejor experiencia.",
        "dismiss": "Entendido!",
        "link": "Más información",
        "href": "https://cookies.insites.com"
      }
    })});
</script>


  

  <title>Una muy breve introducción a Tidyverse | Dominic Royé</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>

<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/es"><div style="position:relative;float:left">Dominic Royé<img src="/img/portrait.jpg" alt="Dominic Royé" style="float: left;"></div></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Barra de navegación">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        

        <li class="nav-item">
          <a class="nav-link" href="/es/#">
            
            <span>inicio</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/es/#posts">
            
            <span>blog</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/es/#publications_selected">
            
            <span>publicaciones</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/es/#graphs">
            
            <span>gráficos</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/es/#about">
            
            <span>mí</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/es/#teaching">
            
            <span>más</span>
            
          </a>
        </li>

        
        

      

        

        

        

        

      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  













<div class="article-header d-xl-none">
  <div class="featured-image" style="background-image: url('/es/2020/una-muy-breve-introducci%C3%B3n-a-tidyverse/featured_hucb30efb4845712af1b21177307978519_146938_800x0_resize_box_2.png');"></div>
  
</div>


<div class="container-fluid split-header d-none d-xl-block">
  <div class="row">
    <div class="col-6">
      <div class="split-header-content">
        <h1 itemprop="name">Una muy breve introducción a Tidyverse</h1>

        

        

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>
  

  <span class="article-date">
    
    <meta content="2020-06-06 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2020-06-06 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      2020-06-06
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>

  

  
  
  <span class="middot-divider"></span>
  <a href="/es/2020/una-muy-breve-introducci%C3%B3n-a-tidyverse/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/es/categories/tidyverse/">tidyverse</a>, 
    
    <a href="/es/categories/r/">R</a>, 
    
    <a href="/es/categories/rprincipante/">R:principante</a>
    
  </span>
  
  

  

</div>


        







  










        
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Una%20muy%20breve%20introducci%c3%b3n%20a%20Tidyverse&amp;url=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f&amp;title=Una%20muy%20breve%20introducci%c3%b3n%20a%20Tidyverse"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f&amp;title=Una%20muy%20breve%20introducci%c3%b3n%20a%20Tidyverse"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Una%20muy%20breve%20introducci%c3%b3n%20a%20Tidyverse&amp;body=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


      </div>
    </div>
    <div class="col-6">
      <div class="split-header-image">
        <img src="/es/2020/una-muy-breve-introducci%C3%B3n-a-tidyverse/featured_hucb30efb4845712af1b21177307978519_146938_680x500_fill_q90_box_smart1_2.png" itemprop="image" alt="">
        
      </div>
    </div>
  </div>
</div>

<div class="article-container d-xl-none">
  <h1 itemprop="name">Una muy breve introducción a Tidyverse</h1>

  

  

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>
  

  <span class="article-date">
    
    <meta content="2020-06-06 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2020-06-06 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      2020-06-06
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Dr. Dominic Royé">
  </span>

  

  
  
  <span class="middot-divider"></span>
  <a href="/es/2020/una-muy-breve-introducci%C3%B3n-a-tidyverse/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/es/categories/tidyverse/">tidyverse</a>, 
    
    <a href="/es/categories/r/">R</a>, 
    
    <a href="/es/categories/rprincipante/">R:principante</a>
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Una%20muy%20breve%20introducci%c3%b3n%20a%20Tidyverse&amp;url=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f&amp;title=Una%20muy%20breve%20introducci%c3%b3n%20a%20Tidyverse"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f&amp;title=Una%20muy%20breve%20introducci%c3%b3n%20a%20Tidyverse"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Una%20muy%20breve%20introducci%c3%b3n%20a%20Tidyverse&amp;body=%2fes%2f2020%2funa-muy-breve-introducci%25C3%25B3n-a-tidyverse%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


  







  









</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<div id="TOC">
<ul>
<li><a href="#tiyverse"><span class="toc-section-number">1</span> Tiyverse</a></li>
<li><a href="#guía-de-estilo"><span class="toc-section-number">2</span> Guía de estilo</a></li>
<li><a href="#pipe"><span class="toc-section-number">3</span> Pipe %&gt;%</a></li>
<li><a href="#paquetes-de-tidyverse"><span class="toc-section-number">4</span> Paquetes de Tidyverse</a><ul>
<li><a href="#lectura-y-escritura"><span class="toc-section-number">4.1</span> Lectura y escritura</a></li>
<li><a href="#manipulación-de-caracteres"><span class="toc-section-number">4.2</span> Manipulación de caracteres</a></li>
<li><a href="#manejo-de-fechas-y-horas"><span class="toc-section-number">4.3</span> Manejo de fechas y horas</a></li>
<li><a href="#manipulación-de-tablas-y-vectores"><span class="toc-section-number">4.4</span> Manipulación de tablas y vectores</a><ul>
<li><a href="#selecionar-y-renombrar"><span class="toc-section-number">4.4.1</span> Selecionar y renombrar</a></li>
<li><a href="#filtrar-y-ordenar"><span class="toc-section-number">4.4.2</span> Filtrar y ordenar</a></li>
<li><a href="#agrupar-y-resumir"><span class="toc-section-number">4.4.3</span> Agrupar y resumir</a></li>
<li><a href="#unir-tablas"><span class="toc-section-number">4.4.4</span> Unir tablas</a></li>
<li><a href="#tablas-largas-y-anchas"><span class="toc-section-number">4.4.5</span> Tablas largas y anchas</a></li>
</ul></li>
<li><a href="#visualizar-datos"><span class="toc-section-number">4.5</span> Visualizar datos</a><ul>
<li><a href="#gráfico-de-linea-y-puntos"><span class="toc-section-number">4.5.1</span> Gráfico de linea y puntos</a></li>
<li><a href="#boxplot"><span class="toc-section-number">4.5.2</span> Boxplot</a></li>
<li><a href="#heatmap"><span class="toc-section-number">4.5.3</span> Heatmap</a></li>
</ul></li>
<li><a href="#aplicar-funciones-sobre-vectores-o-listas"><span class="toc-section-number">4.6</span> Aplicar funciones sobre vectores o listas</a></li>
</ul></li>
</ul>
</div>

<div id="tiyverse" class="section level1">
<h1><span class="header-section-number">1</span> Tiyverse</h1>
<p>El universo de los paquetes de <code>tidyverse</code>, una colección de paquetes de funciones para un uso especialmente enfocado en la ciencia de datos, abrió un antes y después en la programación de R. En este post voy a resumir muy brevemente lo más esencial para inicarse en este mundo. La gramática sigue en todas las funciones una estructura común. Lo más esencial es que el primer argumento es el objeto y a continuación viene el resto de argumentos. Además, se proporciona un conjunto de verbos que facilitan el uso de las funciones. En la actualidad, la filosofía de las funciones también se refleja en otros paquetes que hacen compatible su uso con la colección de <code>tidyverse</code>. Por ejemplo, el paquete <code>sf</code> (<a href="https://r-spatial.github.io/sf/articles/sf1.html">simple feature</a>) para el tratamiento de datos vectoriales, permite el uso de múltiples funciones que encontramos en el paquete <code>dplyr</code>.</p>
<p>El núcleo de la colección lo constituyen los siguientes paquetes:</p>
<table>
<thead>
<tr class="header">
<th align="left">Paquete</th>
<th align="left">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ggplot2</td>
<td align="left">Gramática para la creación de gráficos</td>
</tr>
<tr class="even">
<td align="left">purrr</td>
<td align="left">Programación funcional de R</td>
</tr>
<tr class="odd">
<td align="left">tibble</td>
<td align="left">Sistema moderno y efectivo de tablas</td>
</tr>
<tr class="even">
<td align="left">dplyr</td>
<td align="left">Gramatica para la manipulación de datos</td>
</tr>
<tr class="odd">
<td align="left">tidyr</td>
<td align="left">Conjunto de funciones para ordenar datos</td>
</tr>
<tr class="even">
<td align="left">stringr</td>
<td align="left">Conjunto de funciones para trabajar con caracteres</td>
</tr>
<tr class="odd">
<td align="left">readr</td>
<td align="left">Una forma fácil y rápida para importar datos</td>
</tr>
<tr class="even">
<td align="left">forcats</td>
<td align="left">Herramientas y funciones para trabajar fácilmente con factores</td>
</tr>
</tbody>
</table>
<p>Además de los paquetes menciondos, también se usa muy frecuentemente <code>lubridate</code> para trabajar con fechas y horas, y también <code>readxl</code> que nos permite importar archivos en formato Excel. Para conocer todos los paquetes disponibles podemos emplear la función <code>tidyverse_packages()</code>.</p>
<pre><code>##  [1] &quot;broom&quot;      &quot;cli&quot;        &quot;crayon&quot;     &quot;dbplyr&quot;     &quot;dplyr&quot;     
##  [6] &quot;forcats&quot;    &quot;ggplot2&quot;    &quot;haven&quot;      &quot;hms&quot;        &quot;httr&quot;      
## [11] &quot;jsonlite&quot;   &quot;lubridate&quot;  &quot;magrittr&quot;   &quot;modelr&quot;     &quot;pillar&quot;    
## [16] &quot;purrr&quot;      &quot;readr&quot;      &quot;readxl&quot;     &quot;reprex&quot;     &quot;rlang&quot;     
## [21] &quot;rstudioapi&quot; &quot;rvest&quot;      &quot;stringr&quot;    &quot;tibble&quot;     &quot;tidyr&quot;     
## [26] &quot;xml2&quot;       &quot;tidyverse&quot;</code></pre>
<p>Es muy fácil encontrarnos con conflicos de funciones, o sea, que el mismo nombre de función exista en varios paquetes. Para evitarlo, podemos escribir el nombre del paquete delante de la función que queremos usar, separados por el símbolo de dos puntos escrito dos veces (<code>package_name::function_name</code>).</p>
<p>Antes de empezar con los paquetes, espero que sea verdaderamente una breve introducción, algunos comentarios sobre el estilo al programar en R.</p>
</div>
<div id="guía-de-estilo" class="section level1">
<h1><span class="header-section-number">2</span> Guía de estilo</h1>
<p>En R no existe una guía de estilo universal, o sea, en la sintaxis de R no es necesario seguir normas concretas para nuestros scripts. Es recomendable trabajar de forma homogénea y clara a la hora de escribir con un estilo uniforme y legible. La colección de <code>tidyverse</code> tiene una guia propia (<a href="https://style.tidyverse.org/" class="uri">https://style.tidyverse.org/</a>).</p>
<p>Las recomendaciones más importes son:</p>
<ul>
<li>Evitar usar más de 80 caracteres por línea para permitir leer el código completo.</li>
<li>Usar siempre un espacio después de una coma, nunca antes.</li>
<li>Los operadores (==, +, -, &lt;-, %&gt;%, etc.) deben tener un espacio antes y después.</li>
<li>No hay espacio entre el nombre de una función y el primer paréntesis, ni entre el último arguemento y el paréntesis final de una función.</li>
<li>Evitar reutilizar nombres de funciones y variables comunes (<code>c &lt;- 5</code> vs. <code>c()</code>)</li>
<li>Ordenar el script separando las partes con la forma de comentario <code># Importar datos -----</code></li>
<li>Se deben evitar tildes o símbolos especiales en nombres, archivos, rutas, etc.</li>
<li>Nombres de los objetos deben seguir una estructura constante: <code>day_one</code>, <code>day_1</code>.</li>
</ul>
<p>Es aconsejable usar una correcta <em>indentación</em> para multiples argumentos de una función o funciones encadenadas por el operador <code>pipe</code> (<code>%&gt;%</code>).</p>
</div>
<div id="pipe" class="section level1">
<h1><span class="header-section-number">3</span> Pipe %&gt;%</h1>
<p>Para facilitar el trabajo en la gestión, manipulación y visualización de datos, el paquete <code>magrittr</code> introduce el operador llamado <em>pipe</em> en la forma <code>%&gt;%</code> con el objetivo de combinar varias funciones sin la necesidad de asignar el resultado a un nuevo objeto. El operador <em>pipe</em> pasa a la salida de una función aplicada al primer argumento de la siguiente función. Esta forma de combinar funciones permite encadenar varios pasos de forma simultánea. En el siguiente ejemplo, muy sencillo, pasamos el vector <code>1:5</code> a la función <code>mean()</code> para calcular el promedio.</p>
<pre class="r"><code>1:5 %&gt;% mean()</code></pre>
<pre><code>## [1] 3</code></pre>
</div>
<div id="paquetes-de-tidyverse" class="section level1">
<h1><span class="header-section-number">4</span> Paquetes de Tidyverse</h1>
<div id="lectura-y-escritura" class="section level2">
<h2><span class="header-section-number">4.1</span> Lectura y escritura</h2>
<p>El paquete <code>readr</code> facilita la lectura o escritura de múltiples formatos de archivo usando funciones que comienzan por <code>read_*</code> o <code>write_*</code>.
En comparación con <em>R Base</em> las funciones son más rápidas, ayudan a limpiar los nombres de las columnas y las fechas son convertidas automáticamente. Las tablas importadas son de clase <code>tibble</code> (<strong>tbl_df</strong>), una versión moderna de <code>data.frame</code> del paquete <code>tibble</code>. En el mismo sentido se puede usar la función <code>read_excel()</code> del paquete <code>readxl</code> para importar datos de hojas de Excel (más detalles también en esta <a href="https://dominicroye.github.io/es/2019/importar-varias-hojas-excel-en-r/">entrada de mi blog</a>). En el siguiente ejemplo importamos los datos de la movilidad registrada por Google (<a href="https://www.google.com/covid19/mobility/">enlace</a>) durante los últimos meses a causa de la pandemia COVID-19 (<a href="/files/Global_Mobility_Report.csv">descarga</a>).</p>
<table>
<thead>
<tr class="header">
<th align="left">Función lectura</th>
<th align="left">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">read_csv() o read_csv2()</td>
<td align="left">coma o punto-coma (CSV)</td>
</tr>
<tr class="even">
<td align="left">read_delim()</td>
<td align="left">separador general</td>
</tr>
<tr class="odd">
<td align="left">read_table()</td>
<td align="left">espacio blanco</td>
</tr>
</tbody>
</table>
<pre class="r"><code># cargar el paquete
library(tidyverse)

google_mobility &lt;- read_csv(&quot;Global_Mobility_Report.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   country_region_code = col_character(),
##   country_region = col_character(),
##   sub_region_1 = col_character(),
##   sub_region_2 = col_logical(),
##   iso_3166_2_code = col_character(),
##   census_fips_code = col_logical(),
##   date = col_date(format = &quot;&quot;),
##   retail_and_recreation_percent_change_from_baseline = col_double(),
##   grocery_and_pharmacy_percent_change_from_baseline = col_double(),
##   parks_percent_change_from_baseline = col_double(),
##   transit_stations_percent_change_from_baseline = col_double(),
##   workplaces_percent_change_from_baseline = col_double(),
##   residential_percent_change_from_baseline = col_double()
## )</code></pre>
<pre><code>## Warning: 597554 parsing failures.
##    row              col           expected         actual                         file
## 200119 sub_region_2     1/0/T/F/TRUE/FALSE Autauga County &#39;Global_Mobility_Report.csv&#39;
## 200119 census_fips_code 1/0/T/F/TRUE/FALSE 01001          &#39;Global_Mobility_Report.csv&#39;
## 200120 sub_region_2     1/0/T/F/TRUE/FALSE Autauga County &#39;Global_Mobility_Report.csv&#39;
## 200120 census_fips_code 1/0/T/F/TRUE/FALSE 01001          &#39;Global_Mobility_Report.csv&#39;
## 200121 sub_region_2     1/0/T/F/TRUE/FALSE Autauga County &#39;Global_Mobility_Report.csv&#39;
## ...... ................ .................. .............. ............................
## See problems(...) for more details.</code></pre>
<pre class="r"><code>google_mobility</code></pre>
<pre><code>## # A tibble: 516,697 x 13
##    country_region_~ country_region sub_region_1 sub_region_2 iso_3166_2_code
##    &lt;chr&gt;            &lt;chr&gt;          &lt;chr&gt;        &lt;lgl&gt;        &lt;chr&gt;          
##  1 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
##  2 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
##  3 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
##  4 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
##  5 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
##  6 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
##  7 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
##  8 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
##  9 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
## 10 AE               United Arab E~ &lt;NA&gt;         NA           &lt;NA&gt;           
## # ... with 516,687 more rows, and 8 more variables: census_fips_code &lt;lgl&gt;,
## #   date &lt;date&gt;, retail_and_recreation_percent_change_from_baseline &lt;dbl&gt;,
## #   grocery_and_pharmacy_percent_change_from_baseline &lt;dbl&gt;,
## #   parks_percent_change_from_baseline &lt;dbl&gt;,
## #   transit_stations_percent_change_from_baseline &lt;dbl&gt;,
## #   workplaces_percent_change_from_baseline &lt;dbl&gt;,
## #   residential_percent_change_from_baseline &lt;dbl&gt;</code></pre>
<p>Debemos prestar atención a los nombres de los argumentos, ya que cambian en las funciones de <code>readr</code>. Por ejemplo, el argumento conocido <code>header = TRUE</code> de <code>read.csv()</code> es en este caso <code>col_names = TRUE</code>. Podemos encontrar más detalles en el <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">Cheat-Sheet</a> de <code>readr</code> .</p>
</div>
<div id="manipulación-de-caracteres" class="section level2">
<h2><span class="header-section-number">4.2</span> Manipulación de caracteres</h2>
<p>Cuando se requiere manipular cadenas de texto usamos el paquete <code>stringr</code>, cuyas funciones siempre empiezan por <code>str_*</code> seguidas por un verbo y el primer argumento.</p>
<p>Algunas de estas funciones son las siguientes:</p>
<table>
<thead>
<tr class="header">
<th align="left">Función</th>
<th align="left">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">str_replace()</td>
<td align="left">reemplazar patrones</td>
</tr>
<tr class="even">
<td align="left">str_c()</td>
<td align="left">combinar characteres</td>
</tr>
<tr class="odd">
<td align="left">str_detect()</td>
<td align="left">detectar patrones</td>
</tr>
<tr class="even">
<td align="left">str_extract()</td>
<td align="left">extraer patrones</td>
</tr>
<tr class="odd">
<td align="left">str_sub()</td>
<td align="left">extraer por posición</td>
</tr>
<tr class="even">
<td align="left">str_length()</td>
<td align="left">longitud de la cadena de caracteres</td>
</tr>
</tbody>
</table>
<p>Se suelen usar expresiones regulares para patrones de caracteres. Por ejemplo, la expresión regular <code>[aeiou]</code> coincide con cualquier caracter único que sea una vocal. El uso de corchetes <code>[]</code> corresponde a clases de caracteres. Por ejemplo, <code>[abc]</code> corresponde a cada letra independientemente de la posición. <code>[a-z]</code> o <code>[A-Z]</code> o <code>[0-9]</code> cada uno entre a y z ó 0 y 9. Y por último, <code>[:punct:]</code> puntuación, etc. Con llaves “{}” podemos indicar el número del elemento anterior <code>{2}</code> sería dos veces, {1,2} entre una y dos, etc. Además con <code>$</code>o <code>^</code> podemos indicar si el patrón empieza al principio o termina al final. Podemos encontrar más detalles y patrones en el <a href="https://github.com/rstudio/cheatsheets/raw/master/strings.pdf">Cheat-Sheet</a> de <code>stringr</code>.</p>
<pre class="r"><code># reemplazamos &#39;er&#39; al final por vacío

str_replace(month.name, &quot;er$&quot;, &quot;&quot;)</code></pre>
<pre><code>##  [1] &quot;January&quot;  &quot;February&quot; &quot;March&quot;    &quot;April&quot;    &quot;May&quot;      &quot;June&quot;    
##  [7] &quot;July&quot;     &quot;August&quot;   &quot;Septemb&quot;  &quot;Octob&quot;    &quot;Novemb&quot;   &quot;Decemb&quot;</code></pre>
<pre class="r"><code>str_replace(month.name, &quot;^Ma&quot;, &quot;&quot;)</code></pre>
<pre><code>##  [1] &quot;January&quot;   &quot;February&quot;  &quot;rch&quot;       &quot;April&quot;     &quot;y&quot;         &quot;June&quot;     
##  [7] &quot;July&quot;      &quot;August&quot;    &quot;September&quot; &quot;October&quot;   &quot;November&quot;  &quot;December&quot;</code></pre>
<pre class="r"><code># combinar caracteres

a &lt;- str_c(month.name, 1:12, sep = &quot;_&quot;)
a</code></pre>
<pre><code>##  [1] &quot;January_1&quot;   &quot;February_2&quot;  &quot;March_3&quot;     &quot;April_4&quot;     &quot;May_5&quot;      
##  [6] &quot;June_6&quot;      &quot;July_7&quot;      &quot;August_8&quot;    &quot;September_9&quot; &quot;October_10&quot; 
## [11] &quot;November_11&quot; &quot;December_12&quot;</code></pre>
<pre class="r"><code># colapsar combinación

str_c(month.name, collapse = &quot;, &quot;)</code></pre>
<pre><code>## [1] &quot;January, February, March, April, May, June, July, August, September, October, November, December&quot;</code></pre>
<pre class="r"><code># dedectamos patrones

str_detect(a, &quot;_[1-5]{1}&quot;)</code></pre>
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE</code></pre>
<pre class="r"><code># extraemos patrones

str_extract(a, &quot;_[1-9]{1,2}&quot;)</code></pre>
<pre><code>##  [1] &quot;_1&quot;  &quot;_2&quot;  &quot;_3&quot;  &quot;_4&quot;  &quot;_5&quot;  &quot;_6&quot;  &quot;_7&quot;  &quot;_8&quot;  &quot;_9&quot;  &quot;_1&quot;  &quot;_11&quot; &quot;_12&quot;</code></pre>
<pre class="r"><code># extraermos los caracteres en las posiciones entre 1 y 2

str_sub(month.name, 1, 2)</code></pre>
<pre><code>##  [1] &quot;Ja&quot; &quot;Fe&quot; &quot;Ma&quot; &quot;Ap&quot; &quot;Ma&quot; &quot;Ju&quot; &quot;Ju&quot; &quot;Au&quot; &quot;Se&quot; &quot;Oc&quot; &quot;No&quot; &quot;De&quot;</code></pre>
<pre class="r"><code># longitud de cada mes

str_length(month.name)</code></pre>
<pre><code>##  [1] 7 8 5 5 3 4 4 6 9 7 8 8</code></pre>
<pre class="r"><code># con pipe, el &#39;.&#39; representa al objeto que pasa el operador %&gt;%
str_length(month.name) %&gt;% 
   str_c(month.name, ., sep = &quot;.&quot;)</code></pre>
<pre><code>##  [1] &quot;January.7&quot;   &quot;February.8&quot;  &quot;March.5&quot;     &quot;April.5&quot;     &quot;May.3&quot;      
##  [6] &quot;June.4&quot;      &quot;July.4&quot;      &quot;August.6&quot;    &quot;September.9&quot; &quot;October.7&quot;  
## [11] &quot;November.8&quot;  &quot;December.8&quot;</code></pre>
<p>Una función muy útil es <code>str_glue()</code> para interpolar caracteres.</p>
<pre class="r"><code>name &lt;- c(&quot;Juan&quot;, &quot;Michael&quot;)
age &lt;- c(50, 80) 
date_today &lt;- Sys.Date()

str_glue(
  &quot;My name is {name}, &quot;,
  &quot;I&#39;am {age}, &quot;,
  &quot;and my birth year is {format(date_today-age*365, &#39;%Y&#39;)}.&quot;
)</code></pre>
<pre><code>## My name is Juan, I&#39;am 50, and my birth year is 1970.
## My name is Michael, I&#39;am 80, and my birth year is 1940.</code></pre>
</div>
<div id="manejo-de-fechas-y-horas" class="section level2">
<h2><span class="header-section-number">4.3</span> Manejo de fechas y horas</h2>
<p>El paquete <code>lubridate</code> ayuda en el manejo de fechas y horas. Nos permite crear los objetos reconocidos por R con funciones (como <code>ymd()</code> ó <code>ymd_hms()</code>) y hacer cálculos.</p>
<p>Debemos conocer las siguientes abreviaturas:</p>
<ul>
<li><code>ymd</code>: representa <code>y:year</code>, <code>m:month</code>, <code>d:day</code></li>
<li><code>hms</code>: representa <code>h:hour</code>, <code>m:minutes</code>, <code>s:seconds</code></li>
</ul>
<pre class="r"><code># paquete
library(lubridate)</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<pre class="r"><code># vector de fechas
dat &lt;- c(&quot;1999/12/31&quot;, &quot;2000/01/07&quot;, &quot;2005/05/20&quot;,&quot;2010/03/25&quot;)

# vector de fechas y horas
dat_time &lt;- c(&quot;1988-08-01 05:00&quot;, &quot;2000-02-01 22:00&quot;)

# convertir a clase date
dat &lt;- ymd(dat) 
dat</code></pre>
<pre><code>## [1] &quot;1999-12-31&quot; &quot;2000-01-07&quot; &quot;2005-05-20&quot; &quot;2010-03-25&quot;</code></pre>
<pre class="r"><code># otras formatos
dmy(&quot;05-02-2000&quot;)</code></pre>
<pre><code>## [1] &quot;2000-02-05&quot;</code></pre>
<pre class="r"><code>ymd(&quot;20000506&quot;)</code></pre>
<pre><code>## [1] &quot;2000-05-06&quot;</code></pre>
<pre class="r"><code># convertir a POSIXct
dat_time &lt;- ymd_hm(dat_time)
dat_time</code></pre>
<pre><code>## [1] &quot;1988-08-01 05:00:00 UTC&quot; &quot;2000-02-01 22:00:00 UTC&quot;</code></pre>
<pre class="r"><code># diferentes formatos en un vector 
dat_mix &lt;- c(&quot;1999/12/05&quot;, &quot;05-09-2008&quot;, &quot;2000/08/09&quot;, &quot;25-10-2019&quot;)

# indicar formato con la convención conocida en ?strptime
parse_date_time(dat_mix, order = c(&quot;%Y/%m/%d&quot;, &quot;%d-%m-%Y&quot;))</code></pre>
<pre><code>## [1] &quot;1999-12-05 UTC&quot; &quot;2008-09-05 UTC&quot; &quot;2000-08-09 UTC&quot; &quot;2019-10-25 UTC&quot;</code></pre>
<p>Más funciones útiles:</p>
<pre class="r"><code># extraer el año
year(dat)</code></pre>
<pre><code>## [1] 1999 2000 2005 2010</code></pre>
<pre class="r"><code># el mes
month(dat)</code></pre>
<pre><code>## [1] 12  1  5  3</code></pre>
<pre class="r"><code>month(dat, label = TRUE) # como etiqueta</code></pre>
<pre><code>## [1] dic ene may mar
## 12 Levels: ene &lt; feb &lt; mar &lt; abr &lt; may &lt; jun &lt; jul &lt; ago &lt; sep &lt; ... &lt; dic</code></pre>
<pre class="r"><code># el día de la semana
wday(dat)</code></pre>
<pre><code>## [1] 6 6 6 5</code></pre>
<pre class="r"><code>wday(dat, label = TRUE) # como etiqueta</code></pre>
<pre><code>## [1] vi vi vi ju
## Levels: do &lt; lu &lt; ma &lt; mi &lt; ju &lt; vi &lt; sá</code></pre>
<pre class="r"><code># la hora
hour(dat_time)</code></pre>
<pre><code>## [1]  5 22</code></pre>
<pre class="r"><code># sumar 10 días
dat + days(10)</code></pre>
<pre><code>## [1] &quot;2000-01-10&quot; &quot;2000-01-17&quot; &quot;2005-05-30&quot; &quot;2010-04-04&quot;</code></pre>
<pre class="r"><code># sumar 1 mes
dat + months(1)</code></pre>
<pre><code>## [1] &quot;2000-01-31&quot; &quot;2000-02-07&quot; &quot;2005-06-20&quot; &quot;2010-04-25&quot;</code></pre>
<p>Por último, la función <code>make_date()</code> es muy útil en crear fechas a partir de diferentes partes de las mismas como puede ser el año, mes, etc.</p>
<pre class="r"><code># crear fecha a partir de sus elementos, aquí con año y mes
make_date(2000, 5)</code></pre>
<pre><code>## [1] &quot;2000-05-01&quot;</code></pre>
<pre class="r"><code># crear fecha con hora 
make_datetime(2005, 5, 23, 5)</code></pre>
<pre><code>## [1] &quot;2005-05-23 05:00:00 UTC&quot;</code></pre>
<p>Podemos encontrar más detalles en el <a href="https://github.com/rstudio/cheatsheets/raw/master/lubridate.pdf">Cheat-Sheet</a> de <code>lubridate</code>.</p>
</div>
<div id="manipulación-de-tablas-y-vectores" class="section level2">
<h2><span class="header-section-number">4.4</span> Manipulación de tablas y vectores</h2>
<p>Los paquetes <code>dplyr</code> y <code>tidyr</code> nos proporciona una gramática de manipulación de datos con un conjunto de verbos útiles para resolver los problemas más comunes. Las funciones más importantes son:</p>
<table>
<thead>
<tr class="header">
<th align="left">Función</th>
<th align="left">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mutate()</td>
<td align="left">añadir nuevas variables o modificar existentes</td>
</tr>
<tr class="even">
<td align="left">select()</td>
<td align="left">seleccionar variables</td>
</tr>
<tr class="odd">
<td align="left">filter()</td>
<td align="left">filtrar</td>
</tr>
<tr class="even">
<td align="left">summarise()</td>
<td align="left">resumir/reducir</td>
</tr>
<tr class="odd">
<td align="left">arrange()</td>
<td align="left">ordenar</td>
</tr>
<tr class="even">
<td align="left">group_by()</td>
<td align="left">agrupar</td>
</tr>
<tr class="odd">
<td align="left">rename()</td>
<td align="left">renombrar columnas</td>
</tr>
</tbody>
</table>
<p>En caso de que no lo hayas hecho antes, importamos los datos de movilidad.</p>
<pre class="r"><code>google_mobility &lt;- read_csv(&quot;Global_Mobility_Report.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   country_region_code = col_character(),
##   country_region = col_character(),
##   sub_region_1 = col_character(),
##   sub_region_2 = col_logical(),
##   iso_3166_2_code = col_character(),
##   census_fips_code = col_logical(),
##   date = col_date(format = &quot;&quot;),
##   retail_and_recreation_percent_change_from_baseline = col_double(),
##   grocery_and_pharmacy_percent_change_from_baseline = col_double(),
##   parks_percent_change_from_baseline = col_double(),
##   transit_stations_percent_change_from_baseline = col_double(),
##   workplaces_percent_change_from_baseline = col_double(),
##   residential_percent_change_from_baseline = col_double()
## )</code></pre>
<pre><code>## Warning: 597554 parsing failures.
##    row              col           expected         actual                         file
## 200119 sub_region_2     1/0/T/F/TRUE/FALSE Autauga County &#39;Global_Mobility_Report.csv&#39;
## 200119 census_fips_code 1/0/T/F/TRUE/FALSE 01001          &#39;Global_Mobility_Report.csv&#39;
## 200120 sub_region_2     1/0/T/F/TRUE/FALSE Autauga County &#39;Global_Mobility_Report.csv&#39;
## 200120 census_fips_code 1/0/T/F/TRUE/FALSE 01001          &#39;Global_Mobility_Report.csv&#39;
## 200121 sub_region_2     1/0/T/F/TRUE/FALSE Autauga County &#39;Global_Mobility_Report.csv&#39;
## ...... ................ .................. .............. ............................
## See problems(...) for more details.</code></pre>
<div id="selecionar-y-renombrar" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Selecionar y renombrar</h3>
<p>Podemos selecionar o eliminar columnas con la función <code>select()</code>, usando el nombre o índice de la(s) columna(s). Para suprimir columnas hacemos uso del signo negativo. La función <code>rename</code> ayuda en renombrar columnas o bien con el mismo nombre o con su índice.</p>
<pre class="r"><code>residential_mobility &lt;- select(google_mobility, 
                               country_region_code:sub_region_1, 
                               date, 
                               residential_percent_change_from_baseline) %&gt;% 
                        rename(resi = 5)</code></pre>
</div>
<div id="filtrar-y-ordenar" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Filtrar y ordenar</h3>
<p>Para filtrar datos, empleamos <code>filter()</code> con operadores lógicos (<code>|</code>, <code>==</code>, <code>&gt;</code>, etc) o funciones que devuelven un valor lógico (<code>str_detect()</code>, <code>is.na()</code>, etc.). La función <code>arrange()</code> ordena de menor a mayor por una o múltiples variables (con el signo negativo <code>-</code> se invierte el orden de mayor a menor).</p>
<pre class="r"><code>filter(residential_mobility, 
       country_region_code == &quot;US&quot;)</code></pre>
<pre><code>## # A tibble: 304,648 x 5
##    country_region_code country_region sub_region_1 date        resi
##    &lt;chr&gt;               &lt;chr&gt;          &lt;chr&gt;        &lt;date&gt;     &lt;dbl&gt;
##  1 US                  United States  &lt;NA&gt;         2020-02-15    -1
##  2 US                  United States  &lt;NA&gt;         2020-02-16    -1
##  3 US                  United States  &lt;NA&gt;         2020-02-17     5
##  4 US                  United States  &lt;NA&gt;         2020-02-18     1
##  5 US                  United States  &lt;NA&gt;         2020-02-19     0
##  6 US                  United States  &lt;NA&gt;         2020-02-20     1
##  7 US                  United States  &lt;NA&gt;         2020-02-21     0
##  8 US                  United States  &lt;NA&gt;         2020-02-22    -1
##  9 US                  United States  &lt;NA&gt;         2020-02-23    -1
## 10 US                  United States  &lt;NA&gt;         2020-02-24     0
## # ... with 304,638 more rows</code></pre>
<pre class="r"><code>filter(residential_mobility, 
       country_region_code == &quot;US&quot;, 
       sub_region_1 == &quot;New York&quot;)</code></pre>
<pre><code>## # A tibble: 7,068 x 5
##    country_region_code country_region sub_region_1 date        resi
##    &lt;chr&gt;               &lt;chr&gt;          &lt;chr&gt;        &lt;date&gt;     &lt;dbl&gt;
##  1 US                  United States  New York     2020-02-15     0
##  2 US                  United States  New York     2020-02-16    -1
##  3 US                  United States  New York     2020-02-17     9
##  4 US                  United States  New York     2020-02-18     3
##  5 US                  United States  New York     2020-02-19     2
##  6 US                  United States  New York     2020-02-20     2
##  7 US                  United States  New York     2020-02-21     3
##  8 US                  United States  New York     2020-02-22    -1
##  9 US                  United States  New York     2020-02-23    -1
## 10 US                  United States  New York     2020-02-24     0
## # ... with 7,058 more rows</code></pre>
<pre class="r"><code>filter(residential_mobility, 
       resi &gt; 50) %&gt;% 
          arrange(-resi)</code></pre>
<pre><code>## # A tibble: 32 x 5
##    country_region_co~ country_region sub_region_1               date        resi
##    &lt;chr&gt;              &lt;chr&gt;          &lt;chr&gt;                      &lt;date&gt;     &lt;dbl&gt;
##  1 KW                 Kuwait         Al Farwaniyah Governorate  2020-05-14    56
##  2 KW                 Kuwait         Al Farwaniyah Governorate  2020-05-21    55
##  3 SG                 Singapore      &lt;NA&gt;                       2020-05-01    55
##  4 KW                 Kuwait         Al Farwaniyah Governorate  2020-05-28    54
##  5 PE                 Peru           Metropolitan Municipality~ 2020-04-10    54
##  6 EC                 Ecuador        Pichincha                  2020-03-27    53
##  7 KW                 Kuwait         Al Farwaniyah Governorate  2020-05-11    53
##  8 KW                 Kuwait         Al Farwaniyah Governorate  2020-05-13    53
##  9 KW                 Kuwait         Al Farwaniyah Governorate  2020-05-20    53
## 10 SG                 Singapore      &lt;NA&gt;                       2020-04-10    53
## # ... with 22 more rows</code></pre>
</div>
<div id="agrupar-y-resumir" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Agrupar y resumir</h3>
<p>¿Dónde encontramos mayor variabilidad entre regiones en cada país el día 1 de abril de 2020?</p>
<p>Para responder a esta pregunta, primero filtramos los datos y después agrupamos por la columna de país. Cuando empleamos la función <code>summarise()</code> posterior a la agrupación, nos permite resumir por estos grupos. Incluso, la combinación del <code>group_by()</code> con la función <code>mutate()</code> permite modificar columnas por grupos. En <code>summarise()</code> calculamos el valor máximo, mínimo y la diferencia entre ambos extremos creando nuevas columnas.</p>
<pre class="r"><code>resi_variability &lt;- residential_mobility %&gt;% 
                        filter(date == ymd(&quot;2020-04-01&quot;),
                               !is.na(sub_region_1)) %&gt;% 
                          group_by(country_region) %&gt;% 
                       summarise(mx = max(resi, na.rm = TRUE), 
                                 min = min(resi, na.rm = TRUE),
                                 range = abs(mx)-abs(min))</code></pre>
<pre><code>## Warning in max(resi, na.rm = TRUE): ningun argumento finito para max; retornando
## -Inf

## Warning in max(resi, na.rm = TRUE): ningun argumento finito para max; retornando
## -Inf

## Warning in max(resi, na.rm = TRUE): ningun argumento finito para max; retornando
## -Inf

## Warning in max(resi, na.rm = TRUE): ningun argumento finito para max; retornando
## -Inf

## Warning in max(resi, na.rm = TRUE): ningun argumento finito para max; retornando
## -Inf

## Warning in max(resi, na.rm = TRUE): ningun argumento finito para max; retornando
## -Inf</code></pre>
<pre><code>## Warning in min(resi, na.rm = TRUE): ningún argumento finito para min; retornando
## Inf

## Warning in min(resi, na.rm = TRUE): ningún argumento finito para min; retornando
## Inf

## Warning in min(resi, na.rm = TRUE): ningún argumento finito para min; retornando
## Inf

## Warning in min(resi, na.rm = TRUE): ningún argumento finito para min; retornando
## Inf

## Warning in min(resi, na.rm = TRUE): ningún argumento finito para min; retornando
## Inf

## Warning in min(resi, na.rm = TRUE): ningún argumento finito para min; retornando
## Inf</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>arrange(resi_variability, -range)</code></pre>
<pre><code>## # A tibble: 94 x 4
##    country_region    mx   min range
##    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Nigeria           43     6    37
##  2 United States     35     6    29
##  3 India             36    15    21
##  4 Malaysia          45    26    19
##  5 Philippines       40    21    19
##  6 Vietnam           28     9    19
##  7 Colombia          41    24    17
##  8 Ecuador           44    27    17
##  9 Argentina         35    19    16
## 10 Chile             30    14    16
## # ... with 84 more rows</code></pre>
</div>
<div id="unir-tablas" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Unir tablas</h3>
<p>¿Cómo podemos filtrar los datos para obtener un subconjunto de Europa?</p>
<p>Para ello, importamos datos espaciales con el código de país y una columna de las regiones. Explicaciones detalladas sobre el paquete <code>sf</code> (<em>simple feature</em>) para trabajar con datos vectoriales, lo dejaremos para otro post.</p>
<pre class="r"><code>library(rnaturalearth) # paquete de datos vectoriales

# datos de países
wld &lt;- ne_countries(returnclass = &quot;sf&quot;)

# filtramos los países con código y seleccionamos las dos columnas de interés
wld &lt;- filter(wld, !is.na(iso_a2)) %&gt;% select(iso_a2, subregion)

# plot
plot(wld)</code></pre>
<p><img src="/post/es/2020-06-06-una-muy-breve-introduccion-a-tidyverse/index.es_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Otras funciones de <code>dplyr</code> nos permiten unir tablas: <code>*_join()</code>. Según hacia qué tabla (izquierda o derecha) se quiere unir, cambia la función : <code>left_join()</code>, <code>right_join()</code> o incluso <code>full_join()</code>. El argumento <code>by</code> no es necesario siempre y cuando ambas tablas tienen una columna en común. No obstante, en este caso la columna de fusión es diferente, por eso, usamos el modo <code>c("country_region_code"="iso_a2")</code>. El paquete <code>forcats</code> de <code>tidyverse</code> tiene muchas funciones útiles para manejar variables categóricas (<code>factors</code>), variables que tienen un conjunto fijo y conocido de valores posibles. Todas las funciones de <code>forcats</code> tienen el prefijo <code>fct_*</code>. Por ejemplo, en este caso usamos <code>fct_reorder()</code> para reordenar las etiquetas de los países en orden de la máxima basada en los registros de movibilidad residencial. Finalmente, creamos una nueva columna ‘resi_real’ para cambiar el valor de referencia, el promedio (<em>baseline</em>), fijado en 0 a 100.</p>
<pre class="r"><code>subset_europe &lt;- filter(residential_mobility, 
                        is.na(sub_region_1),
                        !is.na(resi)) %&gt;%
                 left_join(wld, by = c(&quot;country_region_code&quot;=&quot;iso_a2&quot;)) %&gt;% 
                 filter(subregion %in% c(&quot;Northern Europe&quot;,
                                         &quot;Southern Europe&quot;,
                                          &quot;Western Europe&quot;,
                                          &quot;Eastern Europe&quot;)) %&gt;%
                 mutate(resi_real = resi + 100,
                        region = fct_reorder(country_region, 
                                             resi, 
                                            .fun = &quot;max&quot;, 
                                            .desc = FALSE)) %&gt;% 
                select(-geometry, -sub_region_1)

str(subset_europe)</code></pre>
<pre><code>## tibble [3,988 x 7] (S3: tbl_df/tbl/data.frame)
##  $ country_region_code: chr [1:3988] &quot;AT&quot; &quot;AT&quot; &quot;AT&quot; &quot;AT&quot; ...
##  $ country_region     : chr [1:3988] &quot;Austria&quot; &quot;Austria&quot; &quot;Austria&quot; &quot;Austria&quot; ...
##  $ date               : Date[1:3988], format: &quot;2020-02-15&quot; &quot;2020-02-16&quot; ...
##  $ resi               : num [1:3988] -2 -2 0 0 1 0 1 -2 0 -1 ...
##  $ subregion          : chr [1:3988] &quot;Western Europe&quot; &quot;Western Europe&quot; &quot;Western Europe&quot; &quot;Western Europe&quot; ...
##  $ resi_real          : num [1:3988] 98 98 100 100 101 100 101 98 100 99 ...
##  $ region             : Factor w/ 35 levels &quot;Belarus&quot;,&quot;Ukraine&quot;,..: 18 18 18 18 18 18 18 18 18 18 ...
##  - attr(*, &quot;problems&quot;)= tibble [597,554 x 5] (S3: tbl_df/tbl/data.frame)
##   ..$ row     : int [1:597554] 200119 200119 200120 200120 200121 200121 200122 200122 200123 200123 ...
##   ..$ col     : chr [1:597554] &quot;sub_region_2&quot; &quot;census_fips_code&quot; &quot;sub_region_2&quot; &quot;census_fips_code&quot; ...
##   ..$ expected: chr [1:597554] &quot;1/0/T/F/TRUE/FALSE&quot; &quot;1/0/T/F/TRUE/FALSE&quot; &quot;1/0/T/F/TRUE/FALSE&quot; &quot;1/0/T/F/TRUE/FALSE&quot; ...
##   ..$ actual  : chr [1:597554] &quot;Autauga County&quot; &quot;01001&quot; &quot;Autauga County&quot; &quot;01001&quot; ...
##   ..$ file    : chr [1:597554] &quot;&#39;Global_Mobility_Report.csv&#39;&quot; &quot;&#39;Global_Mobility_Report.csv&#39;&quot; &quot;&#39;Global_Mobility_Report.csv&#39;&quot; &quot;&#39;Global_Mobility_Report.csv&#39;&quot; ...</code></pre>
</div>
<div id="tablas-largas-y-anchas" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Tablas largas y anchas</h3>
<p>Antes de pasar a la visualización con <code>ggplot2</code>. Es muy habitual modificar la tabla entre dos formatos principales. Una tabla es <em>tidy</em> cuando 1) cada variable es una columna 2) cada observación/caso es una fila y 3) cada tipo de unidad observacional forma una tabla.</p>
<pre class="r"><code># subconjunto 
mobility_selection &lt;- select(subset_europe, country_region_code, date:resi)
mobility_selection</code></pre>
<pre><code>## # A tibble: 3,988 x 3
##    country_region_code date        resi
##    &lt;chr&gt;               &lt;date&gt;     &lt;dbl&gt;
##  1 AT                  2020-02-15    -2
##  2 AT                  2020-02-16    -2
##  3 AT                  2020-02-17     0
##  4 AT                  2020-02-18     0
##  5 AT                  2020-02-19     1
##  6 AT                  2020-02-20     0
##  7 AT                  2020-02-21     1
##  8 AT                  2020-02-22    -2
##  9 AT                  2020-02-23     0
## 10 AT                  2020-02-24    -1
## # ... with 3,978 more rows</code></pre>
<pre class="r"><code># tabla ancha
mobi_wide &lt;- pivot_wider(mobility_selection, 
                         names_from = country_region_code,
                         values_from = resi)
mobi_wide</code></pre>
<pre><code>## # A tibble: 114 x 36
##    date          AT    BA    BE    BG    BY    CH    CZ    DE    DK    EE    ES
##    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2020-02-15    -2    -1    -1     0    -1    -1    -2    -1     0     0    -2
##  2 2020-02-16    -2    -1     1    -3     0    -1    -1     0     1     0    -2
##  3 2020-02-17     0    -1     0    -2     0     1     0     0     1     1    -1
##  4 2020-02-18     0    -1     0    -2     0     1     0     1     1     1     0
##  5 2020-02-19     1    -1     0    -1    -1     1     0     1     1     0    -1
##  6 2020-02-20     0    -1     0     0    -1     0     0     1     1     0    -1
##  7 2020-02-21     1    -2     0    -1    -1     1     0     2     1     1    -2
##  8 2020-02-22    -2    -1     0     0    -2    -2    -3     0     1     0    -2
##  9 2020-02-23     0    -1     0    -3    -1    -1     0     0     0    -2    -3
## 10 2020-02-24    -1    -1     4    -1     0     0     0     4     0    16     0
## # ... with 104 more rows, and 24 more variables: FI &lt;dbl&gt;, FR &lt;dbl&gt;, GB &lt;dbl&gt;,
## #   GR &lt;dbl&gt;, HR &lt;dbl&gt;, HU &lt;dbl&gt;, IE &lt;dbl&gt;, IT &lt;dbl&gt;, LT &lt;dbl&gt;, LU &lt;dbl&gt;,
## #   LV &lt;dbl&gt;, MD &lt;dbl&gt;, MK &lt;dbl&gt;, NL &lt;dbl&gt;, NO &lt;dbl&gt;, PL &lt;dbl&gt;, PT &lt;dbl&gt;,
## #   RO &lt;dbl&gt;, RS &lt;dbl&gt;, RU &lt;dbl&gt;, SE &lt;dbl&gt;, SI &lt;dbl&gt;, SK &lt;dbl&gt;, UA &lt;dbl&gt;</code></pre>
<pre class="r"><code># tabla larga
pivot_longer(mobi_wide,
             2:36,
             names_to = &quot;country_code&quot;,
             values_to = &quot;resi&quot;)</code></pre>
<pre><code>## # A tibble: 3,990 x 3
##    date       country_code  resi
##    &lt;date&gt;     &lt;chr&gt;        &lt;dbl&gt;
##  1 2020-02-15 AT              -2
##  2 2020-02-15 BA              -1
##  3 2020-02-15 BE              -1
##  4 2020-02-15 BG               0
##  5 2020-02-15 BY              -1
##  6 2020-02-15 CH              -1
##  7 2020-02-15 CZ              -2
##  8 2020-02-15 DE              -1
##  9 2020-02-15 DK               0
## 10 2020-02-15 EE               0
## # ... with 3,980 more rows</code></pre>
<p>Otro grupo de funciones a las que deberías echar un vistazo son: <code>separate()</code>, <code>case_when()</code>, <code>complete()</code>. Podemos encontrar más detalles en el <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">Cheat-Sheet</a> de <code>dplyr</code></p>
</div>
</div>
<div id="visualizar-datos" class="section level2">
<h2><span class="header-section-number">4.5</span> Visualizar datos</h2>
<p><code>ggplot2</code> es un sistema moderno, y con una enorme variedad de opciones, para visualización de datos. A diferencia del sistema gráfico de <em>R Base</em> se utiliza una gramática diferente.
La gramática de los gráficos (<em>grammar of graphics</em>, de allí “gg”) consiste en la suma de varias capas u objetos independientes que se combinan usando <code>+</code> para construir el gráfico final. <code>ggplot</code> diferencia entre los datos, lo que se visualiza y la forma en que se visualiza.</p>
<ul>
<li><p><em>data</em>: nuestro conjunto de datos (<code>data.frame</code> o <code>tibble</code>)</p></li>
<li><p><em>aesthetics</em>: con la función <code>aes()</code> indicamos las variables que corresponden a los ejes x, y, z,… o, cuando se pretende aplicar parámetros gráficos (<em>color</em>, <em>size</em>, <em>shape</em>) según una variable. Es posible incluir <code>aes()</code> en <code>ggplot()</code> o en la función correspondiente a una geometría <code>geom_*</code>.</p></li>
<li><p><em>geometries</em>: son objetos <code>geom_*</code> que indican la geometría a usar, (p. ej.: <code>geom_point()</code>, <code>geom_line()</code>, <code>geom_boxplot()</code>, etc.).</p></li>
<li><p><em>scales</em>: son objetos de tipo <code>scales_*</code> (p. ej.: <code>scale_x_continous()</code>, <code>scale_colour_manual()</code>) para manipular las ejes, definir colores, etc.</p></li>
<li><p><em>statistics</em>: son objetos <code>stat_*</code> (p.ej.: <code>stat_density()</code>) que permiten aplicar transformaciones estadísticas.</p></li>
</ul>
<p>Podemos encontrar más detalles en el <a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">Cheat-Sheet</a> de <code>ggplot2</code>. <code>ggplot</code> es complementado constantemente con extensiones para geometrías u otras opciones gráficas (<a href="https://exts.ggplot2.tidyverse.org/ggiraph.html" class="uri">https://exts.ggplot2.tidyverse.org/ggiraph.html</a>), para obtener ideas gráficas, debes echarle un vistazo a la Galería de Gráficos R (<a href="https://www.r-graph-gallery.com/" class="uri">https://www.r-graph-gallery.com/</a>).</p>
<div id="gráfico-de-linea-y-puntos" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Gráfico de linea y puntos</h3>
<p>Creamos un subconjunto de nuestros datos de movilidad para residencias y parques, filtrando los registros de regiones italianas. Además, dividimos los valores de movilidad en porcentaje por 100 para obtener la fracción, ya que <code>ggplot2</code> nos permite indicar la unidad de porcentaje en el argumento de las etiquetas (último gráfico de esta sección).</p>
<pre class="r"><code># creamos el subconjunto
it &lt;- filter(google_mobility, 
             country_region == &quot;Italy&quot;, 
             is.na(sub_region_1)) %&gt;% 
      mutate(resi = residential_percent_change_from_baseline/100,   
             parks = parks_percent_change_from_baseline/100)


# gráfico de línea 
ggplot(it, 
       aes(date, resi)) + 
  geom_line()</code></pre>
<p><img src="/post/es/2020-06-06-una-muy-breve-introduccion-a-tidyverse/index.es_files/figure-html/unnamed-chunk-20-1.png" width="2100" /></p>
<pre class="r"><code># gráfico de dispersión con línea de correlación
ggplot(it, 
       aes(parks, resi)) + 
  geom_point() +
  geom_smooth(method = &quot;lm&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/es/2020-06-06-una-muy-breve-introduccion-a-tidyverse/index.es_files/figure-html/unnamed-chunk-20-2.png" width="2100" /></p>
<p>Para modificar los ejes, empleamos las diferentes funciones de <code>scale_*</code> que debemos adpatar a las escalas de medición (<em>date</em>, <em>discrete</em>, <em>continuous</em>, etc.). La función <code>labs()</code> nos ayuda en definir los títulos de ejes, del gráfico y de la leyenda. Por último, añadimos con <code>theme_light()</code> el estilo del gráfico (otros son <code>theme_bw()</code>, <code>theme_minimal()</code>, etc.). También podríamos hacer cambios de todos los elementos gráficos a través de <code>theme()</code>.</p>
<pre class="r"><code># time serie plot
ggplot(it, 
       aes(date, resi)) + 
  geom_line(colour = &quot;#560A86&quot;, size = 0.8) +
  scale_x_date(date_breaks = &quot;10 days&quot;, 
               date_labels = &quot;%d %b&quot;) +
  scale_y_continuous(breaks = seq(-0.1, 1, 0.1), 
                     labels = scales::percent) +
  labs(x = &quot;&quot;, 
       y = &quot;Residential mobility&quot;,
       title = &quot;Mobility during COVID-19&quot;) +
  theme_light()</code></pre>
<p><img src="/post/es/2020-06-06-una-muy-breve-introduccion-a-tidyverse/index.es_files/figure-html/unnamed-chunk-21-1.png" width="2100" /></p>
<pre class="r"><code># scatter plot
ggplot(it, 
       aes(parks, resi)) + 
  geom_point(alpha = .4, size = 2) +
  geom_smooth(method = &quot;lm&quot;) +
  scale_x_continuous(breaks = seq(-1, 1.4, 0.2), 
                     labels = scales::percent) +
  scale_y_continuous(breaks = seq(-1, 1, 0.1), 
                     labels = scales::percent) +
  labs(x = &quot;Park mobility&quot;, 
       y = &quot;Residential mobility&quot;,
       title = &quot;Mobility during COVID-19&quot;) +
  theme_light()</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/es/2020-06-06-una-muy-breve-introduccion-a-tidyverse/index.es_files/figure-html/unnamed-chunk-21-2.png" width="2100" /></p>
</div>
<div id="boxplot" class="section level3">
<h3><span class="header-section-number">4.5.2</span> Boxplot</h3>
<p>Podemos visualizar diferentes aspectos de los datos de movilidad con otras geometrías. Aquí creamos <em>boxplots</em> por cada país europeo representando la variabilidad de movilidad entre y en los países durante la pandemia del COVID-19.</p>
<pre class="r"><code># subconjunto
subset_europe_reg &lt;- filter(residential_mobility, 
                           !is.na(sub_region_1),
                           !is.na(resi)) %&gt;%
                     left_join(wld, by = c(&quot;country_region_code&quot;=&quot;iso_a2&quot;)) %&gt;% 
                     filter(subregion %in% c(&quot;Northern Europe&quot;,
                                         &quot;Southern Europe&quot;,
                                          &quot;Western Europe&quot;,
                                          &quot;Eastern Europe&quot;)) %&gt;% 
                     mutate(resi = resi/100, 
                            country_region = fct_reorder(country_region, resi))

# boxplot
ggplot(subset_europe_reg, 
       aes(country_region, resi, fill = subregion)) + 
  geom_boxplot() +
  scale_y_continuous(breaks = seq(-0.1, 1, 0.1), labels = scales::percent) +
  scale_fill_brewer(palette = &quot;Set1&quot;) +
  coord_flip() +
   labs(x = &quot;&quot;, 
       y = &quot;Residential mobility&quot;,
       title = &quot;Mobility during COVID-19&quot;, 
       fill = &quot;&quot;) +
  theme_minimal()</code></pre>
<p><img src="/post/es/2020-06-06-una-muy-breve-introduccion-a-tidyverse/index.es_files/figure-html/unnamed-chunk-22-1.png" width="2100" /></p>
</div>
<div id="heatmap" class="section level3">
<h3><span class="header-section-number">4.5.3</span> Heatmap</h3>
<p>Para visualizar la tendencia de todos los países europeos es recomendable usar un <em>heatmap</em> en lugar de un bulto de líneas. Antes de constuir el gráfico, creamos un vector de fechas para las etiquetas con los domingos en el período de registros.</p>
<pre class="r"><code># secuencia de fechas
df &lt;- data.frame(d = seq(ymd(&quot;2020-02-15&quot;), ymd(&quot;2020-06-07&quot;), &quot;day&quot;))

# filtramos los domingos creando el día de la semana
sundays &lt;- df %&gt;% 
            mutate(wd = wday(d, week_start = 1)) %&gt;% 
             filter(wd == 7) %&gt;% 
              pull(d)</code></pre>
<p>Si queremos usar etiquetas en otras lenguas, es necesario cambiar la configuración regional del sistema.</p>
<pre class="r"><code>Sys.setlocale(&quot;LC_TIME&quot;, &quot;English&quot;)</code></pre>
<pre><code>## [1] &quot;English_United States.1252&quot;</code></pre>
<p>El relleno de color para los boxplots lo dibujamos por cada región de los países europeos. Podemos fijar el tipo de color con <code>scale_fill_*</code>, en este caso, de las gamas <em>viridis</em>.<br />
Además, la función <code>guides()</code> nos permite modificar la barra de color de la leyenda. Por último, aquí vemos el uso de <code>theme()</code> con cambios adicionales a <code>theme_minimal()</code>.</p>
<pre class="r"><code># headmap
ggplot(subset_europe, 
       aes(date, region, fill = resi_real)) +
  geom_tile() +
  scale_x_date(breaks = sundays,
               date_labels = &quot;%d %b&quot;) +
  scale_fill_viridis_c(option = &quot;A&quot;, 
                       breaks = c(91, 146),
                       labels = c(&quot;Less&quot;, &quot;More&quot;), 
                       direction = -1) +
  theme_minimal() +
  theme(legend.position = &quot;top&quot;, 
        title = element_text(size = 14),
        panel.grid.major.x = element_line(colour = &quot;white&quot;, linetype = &quot;dashed&quot;),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.ontop = TRUE,
        plot.margin = margin(r = 1, unit = &quot;cm&quot;)) +
  labs(y = &quot;&quot;, 
       x = &quot;&quot;, 
       fill = &quot;&quot;, 
       title = &quot;Mobility trends for places of residence&quot;,
       caption = &quot;Data: google.com/covid19/mobility/&quot;) +
  guides(fill = guide_colorbar(barwidth = 10, 
                               barheight = .5,
                               label.position = &quot;top&quot;, 
                               ticks = FALSE)) +
  coord_cartesian(expand = FALSE)</code></pre>
<p><img src="/post/es/2020-06-06-una-muy-breve-introduccion-a-tidyverse/index.es_files/figure-html/unnamed-chunk-25-1.png" width="3675" /></p>
</div>
</div>
<div id="aplicar-funciones-sobre-vectores-o-listas" class="section level2">
<h2><span class="header-section-number">4.6</span> Aplicar funciones sobre vectores o listas</h2>
<p>El paquete <code>purrr</code> contiene un conjunto de funciones avanzadas de programación funcional para trabajar con funciones y vectores. La familia de funciones <code>lapply()</code> conocido de <code>R Base</code>corresponde a las funciones de <code>map()</code> en este paquete. Una de las mayores ventajas es poder reducir el uso de bucles (<code>for</code>, etc.).</p>
<pre class="r"><code># lista con dos vectores
vec_list &lt;- list(x = 1:10, y = 50:70)

# calculamos el promedio para cada uno
map(vec_list, mean)</code></pre>
<pre><code>## $x
## [1] 5.5
## 
## $y
## [1] 60</code></pre>
<pre class="r"><code># podemos cambiar tipo de salida map_* (dbl, chr, lgl, etc.)
map_dbl(vec_list, mean)</code></pre>
<pre><code>##    x    y 
##  5.5 60.0</code></pre>
<p>Un ejemplo más complejo. Calculamos el coeficiente de correlación entre la movilidad residencial y la de los parques en todos los países europeos. Para obtener un resumen <em>tidy</em> de un modelo o un test usamos la función <code>tidy()</code> del paquete <code>broom</code>.</p>
<pre class="r"><code>library(broom) # tidy outputs

# función adaptada 
cor_test &lt;- function(x, formula) { 
  
df &lt;- cor.test(as.formula(formula), data = x) %&gt;% tidy()

return(df)
  
}

# preparamos los datos
europe_reg &lt;- filter(google_mobility, 
                           !is.na(sub_region_1),
                           !is.na(residential_percent_change_from_baseline)) %&gt;%
                     left_join(wld, by = c(&quot;country_region_code&quot;=&quot;iso_a2&quot;)) %&gt;% 
                     filter(subregion %in% c(&quot;Northern Europe&quot;,
                                         &quot;Southern Europe&quot;,
                                          &quot;Western Europe&quot;,
                                          &quot;Eastern Europe&quot;))
# aplicamos la función a cada país creando una lista
europe_reg %&gt;%
  split(.$country_region_code) %&gt;% 
  map(cor_test, formula = &quot;~ residential_percent_change_from_baseline + parks_percent_change_from_baseline&quot;)  </code></pre>
<pre><code>## $AT
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.360     -12.3 2.68e-32      1009   -0.413    -0.305 Pearson&#39;~ two.sided  
## 
## $BE
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.312     -6.06  3.67e-9       340   -0.405    -0.213 Pearson&#39;~ two.sided  
## 
## $BG
## # A tibble: 1 x 8
##   estimate statistic   p.value parameter conf.low conf.high method   alternative
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      
## 1   -0.677     -37.8 1.47e-227      1694   -0.702    -0.650 Pearson~ two.sided  
## 
## $CH
## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method     alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
## 1  -0.0786     -2.91 0.00370      1360   -0.131   -0.0256 Pearson&#39;s~ two.sided  
## 
## $CZ
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1  -0.0837     -3.35 0.000824      1593   -0.132   -0.0347 Pearson&#39;~ two.sided  
## 
## $DE
## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method     alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
## 1  0.00239     0.102   0.919      1814  -0.0436    0.0484 Pearson&#39;s~ two.sided  
## 
## $DK
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1    0.237      5.81  1.04e-8       567    0.158     0.313 Pearson&#39;~ two.sided  
## 
## $EE
## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method     alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
## 1   -0.235     -2.88 0.00462       142   -0.384   -0.0740 Pearson&#39;s~ two.sided  
## 
## $ES
## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method     alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
## 1   -0.825     -65.4       0      2005   -0.839    -0.811 Pearson&#39;s~ two.sided  
## 
## $FI
## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method     alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
## 1   0.0427      1.42   0.155      1106  -0.0162     0.101 Pearson&#39;s~ two.sided  
## 
## $FR
## # A tibble: 1 x 8
##   estimate statistic   p.value parameter conf.low conf.high method   alternative
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      
## 1   -0.698     -37.4 3.29e-216      1474   -0.723    -0.671 Pearson~ two.sided  
## 
## $GB
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.105     -11.0 9.19e-28     10712   -0.124   -0.0865 Pearson&#39;~ two.sided  
## 
## $GR
## # A tibble: 1 x 8
##   estimate statistic   p.value parameter conf.low conf.high method   alternative
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      
## 1   -0.692     -27.0 1.03e-114       796   -0.726    -0.654 Pearson~ two.sided  
## 
## $HR
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.579     -21.9 9.32e-87       954   -0.620    -0.536 Pearson&#39;~ two.sided  
## 
## $HU
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.342     -15.6 6.71e-52      1843   -0.382    -0.301 Pearson&#39;~ two.sided  
## 
## $IE
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.222     -8.45 7.49e-17      1378   -0.271    -0.171 Pearson&#39;~ two.sided  
## 
## $IT
## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method     alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
## 1   -0.831     -71.0       0      2250   -0.844    -0.818 Pearson&#39;s~ two.sided  
## 
## $LT
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.204     -5.45  7.17e-8       686   -0.274    -0.131 Pearson&#39;~ two.sided  
## 
## $LV
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.544     -6.87 3.84e-10       112   -0.662    -0.401 Pearson&#39;~ two.sided  
## 
## $NL
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1    0.143      5.31  1.25e-7      1356   0.0903     0.195 Pearson&#39;~ two.sided  
## 
## $NO
## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method     alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
## 1   0.0483      1.69  0.0911      1221 -0.00774     0.104 Pearson&#39;s~ two.sided  
## 
## $PL
## # A tibble: 1 x 8
##   estimate statistic   p.value parameter conf.low conf.high method   alternative
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      
## 1   -0.531     -26.7 6.08e-133      1815   -0.564    -0.498 Pearson~ two.sided  
## 
## $PT
## # A tibble: 1 x 8
##   estimate statistic   p.value parameter conf.low conf.high method   alternative
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      
## 1   -0.729     -46.9 2.12e-321      1938   -0.749    -0.707 Pearson~ two.sided  
## 
## $RO
## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method     alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
## 1   -0.640     -56.0       0      4517   -0.657    -0.623 Pearson&#39;s~ two.sided  
## 
## $SE
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1    0.106      3.93  9.09e-5      1367   0.0529     0.158 Pearson&#39;~ two.sided  
## 
## $SI
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.627     -11.4 1.98e-23       200   -0.704    -0.535 Pearson&#39;~ two.sided  
## 
## $SK
## # A tibble: 1 x 8
##   estimate statistic  p.value parameter conf.low conf.high method    alternative
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
## 1   -0.196     -5.70  1.65e-8       810   -0.262    -0.129 Pearson&#39;~ two.sided</code></pre>
<p>Como ya hemos visto anteriormente, existen subfunciones de <code>map_*</code> para obtener en lugar de una lista un objeto de otra clase, aquí de <code>data.frame</code>.</p>
<pre class="r"><code>cor_mobility &lt;- europe_reg %&gt;%
                  split(.$country_region_code) %&gt;% 
                     map_df(cor_test, 
                            formula = &quot;~ residential_percent_change_from_baseline + parks_percent_change_from_baseline&quot;, 
                            .id = &quot;country_code&quot;)

arrange(cor_mobility, estimate)</code></pre>
<pre><code>## # A tibble: 27 x 9
##    country_code estimate statistic   p.value parameter conf.low conf.high method
##    &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
##  1 IT             -0.831    -71.0  0.             2250   -0.844    -0.818 Pears~
##  2 ES             -0.825    -65.4  0.             2005   -0.839    -0.811 Pears~
##  3 PT             -0.729    -46.9  2.12e-321      1938   -0.749    -0.707 Pears~
##  4 FR             -0.698    -37.4  3.29e-216      1474   -0.723    -0.671 Pears~
##  5 GR             -0.692    -27.0  1.03e-114       796   -0.726    -0.654 Pears~
##  6 BG             -0.677    -37.8  1.47e-227      1694   -0.702    -0.650 Pears~
##  7 RO             -0.640    -56.0  0.             4517   -0.657    -0.623 Pears~
##  8 SI             -0.627    -11.4  1.98e- 23       200   -0.704    -0.535 Pears~
##  9 HR             -0.579    -21.9  9.32e- 87       954   -0.620    -0.536 Pears~
## 10 LV             -0.544     -6.87 3.84e- 10       112   -0.662    -0.401 Pears~
## # ... with 17 more rows, and 1 more variable: alternative &lt;chr&gt;</code></pre>
<p>Otros ejemplos prácticos aquí en este <a href="https://dominicroye.github.io/es/2019/importar-varias-hojas-excel-en-r/">post</a> or este <a href="https://dominicroye.github.io/en/2019/tidy-correlation-tests-in-r/">otro</a>. Podemos encontrar más detalles en el <a href="https://github.com/rstudio/cheatsheets/raw/master/purrr.pdf">Cheat-Sheet</a> de <code>purrr</code>.</p>
</div>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/es/tags/introducci%C3%B3n/">introducción</a>
  
  <a class="badge badge-light" href="/es/tags/visualizaci%C3%B3n/">visualización</a>
  
  <a class="badge badge-light" href="/es/tags/gesti%C3%B3n/">gestión</a>
  
  <a class="badge badge-light" href="/es/tags/datos/">datos</a>
  
  <a class="badge badge-light" href="/es/tags/covid-19/">COVID-19</a>
  
</div>



    






<div class="media author-card" itemscope itemtype="http://schema.org/Person">
  
  <img class="portrait mr-3" src="/img/potrai_domi.jpg" itemprop="image" alt="Avatar">
  
  <div class="media-body">
    <h5 class="card-title" itemprop="name"><a href="/es">Dr. Dominic Royé</a></h5>
    
    
    <ul class="network-icon" aria-hidden="true">
      
      
      
      
      
      
      
      
      <li>
        <a itemprop="sameAs" href="mailto:dominic.roye@usc.es" >
          <i class="fa fa-envelope"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="//twitter.com/dr_xeo" >
          <i class="fab fa-twitter"></i>
        </a>
      </li>
      
      
      
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://www.researchgate.net/profile/Dominic_Roye" target="_blank" rel="noopener">
          <i class="ai ai-researchgate"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="//github.com/dominicroye" >
          <i class="fab fa-github"></i>
        </a>
      </li>
      
    </ul>
  </div>
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Relacionado</h3>
      <ul>
        
        <li><a href="/es/2018/el-gr%C3%A1fico-de-tarta/">El gráfico de tarta</a></li>
        
        <li><a href="/es/publication/manual_rgis_2019/">Introducción a los SIG con R</a></li>
        
        <li><a href="/es/graphs/population/">Populación</a></li>
        
        <li><a href="/es/graphs/geography/">Geografía</a></li>
        
        <li><a href="/es/graphs/environment/">Medio ambiente</a></li>
        
      </ul>
    </div>
    

    
    <div class="article-widget">
      <div class="post-nav">
  
  <div class="post-nav-item">
    <div class="meta-nav">Siguiente</div>
    <a href="/es/2020/direcciones-del-flujo-fluvial/" rel="next">Direcciones del flujo fluvial</a>
  </div>
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Anterior</div>
    <a href="/es/2020/visualizar-anomal%C3%ADas-clim%C3%A1ticas/" rel="prev">Visualizar anomalías climáticas</a>
  </div>
  
</div>

    </div>
    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-dominicroye-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<div class="container">
  <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2018-2020 Dominic Royé. All rights reserved. &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Citar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copiar
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Descargar
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    
    <script id="dsq-count-scr" src="//https-dominicroye-github-io.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    <script src="/js/academic.min.d037ee5294b166a79dec317c58aea9cc.js"></script>

    

  </body>
</html>

