<!DOCTYPE html><html lang="es-ES" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  
  









  




  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Dr. Dominic Royé" />

  
  
  
    
  
  <meta name="description" content="En este post enseñaré cómo podemos descargar y trabajar directamente con datos provinientes de los reanálisis climáticos en R. Se trata de sistemas de asimilación de datos que combinan modelos de pronóstico meteorológico y observaciones de distintas fuentes de forma objetiva con el fin de sintetizar el estado actual y la evolución de multiples variables de la atmósfera, la superficie de la tierra y los océanos." />

  
  <link rel="alternate" hreflang="es-ES" href="https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.b48d89910a3f8560bb2d78fedea8d682.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-27463794-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-27463794-2', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/es/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu27cb63416a395b8c8d0d7112b85e26a9_17299_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu27cb63416a395b8c8d0d7112b85e26a9_17299_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@@dr_xeo" />
    <meta property="twitter:creator" content="@@dr_xeo" />
  
  <meta property="og:site_name" content="Dr. Dominic Royé" />
  <meta property="og:url" content="https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/" />
  <meta property="og:title" content="Acceso a datos de los reanálisis climáticos desde R | Dr. Dominic Royé" />
  <meta property="og:description" content="En este post enseñaré cómo podemos descargar y trabajar directamente con datos provinientes de los reanálisis climáticos en R. Se trata de sistemas de asimilación de datos que combinan modelos de pronóstico meteorológico y observaciones de distintas fuentes de forma objetiva con el fin de sintetizar el estado actual y la evolución de multiples variables de la atmósfera, la superficie de la tierra y los océanos." /><meta property="og:image" content="https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/featured.png" />
    <meta property="twitter:image" content="https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/featured.png" /><meta property="og:locale" content="es-ES" />
  
    
      <meta
        property="article:published_time"
        content="2018-09-15T10:59:44&#43;01:00"
      />
    
    <meta property="article:modified_time" content="2018-09-15T10:59:44&#43;01:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/"
  },
  "headline": "Acceso a datos de los reanálisis climáticos desde R",
  
  "image": [
    "https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/featured.png"
  ],
  
  "datePublished": "2018-09-15T10:59:44+01:00",
  "dateModified": "2018-09-15T10:59:44+01:00",
  
  "author": {
    "@type": "Person",
    "name": "Dr. Dominic Royé"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "University of Santiago de Compostela",
    "logo": {
      "@type": "ImageObject",
      "url": "https://dominicroye.github.io/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_192x192_fit_lanczos_3.png"
    }
  },
  "description": "En este post enseñaré cómo podemos descargar y trabajar directamente con datos provinientes de los reanálisis climáticos en R. Se trata de sistemas de asimilación de datos que combinan modelos de pronóstico meteorológico y observaciones de distintas fuentes de forma objetiva con el fin de sintetizar el estado actual y la evolución de multiples variables de la atmósfera, la superficie de la tierra y los océanos."
}
</script>

  

  

  

  





  <title>Acceso a datos de los reanálisis climáticos desde R | Dr. Dominic Royé</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="b8f9c2ee950e35ea3898cf650edb0066" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.2da3b1fa37e894630bf6de39b1b694b3.js"></script>

  




  <div class="page-header">
    







 



  


<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/es/"><img src="/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_0x70_resize_lanczos_3.png" alt="Dr. Dominic Royé"
            
            >
             <div style = "padding-top:0.5em;">Dr. Dominic Royé</div></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Barra de navegación">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/es/"><img src="/media/logo_hu6637600e1c36fe7812a10a6623aaebda_116520_0x70_resize_lanczos_3.png" alt="Dr. Dominic Royé"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          

          

          
          
          
          

          
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#"><span>inicio</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#posts"><span>blog</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#featured"><span>publicaciones</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#projects"><span>gráficos</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/es/#about"><span>mí</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/dr_xeo" data-toggle="tooltip" data-placement="bottom" title="Sígueme en Twitter" target="_blank" rel="noopener" aria-label="Sígueme en Twitter">
                <i class="fab fa-twitter" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        

        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Acceso a datos de los reanálisis climáticos desde R</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    2018-09-15
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min de lectura
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/es/category/r/">R</a>, <a href="/es/category/rintermedio/">R:intermedio</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 572px;">
  <div style="position: relative">
    <img src="/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/featured_hubf5f1f4c663823de4fface96a92fe838_257097_720x0_resize_lanczos_3.png" width="720" height="572" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/index.es_files/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#introducción"><span class="toc-section-number">1</span> Introducción</a></li>
<li><a href="#ncep"><span class="toc-section-number">2</span> NCEP</a>
<ul>
<li><a href="#paquetes"><span class="toc-section-number">2.1</span> Paquetes</a></li>
<li><a href="#descarga-de-datos"><span class="toc-section-number">2.2</span> Descarga de datos</a></li>
<li><a href="#promedio-mensual"><span class="toc-section-number">2.3</span> Promedio mensual</a></li>
<li><a href="#visualización"><span class="toc-section-number">2.4</span> Visualización</a></li>
</ul></li>
<li><a href="#era-interim"><span class="toc-section-number">3</span> ERA-Interim</a>
<ul>
<li><a href="#instalación"><span class="toc-section-number">3.1</span> Instalación</a></li>
<li><a href="#conexión-y-descarga-con-la-ecmwf-api"><span class="toc-section-number">3.2</span> Conexión y descarga con la ECMWF API</a></li>
<li><a href="#procesar-ncdf"><span class="toc-section-number">3.3</span> Procesar ncdf</a></li>
</ul></li>
<li><a href="#actualización-para-acceder-era-5"><span class="toc-section-number">4</span> Actualización para acceder ERA-5</a></li>
</ul>
</div>

<p><em>Un amigo me propuso que presentara los niveles de aprendizaje de R como categorías. Una idea que ahora introduzco para cada entrada del blog. Hay tres niveles: elemental, intermedio y avanzado. Espero que ayude al lector y al usuario R.</em></p>
<hr />
<div id="introducción" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introducción</h1>
<p>En este post enseñaré cómo podemos descargar y trabajar directamente con datos provenientes de los reanálisis climáticos en R. Se trata de sistemas de asimilación de datos que combinan modelos de pronóstico meteorológico y observaciones de distintas fuentes de forma objetiva con el fin de sintetizar el estado actual y la evolución de multiples variables de la atmósfera, la superficie de la tierra y los océanos. Los dos reanálisis más usados son <a href="https://climatedataguide.ucar.edu/climate-data/ncep-reanalysis-r2">NCEP-DO</a> (Reanalysis II) de la <em>NOAA/OAR/ESRL</em>, una versión mejorada de <em>NCEP-NCAR</em> (Reanalysis I), y <em>ERA-Interim</em> del <a href="https://www.ecmwf.int/en/research/climate-reanalysis">ECMWF</a>. Dado que <em>NCEP-DO</em> es de la primera generacióm, se recomienda usar reanálisis de tercera generación, especialmente <em>ERA-Interim</em>. Una visión general de los actuales reanálisis atmosféricos la podemos encontrar <a href="https://reanalyses.org/index.php/atmosphere/overview-current-atmospheric-reanalyses">aquí</a>. Primero vamos a ver cómo acceder a los datos del <em>NCEP</em> a través de un paquete de R en <em>CRAN</em> que facilita la descarga y el manejo de los datos. Después haremos lo mismo con <em>ERA-Interim</em>, no obstante, para acceder a este último dataset de reanálisis es necesario usar <em>python</em> y la correspondiente API del <em>ECMWF</em>.</p>
</div>
<div id="ncep" class="section level1" number="2">
<h1><span class="header-section-number">2</span> NCEP</h1>
<p>Para acceder a los reanálisis del <em>NCEP</em> es necesario instalar el paquete correspondiente <em>RNCEP</em>. La función principal es <code>NCEP.gather( )</code>. La resolución del reanálisis del <em>NCEP</em> es de 2,5º X 2,5º.</p>
<div id="paquetes" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Paquetes</h2>
<pre class="r"><code>#instalamos los paquetes RNCEP, lubridate y tidyverse
if(!require(&quot;RNCEP&quot;)) install.packages(&quot;RNCEP&quot;)
if(!require(&quot;lubridate&quot;)) install.packages(&quot;lubridate&quot;)
if(!require(&quot;tidyverse&quot;)) install.packages(&quot;tidyverse&quot;)
if(!require(&quot;sf&quot;)) install.packages(&quot;sf&quot;)

#cargamos las librerías
library(RNCEP)
library(lubridate) #la necesitamos para manipular fechas
library(tidyverse) #para visualizar y manipular 
library(RColorBrewer) #colores para la visualización
library(sf) #para importar un shapefile y trabajar con geom_sf</code></pre>
</div>
<div id="descarga-de-datos" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Descarga de datos</h2>
<p>Descargaremos la temperatura del aire a la altura de 850haPa para el año 2016. Las variables y niveles de presión pueden ser consultados en los detalles de la función <code>?NCEP.gather</code>. El argumento <em>reanalysis2</em> nos permite descargar tanto la versión I como la versión II, siendo por defecto <em>FALSE</em>, o sea, se accede al reanálisis I. En todas las consultas obtendremos datos horarios de cada 6 horas (00:00, 06:00, 12:00 y 18:00). Esto supone un total de 1464 valores para el año 2016.</p>
<pre class="r"><code>#definimos los argumentos necesarios
month_range &lt;- c(1,12)     #período de meses
year_range &lt;- c(2016,2016) #período de años

lat_range &lt;- c(30,60)      #rango de latitud
lon_range &lt;- c(-30,50)     #rango de longitud
 

data &lt;- NCEP.gather(&quot;air&quot;,    #nombre de la variable
                    850, #altura 850hPa
                    month_range,year_range,
                    lat_range,lon_range,
                    return.units = TRUE,
                    reanalysis2=TRUE)</code></pre>
<pre><code>## [1] Units of variable &#39;air&#39; are degK
## [1] Units of variable &#39;air&#39; are degK</code></pre>
<pre class="r"><code>#dimensiones                     
dim(data) </code></pre>
<pre><code>## [1]   13   33 1464</code></pre>
<pre class="r"><code>#encontramos en dimnames( ) lon,lat y tiempo
#fechas y horas 
date_time &lt;- dimnames(data)[[3]]
date_time &lt;- ymd_h(date_time)
head(date_time)</code></pre>
<pre><code>## [1] &quot;2016-01-01 00:00:00 UTC&quot; &quot;2016-01-01 06:00:00 UTC&quot;
## [3] &quot;2016-01-01 12:00:00 UTC&quot; &quot;2016-01-01 18:00:00 UTC&quot;
## [5] &quot;2016-01-02 00:00:00 UTC&quot; &quot;2016-01-02 06:00:00 UTC&quot;</code></pre>
<pre class="r"><code>#longitud y latitud
lat &lt;- dimnames(data)[[1]]
lon &lt;- dimnames(data)[[2]]
head(lon);head(lat)</code></pre>
<pre><code>## [1] &quot;-30&quot;   &quot;-27.5&quot; &quot;-25&quot;   &quot;-22.5&quot; &quot;-20&quot;   &quot;-17.5&quot;</code></pre>
<pre><code>## [1] &quot;60&quot;   &quot;57.5&quot; &quot;55&quot;   &quot;52.5&quot; &quot;50&quot;   &quot;47.5&quot;</code></pre>
</div>
<div id="promedio-mensual" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Promedio mensual</h2>
<p>Vemos que se trata de un <em>array</em> de tres dimensiones con [lat,lon,tiempo]. Además, extraemos latitud, longitud y el tiempo. La temperatura está dada en Kelvin. El objetivo aquí será mostrar dos mapas comparando enero y julio de 2016.</p>
<pre class="r"><code>#creamos nuestra variable de agrupación 
group &lt;- month(date_time) 

#estimamos el promedio por mes de la temperatura
data_month &lt;- aperm(
  apply(
    data, #nuestros datos
    c(1,2), #aplicamos a cada serie temporal 1:fila, 2:columna la función mean( )
    by, #agrupar por 
    group, #meses como agrupación
    function(x)ifelse(all(is.na(x)),NA,mean(x))),
  c(2,3,1)) #reordenamos para obtener un array como el original

dim(data_month) #temperatura 850haP por mes enero a diciembre</code></pre>
<pre><code>## [1] 13 33 12</code></pre>
</div>
<div id="visualización" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Visualización</h2>
<p>Ahora, podemos visualizar con <em>ggplot2</em> la temperatura de enero y julio. En este ejemplo, uso <code>geom_sf( )</code> del paquetes <a href="https://github.com/r-spatial/sf"><em>sf</em></a>, que hace el trabajo más fácil para visualizar en <em>ggplot</em> objetos espaciales (en el futuro haré un post sobre sf y ggplot). En la dimensión de latitud y longitud vemos que únicamente nos indica para cada fila y columna un valor. Pero necesitamos las coordenadas de todas las celdas de la matriz. Para crear todas las combinaciones entre dos variables usamos la función <code>expand.grid( )</code>.</p>
<pre class="r"><code>#primero creamos todas las combinaciones de lonlat
lonlat &lt;- expand.grid(lon=lon,lat=lat)

#lonlat es carácter, ya que fue un nombre, por eso lo convertimos en númerico
lonlat &lt;- apply(lonlat,2,as.numeric)

#lon y lat no están en el orden como lo esperamos
#fila=lon; columna=lat
data_month &lt;- aperm(data_month,c(2,1,3))

#subtraemos 273.15K para convertir K a ºC.
df &lt;- data.frame(lonlat,
                 Ta01=as.vector(data_month[,,1])-273.15,
                 Ta07=as.vector(data_month[,,7])-273.15)</code></pre>
<p>Antes de visualizar los datos con <em>ggplot2</em>, tenemos que adpatar la tabla. El shapefile con los limites de los países se puede descargar <a href="/files/CNTR_RG_03M_2014.zip">aquí</a>.</p>
<pre class="r"><code>#convertimos la tabla ancha en una larga
df &lt;- gather(df,month,Ta,Ta01:Ta07)%&gt;%
             mutate(month=factor(month,unique(month),c(&quot;Jan&quot;,&quot;Jul&quot;)))

#importamos el limite de países
limit &lt;- st_read(&quot;CNTR_RG_03M_2014.shp&quot;)</code></pre>
<pre><code>## Reading layer `CNTR_RG_03M_2014&#39; from data source 
##   `E:\GitHub\blog_update_2021\content\es\post\2018-09-15-acceso-a-datos-de-los-reanalisis-desde-r\CNTR_RG_03M_2014.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 256 features and 3 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -180 ymin: -90 xmax: 180 ymax: 83.66068
## Geodetic CRS:  ETRS89</code></pre>
<pre class="r"><code>#gama de colores
colbr &lt;- brewer.pal(11,&quot;RdBu&quot;)

ggplot(df)+
      geom_tile(aes(lon,lat,fill=Ta))+ #temperatura
      geom_sf(data=limit,fill=NA,size=.5)+ #limite
        scale_fill_gradientn(colours=rev(colbr))+
          coord_sf(ylim=c(30,60),xlim=c(-30,50))+
          scale_x_continuous(breaks=seq(-30,50,10),expand=c(0,0))+
          scale_y_continuous(breaks=seq(30,60,5),expand=c(0,0))+
          labs(x=&quot;&quot;,y=&quot;&quot;,fill=&quot;Ta 850hPa (ºC)&quot;)+
           facet_grid(month~.)+ #mapa por mes
             theme_bw()</code></pre>
<p><img src="https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/index.es_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
<div id="era-interim" class="section level1" number="3">
<h1><span class="header-section-number">3</span> ERA-Interim</h1>
<p>El <em>ECMWF</em> ofrece acceso a sus bases de datos públicos a partir de una <a href="https://confluence.ecmwf.int//display/WEBAPI/Access+ECMWF+Public+Datasets"><em>pyhton-API</em></a>. Es necesario estar registrado en la web del <em>ECMWF</em>. Se puede darse de alta <a href="https://apps.ecmwf.int/registration/">aquí</a>. Al tratarse de otro lenguaje de programación, en R debemos usar un interfaz entre ambos lo que nos permite el paquete <a href="https://github.com/rstudio/reticulate"><em>reticulate</em></a>. También debemos que tener instalada una distribución de pyhton (versión 2.x o 3.x). En el caso de Windows podemos usar <a href="https://www.anaconda.com/download/">anaconda</a>.</p>
<p><div class="alert alert-note">
  <div>
    Recientemente se ha publicado un nuevo paquete <code>ecmwfr</code> que facilita el acceso a los APIs de Copernicus y ECMWF. La gran ventaja es que no hace falta instalar <code>python</code>. Más detalles <a href="https://github.com/khufkens/ecmwfr">aquí</a>. En 2022 publiqué un nuevo post actualizado.
  </div>
</div>
</p>
<div id="instalación" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Instalación</h2>
<pre class="r"><code>if(!require(&quot;reticulate&quot;)) install.packages(&quot;reticulate&quot;)
if(!require(&quot;ncdf4&quot;)) install.packages(&quot;ncdf4&quot;) #para manejar formato netCDF

#cargamos las librerías
library(reticulate)
library(ncdf4)</code></pre>
<p>Una vez que tenemos instalado <em>anaconda</em> y el paquete <em>reticulate</em>, podemos instalar el paquete <em>python ecmwfapi</em>. La instalación la podemos llevar a cabo, o bien através del CMD de Windows usando el comando <em>conda install -c conda-forge ecmwf-api-client</em>, o bien con la función <code>py_install( )</code> del paquete <em>reticulate</em>. La misma función permite instalar cualquier librería <em>python</em> desde R.</p>
<pre class="r"><code>#instalamos la API ECMWF
py_install(&quot;ecmwf-api-client&quot;)</code></pre>
</div>
<div id="conexión-y-descarga-con-la-ecmwf-api" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Conexión y descarga con la ECMWF API</h2>
<p>Para poder acceder a la API es requisito crear un archivo con la información del usuario.</p>
<p>El archivo “.ecmwfapirc” debe contener la siguiente información:</p>
<pre><code>{
    &quot;url&quot;   : &quot;https://api.ecmwf.int/v1&quot;,
    &quot;key&quot;   : &quot;XXXXXXXXXXXXXXXXXXXXXX&quot;,
    &quot;email&quot; : &quot;john.smith@example.com&quot;
}</code></pre>
<p>La clave podemos obtenerla con la cuenta de usuario <a href="https://api.ecmwf.int/v1/key/">aquí</a>.</p>
<p>El archivo se puede crear con el bloc de notas de Windows.</p>
<ol style="list-style-type: decimal">
<li>Creamos un documento “ecmwfapirc.txt”.</li>
<li>Renombramos este archivo a “.ecmwfapirc.”</li>
</ol>
<p>El último punto desaparece de forma automática. Después guardamos este archivo en “C:/USERNAME/.ecmwfapirc” o “C:/USERNAME/Documents/.ecmwfapirc”.</p>
<pre class="r"><code>#importamos la librería python ecmwfapi
ecmwf &lt;- import(&#39;ecmwfapi&#39;)

#en este paso debe existir el archivo .ecmwfapirc
server = ecmwf$ECMWFDataServer() #iniciamos la conexión</code></pre>
<p>Llegados a este punto, ¿cómo creamos una consulta? Lo más fácil es ir a la web del <a href="http://apps.ecmwf.int/datasets/data/interim-full-daily/levtype=sfc/"><em>ECMWF</em></a> dónde elegimos la base de datos, en este caso <em>ERA-Interim</em> en superficie, para crear un script con todos los datos necesarios. Más detalles sobre la sintaxis podemos encontrar <a href="https://confluence.ecmwf.int/display/WEBAPI/Brief+request+syntax">aquí</a>. Cuando procedemos en la web sólamente tenemos que hacer click en “View MARS Request”. Este paso nos lleva al script en <em>python</em>.</p>
<p><img src="erainterim1.png" /></p>
<p><img src="erainterim2.png" /></p>
<p>Con la sintaxis del script que nos da la <em>MARS Request</em> podemos crear la consulta en R.</p>
<pre class="r"><code>#creamos la consulta
query &lt;-r_to_py(list(
  class=&#39;ei&#39;,
  dataset= &quot;interim&quot;, #base de datos
  date= &quot;2017-01-01/to/2017-12-31&quot;, #periodo 
  expver= &quot;1&quot;,
  grid= &quot;0.125/0.125&quot;, #resolución
  levtype=&quot;sfc&quot;,
  param= &quot;167.128&quot;, # temperatura del aire (2m)
  area=&quot;45/-10/30/5&quot;, #N/W/S/E
  step= &quot;0&quot;,
  stream=&quot;oper&quot;,
  time=&quot;00:00:00/06:00:00/12:00:00/18:00:00&quot;, #paso de tiempo
  type=&quot;an&quot;,
  format= &quot;netcdf&quot;, #formato
  target=&#39;ta2017.nc&#39; #nombre del archivo
))

server$retrieve(query)</code></pre>
<p>El resultado es un archivo netCDF que podemos processar con el paquete <em>ncdf4</em>.</p>
</div>
<div id="procesar-ncdf" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Procesar ncdf</h2>
<p>A partir de aquí, el objetivo será la extracción de una serie temporal de una coordenada más próxima a una dada. Usaremos las coordenadas de Madrid (40.418889, -3.691944).</p>
<pre class="r"><code>#cargamos las librerías 
library(sf)
library(ncdf4)
library(tidyverse)</code></pre>
<pre class="r"><code>#abrimos la conexión con el archivo
nc &lt;- nc_open(&quot;ta2017.nc&quot;)

#extraemos lon y lat
lat &lt;- ncvar_get(nc,&#39;latitude&#39;)
lon &lt;- ncvar_get(nc,&#39;longitude&#39;)
dim(lat);dim(lon)

#extraemos el tiempo
t &lt;- ncvar_get(nc, &quot;time&quot;)

#unidad del tiempo: horas desde 1900-01-01
ncatt_get(nc,&#39;time&#39;)

#convertimos las horas en fecha+hora 
#as_datetime de lubridate espera segundos
timestamp &lt;- as_datetime(c(t*60*60),origin=&quot;1900-01-01&quot;)

#importamos los datos
data &lt;- ncvar_get(nc,&quot;t2m&quot;)

#cerramos la conexión
nc_close(nc)</code></pre>
<p>Más detalles se pueden consultar en este breve manual sobre cómo trabajar con netCDF <a href="https://dominicroye.github.io/en/publication/ncdf_2015/">aqui</a>. En esta próxima sección hacemos uso del paquete <em>sf</em> la cuál está sustituyendo las más conocidas <em>sp</em> y <em>rgdal</em>.</p>
<pre class="r"><code>#creamos todas las combinaciones
lonlat &lt;- expand.grid(lon=lon,lat=lat)

#debemos convertir las coordenadas en objeto espacial sf
#además indicamos el sistema de coordenadas en codigo EPSG
coord &lt;- st_as_sf(lonlat,coords=c(&quot;lon&quot;,&quot;lat&quot;))%&gt;%
                    st_set_crs(4326)

#lo mismo hacemos con nuestra coordenada de Madrid
psj &lt;- st_point(c(-3.691944,40.418889))%&gt;%
                   st_sfc()%&gt;%
                     st_set_crs(4326)

#plot de los puntos
plot(st_geometry(coord))
plot(psj,add=TRUE,pch = 3, col = &#39;red&#39;)</code></pre>
<p>En los próximos pasos calculamos la distancia de nuestro punto de referencia a todos los puntos del grid. Posteriormente, buscamos aquel con menos distancia.</p>
<pre class="r"><code>#añadimos la distancia a los puntos
coord &lt;- mutate(coord,dist=st_distance(coord,psj))

#creamos una matrix de distancia con las mismas dimensiones que nuestros datos
dist_mat &lt;- matrix(coord$dist,dim(data)[-3])

#la función arrayInd es útil para obtener los índices fila y columna en este caso
mat_index &lt;- as.vector(arrayInd(which.min(dist_mat), dim(dist_mat)))

#extraemos la serie temporal y cambiamos la unidad de K a ºC
#convertimos el tiempo en fecha + hora
df &lt;- data.frame(ta=data[mat_index[1],mat_index[2],],time=timestamp)%&gt;%
        mutate(ta=ta-273.15,time=ymd_hms(time))</code></pre>
<p>Para terminar, visualizamos nuestra serie temporal.</p>
<pre class="r"><code>ggplot(df,
       aes(time,ta))+
    geom_line()+
    labs(y=&quot;Temperatura (ºC)&quot;,
             x=&quot;&quot;)+
    theme_bw()</code></pre>
</div>
</div>
<div id="actualización-para-acceder-era-5" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Actualización para acceder ERA-5</h1>
<p>Recientemente el nuevo reanálisis ERA-5 con <a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels?tab=overview"><em>single level</em></a> o <a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-pressure-levels?tab=overview"><em>pressure level</em></a> fue puesto a disposición de los usarios. Es la quinta generación del European Centre for Medium-Range Weather Forecasts (ECMWF) y accesible a través de una nueva API de Copernicus. El nuevo reanálisis ERA-5 tiene una cobertura temporal desde 1950 hasta la actualidad a una resolución horizontal de 30km a nivel mundial, con 137 niveles desde la superficie hasta una altura de 80km. Una diferencia importante con respecto al ERA-Interim anterior es la resolución temporal con datos horarios.</p>
<p>El acceso cambia a la infrastructura de Climate Data Store (CDS) con su propia API. Es posible descargar directamente desde la página o usando la Python API en una forma similar a la ya presentada en este post. Sin embargo, existen ligeras diferencias que voy a explicar a continuación.</p>
<ol style="list-style-type: decimal">
<li>Es necesario tener una cuenta en CDS de Copernicus <a href="https://cds.climate.copernicus.eu/user/register">link</a></li>
<li>Nuevamente, hace falta una clave <a href="https://cds.climate.copernicus.eu/api-how-to">link</a></li>
<li>Cambia la librería de Python y algo los argumentos en la consulta.</li>
</ol>
<pre class="r"><code>#cargamos las librerías 
library(sf)
library(ncdf4)
library(tidyverse)
library(reticulate)

#instalamos la CDS API
conda_install(&quot;r-reticulate&quot;,&quot;cdsapi&quot;,pip=TRUE)</code></pre>
<p>Para poder acceder a la API un requisito es crear un archivo con la información del usuario.</p>
<p>El archivo “.cdsapirc” debe contener la siguiente información:</p>
<pre><code>
url: https://cds.climate.copernicus.eu/api/v2
key: {uid}:{api-key}
</code></pre>
<p>La clave la podemos obtener con la cuenta de usuario en el <em>User profile</em>.</p>
<p>El archivo se puede crear con el bloc de notas de Windows del mismo modo como ha sido explicado para ERA-Interim.</p>
<pre class="r"><code>#importamos la librería python CDS
cdsapi &lt;- import(&#39;cdsapi&#39;)

#en este paso debe existir el archivo .cdsapirc
server = cdsapi$Client() #iniciamos la conexión</code></pre>
<p>Con la sintaxis del script que nos da la <em>Show API request</em> podemos crear la consulta en R.</p>
<pre class="r"><code>#creamos la consulta
query &lt;- r_to_py(list(
    variable= &quot;2m_temperature&quot;,
    product_type= &quot;reanalysis&quot;,
    year= &quot;2018&quot;,
    month= &quot;07&quot;, #formato: &quot;01&quot;,&quot;01&quot;, etc.
    day= str_pad(1:31,2,&quot;left&quot;,&quot;0&quot;),   
    time= str_c(0:23,&quot;00&quot;,sep=&quot;:&quot;)%&gt;%str_pad(5,&quot;left&quot;,&quot;0&quot;),
    format= &quot;netcdf&quot;,
    area = &quot;45/-20/35/5&quot; # North, West, South, East
  ))

server$retrieve(&quot;reanalysis-era5-single-levels&quot;,
                  query,
                 &quot;era5_ta_2018.nc&quot;)</code></pre>
<p>Es posible que la primera vez se reciba un mensaje de error, dado que todavía no se han aceptado los términos y las condiciones requeridas. Únicamente se debe seguir el enlace indicado.</p>
<pre><code>Error in py_call_impl(callable, dots$args, dots$keywords) : 
  Exception: Client has not agreed to the required terms and conditions.. To access this resource, you first need to accept the termsof &#39;Licence to Use Copernicus Products&#39; at https://cds.climate.copernicus.eu/cdsapp/#!/terms/licence-to-use-copernicus-products</code></pre>
<p>A partir de aquí podemos seguir los mismos pasos como los hechos con ERA-Interim.</p>
<pre class="r"><code>#abrimos la conexión con el archivo
nc &lt;- nc_open(&quot;era5_ta_2018.nc&quot;)

#extraemos lon y lat
lat &lt;- ncvar_get(nc,&#39;latitude&#39;)
lon &lt;- ncvar_get(nc,&#39;longitude&#39;)
dim(lat);dim(lon)

#extraemos el tiempo
t &lt;- ncvar_get(nc, &quot;time&quot;)

#unidad del tiempo: horas desde 1900-01-01
ncatt_get(nc,&#39;time&#39;)

#convertimos las horas en fecha+hora 
#as_datetime de lubridate espera segundos
timestamp &lt;- as_datetime(c(t*60*60),origin=&quot;1900-01-01&quot;)

#temperatura en K de julio 2018
head(timestamp)

#importamos los datos
data &lt;- ncvar_get(nc,&quot;t2m&quot;)

#plot
filled.contour(data[,,1])

plot(data.frame(date=timestamp,ta=data[1,5,]),
     type=&quot;l&quot;)

#cerramos la conexión
nc_close(nc)</code></pre>
<p><a href="https://www.buymeacoffee.com/drxeo" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/default-orange.png" alt="Buy Me A Coffee" height="41" width="174"></a></p>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/es/tag/reanalisis/">reanalisis</a>
  
  <a class="badge badge-light" href="/es/tag/interim/">interim</a>
  
  <a class="badge badge-light" href="/es/tag/ncep/ncar/">NCEP/NCAR</a>
  
  <a class="badge badge-light" href="/es/tag/era/">era</a>
  
  <a class="badge badge-light" href="/es/tag/descarga/">descarga</a>
  
  <a class="badge badge-light" href="/es/tag/ncdf/">ncdf</a>
  
  <a class="badge badge-light" href="/es/tag/acceso/">acceso</a>
  
  <a class="badge badge-light" href="/es/tag/api/">api</a>
  
  <a class="badge badge-light" href="/es/tag/python/">python</a>
  
  <a class="badge badge-light" href="/es/tag/ecmwf/">ECMWF</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/&amp;text=Acceso%20a%20datos%20de%20los%20rean%c3%a1lisis%20clim%c3%a1ticos%20desde%20R" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/&amp;t=Acceso%20a%20datos%20de%20los%20rean%c3%a1lisis%20clim%c3%a1ticos%20desde%20R" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Acceso%20a%20datos%20de%20los%20rean%c3%a1lisis%20clim%c3%a1ticos%20desde%20R&amp;body=https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/&amp;title=Acceso%20a%20datos%20de%20los%20rean%c3%a1lisis%20clim%c3%a1ticos%20desde%20R" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Acceso%20a%20datos%20de%20los%20rean%c3%a1lisis%20clim%c3%a1ticos%20desde%20R%20https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://dominicroye.github.io/es/2018/acceso-a-datos-de-los-reanalisis-climaticos-desde-r/&amp;title=Acceso%20a%20datos%20de%20los%20rean%c3%a1lisis%20clim%c3%a1ticos%20desde%20R" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://dominicroye.github.io/"><img class="avatar mr-3 avatar-circle" src="/es/author/dr.-dominic-roye/avatar_hu930bec32484cd86675af8880de95caa2_508993_270x270_fill_q75_lanczos_center.jpg" alt="Dr. Dominic Royé"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://dominicroye.github.io/">Dr. Dominic Royé</a></h5>
      <h6 class="card-subtitle">Investigador y responsable de ciencia de datos</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/dr_xeo" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:dominic.roye@ficlima.org" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.es/citations?user=EoYa8jUAAAAJ&amp;hl=es" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/dominicroye" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/dominicroye/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Dominic_Roye" target="_blank" rel="noopener">
        <i class="ai ai-researchgate"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Relacionado</h3>
    <ul>
      
      <li><a href="/es/2022/uso-de-datos-multidimensionales-espaciales/">Uso de datos multidimensionales espaciales</a></li>
      
      <li><a href="/es/2022/efecto-hillshade-o-sombras-de-laderas/">Efecto hillshade o sombras de laderas</a></li>
      
      <li><a href="/es/2021/visualizar-el-ciclo-de-dia-noche-en-un-mapamundi/">Visualizar el ciclo de día-noche en un mapamundi</a></li>
      
      <li><a href="/es/2021/cartografia-firefly/">Cartografía firefly</a></li>
      
      <li><a href="/es/2020/un-heatmap-como-calendario/">Un heatmap como calendario</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  
  <p class="powered-by">
    © 2018-2023 Dominic Royé. All rights reserved
  </p>
  

  
  






  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Citar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copiar
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Descargar
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    <script src="/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js"></script>

    
    
    
      
      
        <script src="https://cdn.jsdelivr.net/gh/desandro/imagesloaded@v4.1.4/imagesloaded.pkgd.min.js" integrity="sha512-S5PZ9GxJZO16tT9r3WJp/Safn31eu8uWrzglMahDT4dsmgqWonRY9grk3j+3tfuPr9WJNsfooOR7Gi7HL5W2jw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/metafizzy/isotope@v3.0.6/dist/isotope.pkgd.min.js" integrity="sha512-Zq2BOxyhvnRFXu0+WE6ojpZLOU2jdnqbrM1hmVdGzyeCa1DgM3X5Q4A/Is9xA1IkbUeDd7755dNNI/PzSf2Pew==" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    <script src="/es/js/wowchemy.min.50d3bf3df0c53b31631bb48a62b35f92.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
